/*! cmmn-js - cmmn-modeler v0.20.0 | Copyright (c) 2014-present, camunda Services GmbH | bpmn.io/license */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CmmnJS=e()}}(function(){var e={};function t(e,t){return function(e,t){return!(!e||"function"!=typeof e.$instanceOf||!e.$instanceOf(t))}(n(e),t)}function n(e){return e&&e.businessObject?e.businessObject:e}function i(e){return t(e=n(e),"cmmn:Stage")&&e.$parent&&t(e.$parent,"cmmn:Case")}function r(e){var i=n(e);return t(e,"cmmn:PlanItemDefinition")||t(e,"cmmn:CaseFileItemDefinition")?i:i&&i.definitionRef}function o(e){var t=r(e);return t&&t.defaultControl}function a(e){return(e=n(e))&&e.itemControl}function s(e,t){var n=a(e),i=o(e);return n&&n[t]?n[t]:i&&i[t]}function c(e){if(t(e=n(e),"cmmn:CaseFileItem"))return["addChild","addReference","create","delete","removeChild","removeReference","replace","update"];if(t(e,"cmmn:PlanItem")||t(e,"cmmn:DiscretionaryItem")){var o=r(e);return t(o,"cmmn:EventListener")||t(o,"cmmn:Milestone")?["create","occur","resume","suspend","terminate"]:["complete","create","disable","enable","exit","fault","manualStart","parentResume","parentSuspend","reactivate","reenable","resume","start","suspend","terminate"]}return i(e)?["close","complete","create","fault","reactivate","suspend","terminate"]:[]}e.is=t,e.getBusinessObject=n,e.isCasePlanModel=i,e.getDefinition=r,e.getDefaultControl=o,e.getItemControl=a,e.isRequired=function(e){return!!s(e,"requiredRule")},e.isRepeatable=function(e){return!!s(e,"repetitionRule")},e.isManualActivation=function(e){return!!s(e,"manualActivationRule")},e.isAutoComplete=function(e){var t=r(e=n(e));return e.autoComplete||t&&t.autoComplete},e.hasPlanningTable=function(e){return(e=n(e)).planningTable||r(e)&&r(e).planningTable},e.getName=function(e){t(e=n(e),"cmmndi:CMMNEdge")&&e.cmmnElementRef&&(e=e.cmmnElementRef);var i=e.name;return i||e.definitionRef&&(i=e.definitionRef.name),i},e.getSentry=function(e){var i=n(e);return t(i,"cmmn:Sentry")?i:i&&i.sentryRef},e.getStandardEvent=function(e){return(e=n(e)).cmmnElementRef&&e.cmmnElementRef.standardEvent},e.getStandardEvents=function(e){return t(e,"cmmndi:CMMNEdge")&&(e=n(e).cmmnElementRef),t(e,"cmmn:OnPart")?t(e.exitCriterionRef,"cmmn:ExitCriterion")?["exit"]:c(e.sourceRef):[]};var u={};u="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var l={};Object.defineProperty(l,"__esModule",{value:!0});var d=Object.prototype.toString,p=Object.prototype.hasOwnProperty;function f(e){return void 0===e}function h(e){return"[object Array]"===d.call(e)}function m(e){return"[object Object]"===d.call(e)}function y(e){var t=d.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t||"[object GeneratorFunction]"===t||"[object AsyncGeneratorFunction]"===t||"[object Proxy]"===t}function v(e){if(!h(e))throw new Error("must supply array")}function g(e,t){return p.call(e,t)}function _(e,t){var n;return t=k(t),x(e,function(e,i){if(t(e,i))return n=e,!1}),n}function x(e,t){var n;if(!f(e)){var i=h(e)?A:T;for(var r in e)if(g(e,r)&&!1===t(n=e[r],i(r)))return n}}function b(e,t,n){return x(e,function(e,i){n=t(n,e,i)}),n}function w(e,t){return b(e,function(e,n,i){return e&&t(n,i)},!0)}function E(e,t){var n=[];return x(e,function(e,i){n.push(t(e,i))}),n}function M(e){return e&&Object.keys(e)||[]}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=R(t),x(e,function(e){var i=t(e)||"_",r=n[i];r||(r=n[i]=[]),r.push(e)}),n}function C(e){e=R(e);for(var t={},n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return x(i,function(n){return S(n,e,t)}),E(t,function(e,t){return e[0]})}var P=C;function R(e){return y(e)?e:function(t){return t[e]}}function k(e){return y(e)?e:function(t){return t===e}}function T(e){return e}function A(e){return Number(e)}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}l.flatten=function(e){return Array.prototype.concat.apply([],e)},l.find=_,l.findIndex=function(e,t){t=k(t);var n=h(e)?-1:void 0;return x(e,function(e,i){if(t(e,i))return n=i,!1}),n},l.filter=function(e,t){var n=[];return x(e,function(e,i){t(e,i)&&n.push(e)}),n},l.forEach=x,l.without=function(e,t){return f(e)?[]:(v(e),t=k(t),e.filter(function(e,n){return!t(e,n)}))},l.reduce=b,l.every=w,l.some=function(e,t){return!!_(e,t)},l.map=E,l.keys=M,l.size=function(e){return M(e).length},l.values=function(e){return E(e,function(e){return e})},l.groupBy=S,l.uniqueBy=C,l.unionBy=P,l.sortBy=function(e,t){t=R(t);var n=[];return x(e,function(e,i){for(var r=t(e,i),o={d:r,v:e},a=0;a<n.length;a++)if(r<n[a].d)return void n.splice(a,0,o);n.push(o)}),E(n,function(e){return e.v})},l.matchPattern=function(e){return function(t){return w(e,function(e,n){return t[n]===e})}},l.debounce=function(e,t){var n,i,r,o;function a(){var a=Date.now(),c=o+t-a;if(c>0)return s(c);e.apply(r,i),n=o=i=r=void 0}function s(e){n=setTimeout(a,e)}return function(){o=Date.now();for(var e=arguments.length,a=new Array(e),c=0;c<e;c++)a[c]=arguments[c];i=a,r=this,n||s(t)}},l.bind=function(e,t){return e.bind(t)},l.isUndefined=f,l.isDefined=function(e){return void 0!==e},l.isArray=h,l.isObject=m,l.isNumber=function(e){return"[object Number]"===d.call(e)},l.isFunction=y,l.isString=function(e){return"[object String]"===d.call(e)},l.assign=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return O.apply(void 0,[e].concat(n))},l.pick=function(e,t){var n={},i=Object(e);return x(t,function(t){t in i&&(n[t]=e[t])}),n},l.omit=function(e,t){var n={};return x(Object(e),function(e,i){-1===t.indexOf(i)&&(n[i]=e)}),n};var j={};function N(e,t,n){var i=j.extend(n[t.name]||[],e,t,n);Object.defineProperty(n,t.name,{enumerable:t.enumerable,value:i}),i.length&&i.forEach(function(i){e.set(i,t.inverse,n)})}function I(e,t){if(!(this instanceof I))return new I(e,t);e.inverse=t,t.inverse=e,this.props={},this.props[e.name]=e,this.props[t.name]=t}j.extend=function(e,t,n,i){var r=n.inverse;return Object.defineProperty(e,"remove",{value:function(e){var n=this.indexOf(e);return-1!==n&&(this.splice(n,1),t.unset(e,r,i)),e}}),Object.defineProperty(e,"contains",{value:function(e){return-1!==this.indexOf(e)}}),Object.defineProperty(e,"add",{value:function(e,n){var o=this.indexOf(e);if(void 0===n){if(-1!==o)return;n=this.length}-1!==o&&this.splice(o,1),this.splice(n,0,e),-1===o&&t.set(e,r,i)}}),Object.defineProperty(e,"__refs_collection",{value:!0}),e},j.isExtended=function(e){return!0===e.__refs_collection},I.prototype.bind=function(e,t){if("string"==typeof t){if(!this.props[t])throw new Error("no property <"+t+"> in ref");t=this.props[t]}t.collection?N(this,t,e):function(e,t,n){var i=t.inverse,r=n[t.name];Object.defineProperty(n,t.name,{configurable:t.configurable,enumerable:t.enumerable,get:function(){return r},set:function(t){if(t!==r){var o=r;r=null,o&&e.unset(o,i,n),r=t,e.set(r,i,n)}}})}(this,t,e)},I.prototype.ensureRefsCollection=function(e,t){var n=e[t.name];return j.isExtended(n)||N(this,t,e),n},I.prototype.ensureBound=function(e,t){(function(e,t){return Object.prototype.hasOwnProperty.call(e,t.name||t)})(e,t)||this.bind(e,t)},I.prototype.unset=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).remove(n):e[t.name]=void 0)},I.prototype.set=function(e,t,n){e&&(this.ensureBound(e,t),t.collection?this.ensureRefsCollection(e,t).add(n):e[t.name]=n)};var D={};(D=I).Collection=j;var B={};Object.defineProperty(B,"__esModule",{value:!0}),B.Base=G,B.Shape=q,B.Label=Y,B.create=function(e,t){var n=Z[e];if(!n)throw new Error("unknown type: <"+e+">");return(0,l.assign)(new n,t)};var L=F(u),z=F(D);function F(e){return e&&e.__esModule?e:{default:e}}var $=new z.default({name:"children",enumerable:!0,collection:!0},{name:"parent"}),H=new z.default({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),U=new z.default({name:"attachers",collection:!0},{name:"host"}),V=new z.default({name:"outgoing",collection:!0},{name:"source"}),W=new z.default({name:"incoming",collection:!0},{name:"target"});function G(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),$.bind(this,"parent"),H.bind(this,"labels"),V.bind(this,"outgoing"),W.bind(this,"incoming")}function q(){G.call(this),$.bind(this,"children"),U.bind(this,"host"),U.bind(this,"attachers")}function K(){q.call(this)}function Y(){q.call(this),H.bind(this,"labelTarget")}function X(){G.call(this),V.bind(this,"source"),W.bind(this,"target")}(0,L.default)(q,G),(0,L.default)(K,q),(0,L.default)(Y,q),(0,L.default)(X,G);var Z={connection:X,shape:q,label:Y,root:K};var Q={},J=l.some,ee=e.is,te=e.getBusinessObject;function ne(e,t){return e===t}function ie(e){return re(te(e),"cmmn:Case")}function re(e,t){for("string"==typeof t&&(t=[t]);e=e.$parent||e.parent;){if(!t)return e;if(oe(e,t))return e}return null}function oe(e,t){return J(t,function(t){return ee(e,t)})}Q.isSame=ne,Q.isSameCase=function(e,t){return ne(ie(e),ie(t))},Q.getCase=ie,Q.getParents=function(e,t){var n=[];for("string"==typeof t&&(t=[t]);e;)(e=e.$parent||e.parent)&&(t?oe(e,t)&&n.push(e):n.push(e));return n},Q.getParent=re,Q.isAny=oe,Q.isLabel=function(e){return e instanceof B.Label};var ae=e.getDefinition,se=e.getSentry,ce=Q.isAny,ue=l.forEach,le=l.isArray;function de(e,t){this._items={},this._referencedBy={},this._elementRegistry=e,this._eventBus=t,this._init()}de.$inject=["elementRegistry","eventBus"];var pe=de;function fe(e){return ae(e)||se(e)}function he(e){return ce(e,["cmmn:PlanItemDefinition","cmmn:Sentry","cmmn:CaseFileItemDefinition"])}de.prototype._init=function(e){var t=this._eventBus;t.on("diagram.destroy",500,this._clear,this),t.on("diagram.clear",500,this._clear,this)},de.prototype._clear=function(){this._items={},this._referencedBy={}},de.prototype.add=function(e){var t=this._items,n=e.id,i=this._referencedBy,r=fe(e),o=r&&r.id;t[n]=e,r&&(i[o]=i[o]||[],-1===i[o].indexOf(e)&&i[o].push(e))},de.prototype.remove=function(e){var t=this._items,n=e.id,i=this._referencedBy,r=fe(e),o=r&&r.id;if(delete t[n],r){var a=i[o]||[],s=a.indexOf(e);-1!==s&&a.splice(s,1),a.length||delete i[o]}},de.prototype.updateId=function(e,t){var n,i;"string"==typeof e&&(e=this.get(e)),n=he(e)?this._referencedBy:this._items,e&&(i=n[e.id],delete n[e.id],n[t]=i)},de.prototype.updateReference=function(e,t){var n=this._referencedBy,i=fe(e),r=i&&i.id;if(i){var o=n[r]||[],a=o.indexOf(e);-1!==a&&o.splice(a,1),o.length||delete n[r]}if(t){var s=t.id;s&&(n[s]=n[s]||[],-1===n[s].indexOf(e)&&n[s].push(e))}},de.prototype.get=function(e){return this._items[e]},de.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},de.prototype.getAll=function(){return this.filter(function(e){return e})},de.prototype.forEach=function(e){var t=this._items;ue(t,function(t){return e(t,fe(t))})},de.prototype.getReferences=function(e){var t=e.id||e;return(this._referencedBy[t]||[]).slice()},de.prototype.getShape=function(e){var t=e.id||e;return this._elementRegistry&&this._elementRegistry.get(t)},de.prototype.getShapes=function(e){var t=[],n=this;function i(e){e&&t.push(e)}if(le(e))ue(e,function(e){i(n.getShape(e))});else if(he(e)){var r=n.getReferences(e);ue(r,function(e){i(n.getShape(e))})}else i(n.getShape(e));return t};var me={},ye=e.is,ve=e.getBusinessObject,ge=e.isCasePlanModel;me.isCollapsed=function(e){if(!ge(e)){var t=(e=ve(e)).definitionRef;if(ye(t,"cmmn:PlanFragment"))return!!(e&&e.di&&e.di.isCollapsed)}return!1},me.isPlanningTableCollapsed=function(e){return e=ve(e),!!(ye(e,"cmmn:Stage")||e.definitionRef&&(ye(e.definitionRef,"cmmn:Stage")||ye(e.definitionRef,"cmmn:HumanTask")))&&(e.di&&e.di.isPlanningTableCollapsed)},me.isStandardEventVisible=function(e){var t=(e=ve(e)).cmmnElementRef;return!(!ye(t,"cmmn:OnPart")||!e.isStandardEventVisible)};var _e={};Object.defineProperty(_e,"__esModule",{value:!0}),_e.default=be;var xe=1e3;function be(e,t){var n=this;t=t||xe,e.on(["render.shape","render.connection"],t,function(e,t){var i=e.type,r=t.element,o=t.gfx;if(n.canRender(r))return"render.shape"===i?n.drawShape(o,r):n.drawConnection(o,r)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(e,t){if(n.canRender(t))return"render.getShapePath"===e.type?n.getShapePath(t):n.getConnectionPath(t)})}be.prototype.canRender=function(){},be.prototype.drawShape=function(){},be.prototype.drawConnection=function(){},be.prototype.getShapePath=function(){},be.prototype.getConnectionPath=function(){};var we={};function Ee(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}function Me(e,t){return t.appendChild(Ee(e,t))}Object.defineProperty(we,"__esModule",{value:!0});var Se=2,Ce={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":Se,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":Se,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function Pe(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=Ce[i];r?(r===Se&&"number"==typeof n&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function Re(e,t,n){if("string"==typeof t){if(void 0===n)return function(e,t){return Ce[t]?e.style[t]:e.getAttributeNS(null,t)}(e,t);Pe(e,t,n)}else!function(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)Pe(e,i,t[i])}(e,t);return e}function ke(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var Te=/\s+/,Ae=Object.prototype.toString;function Oe(e){return void 0!==e}function je(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}function Ne(e){var t=e.parentNode;return t&&t.removeChild(e),e}function Ie(e){for(var t;t=e.firstChild;)Ne(t);return e}je.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~ke(t,e)||t.push(e),Oe(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this},je.prototype.remove=function(e){if("[object RegExp]"===Ae.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=ke(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this},je.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},je.prototype.toggle=function(e,t){return this.list?(Oe(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(Oe(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},je.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(Te);return""===e[0]&&e.shift(),e},je.prototype.has=je.prototype.contains=function(e){return this.list?this.list.contains(e):!!~ke(this.array(),e)};var De={svg:"http://www.w3.org/2000/svg"},Be='<svg xmlns="'+De.svg+'"';function Le(e){var t=!1;"<svg"===e.substring(0,4)?-1===e.indexOf(De.svg)&&(e=Be+e.substring(4)):(e=Be+">"+e+"</svg>",t=!0);var n=function(e){var t;return(t=new DOMParser).async=!1,t.parseFromString(e,"text/xml")}(e);if(!t)return n;for(var i=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)i.appendChild(r.firstChild);return i}function ze(e,t){var n;return"<"===e.charAt(0)?(n=Le(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(De.svg,e),t&&Re(n,t),n}var Fe=ze("svg");function $e(e,t){var n,i,r=Object.keys(t);for(n=0;i=r[n];n++)e[i]=t[i];return e}var He=/([&<>]{1})/g,Ue=/([\n\r"]{1})/g,Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function We(e,t){return e.replace(t,function(e,t){return Ve[t]||t})}function Ge(e,t){var n,i,r,o,a;switch(e.nodeType){case 3:t.push(We(e.textContent,He));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(n=0,i=(r=e.attributes).length;n<i;++n)o=r.item(n),t.push(" ",o.name,'="',We(o.value,Ue),'"');if(e.hasChildNodes()){for(t.push(">"),n=0,i=(a=e.childNodes).length;n<i;++n)Ge(a.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("\x3c!--",We(e.nodeValue,He),"--\x3e");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function qe(e,t){var n=Le(t);if(Ie(e),t){"#document-fragment"!==n.nodeName&&(n=n.documentElement);for(var i,r=(i=n.childNodes,Array.prototype.slice.call(i)),o=0;o<r.length;o++)Me(r[o],e)}}function Ke(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}we.append=function(e,t){return Me(t,e),e},we.attr=Re,we.classes=function(e){return new je(e)},we.clear=Ie,we.clone=function(e){return e.cloneNode(!0)},we.create=ze,we.innerSVG=function(e,t){if(void 0!==t){try{qe(e,t)}catch(e){throw new Error("error parsing SVG: "+e.message)}return e}return function(e){for(var t=e.firstChild,n=[];t;)Ge(t,n),t=t.nextSibling;return n.join("")}(e)},we.remove=Ne,we.transform=function(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),function(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(Ke(e,i))}(n,t)),n.consolidate()},we.createMatrix=function(e,t,n,i,r,o){var a=Fe.createSVGMatrix();switch(arguments.length){case 0:return a;case 1:return $e(a,e);case 6:return $e(a,{a:e,b:t,c:n,d:i,e:r,f:o})}},we.createTransform=function(e){return e?Fe.createSVGTransformFromMatrix(e):Fe.createSVGTransform()};var Ye={};function Xe(e){for(var t,n="",i=0;t=e[i];i++)n+=t.x+","+t.y+" ";return n}Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.componentsToPath=function(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")},Ye.createLine=function(e,t){var n=(0,we.create)("polyline");(0,we.attr)(n,{points:Xe(e)}),t&&(0,we.attr)(n,t);return n},Ye.updateLine=function(e,t){return(0,we.attr)(e,{points:Xe(t)}),e};var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.transform=function(e,t,n,i,r){var o=(0,we.createTransform)();o.setTranslate(t,n);var a=(0,we.createTransform)();a.setRotate(i,0,0);var s=(0,we.createTransform)();s.setScale(r||1,r||1),(0,we.transform)(e,[o,a,s])},Ze.translate=function(e,t,n){var i=(0,we.createTransform)();i.setTranslate(t,n),(0,we.transform)(e,i)},Ze.rotate=function(e,t){var n=(0,we.createTransform)();n.setRotate(t,0,0),(0,we.transform)(e,n)};var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=ot;var Je=0,et={width:150,height:50};function tt(e,t){var n;t.textContent=e;try{var i,r=""===e;return t.textContent=r?"dummy":e,i={width:(n=t.getBBox()).width+2*n.x,height:n.height},r&&(i.width=0),i}catch(e){return{width:0,height:0}}}function nt(e,t,n){for(var i,r=e.shift(),o=r;;){if((i=tt(o,n)).width=o?i.width:0," "===o||""===o||i.width<Math.round(t)||o.length<2)return it(e,o,r,i);o=rt(o,i.width,t)}}function it(e,t,n,i){if(t.length<n.length){var r=n.slice(t.length).trim();e.unshift(r)}return{width:i.width,height:i.height,text:t}}function rt(e,t,n){var i=Math.max(e.length*(n/t),1),r=function(e,t){var n,i=e.split(/(\s|-)/g),r=[],o=0;if(i.length>1)for(;n=i.shift();){if(!(n.length+o<t)){"-"===n&&r.pop();break}r.push(n),o+=n.length}return r.join("")}(e,i);return r||(r=e.slice(0,Math.max(Math.round(i-1),1))),r}function ot(e){this._config=(0,l.assign)({},{size:et,padding:Je,style:{},align:"center-top"},e||{})}ot.prototype.createText=function(e,t){return this.layoutText(e,t).element},ot.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions},ot.prototype.layoutText=function(e,t){var n=(0,l.assign)({},this._config.size,t.box),i=(0,l.assign)({},this._config.style,t.style),r=function(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}(t.align||this._config.align),o=function(e){return(0,l.isObject)(e)?(0,l.assign)({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}(void 0!==t.padding?t.padding:this._config.padding),a=t.fitBox||!1,s=function(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}(i),c=e.split(/\r?\n/g),u=[],d=n.width-o.left-o.right,p=(0,we.create)("text");(0,we.attr)(p,{x:0,y:0}),(0,we.attr)(p,i);var f=function(){var e=document.getElementById("helper-svg");return e||(e=(0,we.create)("svg"),(0,we.attr)(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}();for((0,we.append)(f,p);c.length;)u.push(nt(c,d,p));"middle"===r.vertical&&(o.top=o.bottom=0);var h=(0,l.reduce)(u,function(e,t,n){return e+(s||t.height)},0)+o.top+o.bottom,m=(0,l.reduce)(u,function(e,t,n){return t.width>e?t.width:e},0),y=o.top;"middle"===r.vertical&&(y+=(n.height-h)/2),y-=(s||u[0].height)/4;var v=(0,we.create)("text");return(0,we.attr)(v,i),(0,l.forEach)(u,function(e){var t;switch(y+=s||e.height,r.horizontal){case"left":t=o.left;break;case"right":t=(a?m:d)-o.right-e.width;break;default:t=Math.max(((a?m:d)-e.width)/2+o.left,0)}var n=(0,we.create)("tspan");(0,we.attr)(n,{x:t,y:y}),n.textContent=e.text,(0,we.append)(v,n)}),(0,we.remove)(p),{dimensions:{width:m,height:h},element:v}};var at={};Object.defineProperty(at,"__esModule",{value:!0});var st=[].indexOf,ct=function(e,t){if(st)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},ut=/\s+/,lt=Object.prototype.toString;function dt(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}dt.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~ct(t,e)||t.push(e),this.el.className=t.join(" "),this},dt.prototype.remove=function(e){if("[object RegExp]"==lt.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=ct(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},dt.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},dt.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},dt.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(ut);return""===e[0]&&e.shift(),e},dt.prototype.has=dt.prototype.contains=function(e){return this.list?this.list.contains(e):!!~ct(this.array(),e)};var pt=Element.prototype,ft=pt.matchesSelector||pt.webkitMatchesSelector||pt.mozMatchesSelector||pt.msMatchesSelector||pt.oMatchesSelector,ht=function(e,t){if(ft)return ft.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;++i)if(n[i]==e)return!0;return!1};var mt,yt=function(e,t,n){for(var i=n?e:e.parentNode;i&&i!==document;){if(ht(i,t))return i;i=i.parentNode}},vt=window.addEventListener?"addEventListener":"attachEvent",gt=window.removeEventListener?"removeEventListener":"detachEvent",_t="addEventListener"!==vt?"on":"",xt={bind:function(e,t,n,i){return e[vt](_t+t,n,i||!1),n},unbind:function(e,t,n,i){return e[gt](_t+t,n,i||!1),n}},bt=["focus","blur"],wt={bind:function(e,t,n,i,r){return-1!==bt.indexOf(n)&&(r=!0),xt.bind(e,n,function(n){var r=n.target||n.srcElement;n.delegateTarget=yt(r,t,!0),n.delegateTarget&&i.call(e,n)},r)},unbind:function(e,t,n,i){-1!==bt.indexOf(t)&&(i=!0),xt.unbind(e,t,n,i)}},Et=function(e,t){if("string"!=typeof e)throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if("body"==i){var r=t.createElement("html");return r.innerHTML=e,r.removeChild(r.lastChild)}var o=St[i]||St._default,a=o[0],s=o[1],c=o[2];(r=t.createElement("div")).innerHTML=s+e+c;for(;a--;)r=r.lastChild;if(r.firstChild==r.lastChild)return r.removeChild(r.firstChild);var u=t.createDocumentFragment();for(;r.firstChild;)u.appendChild(r.removeChild(r.firstChild));return u},Mt=!1;"undefined"!=typeof document&&((mt=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Mt=!mt.getElementsByTagName("link").length,mt=void 0);var St={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Mt?[1,"X<div>","</div>"]:[0,"",""]};St.td=St.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],St.option=St.optgroup=[1,'<select multiple="multiple">',"</select>"],St.thead=St.tbody=St.colgroup=St.caption=St.tfoot=[1,"<table>","</table>"],St.polyline=St.ellipse=St.polygon=St.circle=St.text=St.line=St.path=St.rect=St.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var Ct="undefined"!=typeof Element?Element.prototype:{},Pt=Ct.matches||Ct.matchesSelector||Ct.webkitMatchesSelector||Ct.mozMatchesSelector||Ct.msMatchesSelector||Ct.oMatchesSelector,Rt=function(e,t){if(!e||1!==e.nodeType)return!1;if(Pt)return Pt.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1};at.attr=function(e,t,n){return 2==arguments.length?e.getAttribute(t):null===n?e.removeAttribute(t):(e.setAttribute(t,n),e)},at.classes=function(e){return new dt(e)},at.clear=function(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e},at.closest=yt,at.delegate=wt,at.domify=Et,at.event=xt,at.matches=Rt,at.query=function(e,t){return(t=t||document).querySelector(e)},at.queryAll=function(e,t){return(t=t||document).querySelectorAll(e)},at.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var kt=l.isArray,Tt=l.isObject,At=l.assign,Ot=_e.default,jt=Qe.default,Nt=me.isStandardEventVisible,It=me.isPlanningTableCollapsed,Dt=me.isCollapsed,Bt=e.isCasePlanModel,Lt=e.getBusinessObject,zt=e.getDefinition,Ft=e.isRequired,$t=e.isRepeatable,Ht=e.isManualActivation,Ut=e.isAutoComplete,Vt=e.hasPlanningTable,Wt=e.getName,Gt=e.is,qt=e.getStandardEvent,Kt=at.query,Yt=we.append,Xt=we.attr,Zt=we.classes,Qt=we.create,Jt=Ze.translate,en=Ye.createLine;function tn(e,t,n){Ot.call(this,e);var i=20,r=new jt({style:{fontFamily:"Arial, sans-serif",fontSize:"12px"},size:{width:100}}),o={};function a(e){return o[e]}function s(e){function t(t,n){var i=At({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},n.attrs),r=n.ref||{x:0,y:0},a=n.scale||1;"none"===i.strokeDasharray&&(i.strokeDasharray=[1e4,1]);var s=Qt("marker");Xt(n.element,i),Yt(s,n.element),Xt(s,{id:t,viewBox:"0 0 20 20",refX:r.x,refY:r.y,markerWidth:20*a,markerHeight:20*a,orient:"auto"});var c=Kt("defs",e);return c||(c=Qt("defs"),Yt(e,c)),Yt(c,s),function(e,t){o[e]=t}(t,s)}var n=Qt("path");Xt(n,{d:"M 11 5 L 1 10 L 11 15"}),t("association-start",{element:n,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:1,y:10},scale:.5});var i=Qt("path");Xt(i,{d:"M 1 5 L 11 10 L 1 15"}),t("association-end",{element:i,attrs:{fill:"none",stroke:"black",strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}function c(e,n,i){return kt(n)||(i=n,n=[]),t.style(n||[],At(i,e||{}))}function u(e,t,n,i,r){Tt(i)&&(r=i,i=0),i=i||0,r=c(r,{stroke:"black",strokeWidth:2,fill:"white"});var o=t/2,a=n/2,s=Qt("circle");return Xt(s,{cx:o,cy:a,r:Math.round((t+n)/4-i)}),Xt(s,r),Yt(e,s),s}function l(e,t,n,i,r,o){Tt(r)&&(o=r,r=0),r=r||0,o=c(o,{stroke:"black",strokeWidth:2,fill:"white"});var a=Qt("rect");return Xt(a,{x:r,y:r,width:t-2*r,height:n-2*r,rx:i,ry:i}),Xt(a,o),Yt(e,a),a}function d(e,t,n,i){var r=t/2,o=n/2,a=[{x:r,y:0},{x:t,y:o},{x:r,y:n},{x:0,y:o}].map(function(e){return e.x+","+e.y}).join(" ");i=c(i,{stroke:"black",strokeWidth:2,fill:"white"});var s=Qt("polygon");return Xt(s,{points:a}),Xt(s,i),Yt(e,s),s}function p(e,t,n){n=c(n,["no-fill"],{strokeWidth:2,stroke:"black"});var i=Qt("path");return Xt(i,{d:t}),Xt(i,n),Yt(e,i),i}function f(e,t,n){var i=t.map(function(e){return e.x+","+e.y}).join(" "),r=Qt("polygon");return Xt(r,{points:i}),Xt(r,n),Yt(e,r),r}function h(e){for(var t=e.waypoints,n="m  "+t[0].x+","+t[0].y,i=1;i<t.length;i++)n+="L"+t[i].x+","+t[i].y+" ";return n}function m(e,t,n){var i=r.createText(t||"",n);return Zt(i).add("djs-label"),Yt(e,i),i}function y(e,t,n){return m(e,Wt(t),{box:t,align:n,padding:5})}function v(e){return g[e]}var g={"cmmn:PlanItem":function(e,t){return v(zt(t).$type)(e,t)},"cmmn:DiscretionaryItem":function(e,t){var n=zt(t),i={strokeDasharray:"10, 12"};return Gt(n,"cmmn:Task")&&At(i,{strokeDasharray:"12, 12.4",strokeDashoffset:13.6}),v(n.$type)(e,t,i)},"cmmn:Stage":function(e,t,n){var r;return n=At({fillOpacity:.95},n),Bt(t)?g["cmmn:CasePlanModel"](e,t):(r=function(e,t,n,i,r){var o=[{x:i=i||20,y:n},{x:0,y:n-i},{x:0,y:i},{x:i,y:0},{x:t-i,y:0},{x:t,y:i},{x:t,y:n-i},{x:t-i,y:n}];return(r=r||{}).fill="white",r.stroke="black",r.strokeWidth=2,f(e,o,r)}(e,t.width,t.height,i,n),Dt(t)?y(e,t,"center-middle"):function(e,t,n){var r=m(e,Wt(t),{box:t,align:n,padding:5});Jt(r,i,0)}(e,t,"left-top"),b(e,t),x(e,t),r)},"cmmn:PlanFragment":function(e,t,n){var i=l(e,t.width,t.height,10,{strokeDasharray:"10, 12",fillOpacity:.95});return y(e,t,Dt(t)?"center-middle":"left-top"),x(e,t),i},"cmmn:CasePlanModel":function(e,t){var n=l(e,t.width,t.height,0,{fillOpacity:.95});return function(e,t){var n=Lt(t),i=t.width/2-60,r=m(e,n.name,{box:{height:18,width:i},align:"left-top"}),o=r.getBBox().width,a=o+40;o<60&&(a=100);var s=f(e,[{x:10,y:0},{x:20,y:-18},{x:a,y:-18},{x:a+10,y:0}],{fill:"white",stroke:"black",strokeWidth:2,fillOpacity:.95,"pointer-events":"all"});r.parentNode.insertBefore(s,r),Jt(r,25,-13)}(e,t),b(e,t),function(e,t){var n=Lt(t);Ut(n)&&w("AutoCompleteMarker",e,t,-7)}(e,t),n},"cmmn:Milestone":function(e,t,n){var i=l(e,t.width,t.height,24,n);return y(e,t,"center-middle"),_(e,t),i},"cmmn:EventListener":function(e,t,n){var i=u(e,t.width,t.height,n);return(n=n||{}).strokeWidth=2,u(e,t.width,t.height,.1*t.height,n),i},"cmmn:TimerEventListener":function(e,t,i){var r=v("cmmn:EventListener")(e,t,i);p(e,n.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square"});for(var o=0;o<12;o++){var a=n.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),s=t.width/2;p(e,a,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*o+","+t.height/2+","+s+")"})}return r},"cmmn:UserEventListener":function(e,t,i){var r=v("cmmn:EventListener")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:20,y:15}}),{strokeWidth:.5,fill:"black"}),r},"cmmn:Task":function(e,t,n){var i=l(e,t.width,t.height,10,n);return y(e,t,"center-middle"),_(e,t),i},"cmmn:HumanTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);if(t.businessObject.definitionRef.isBlocking){p(e,n.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"none"}),p(e,n.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:"black"})}else{p(e,n.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:1.25,fill:"white",stroke:"black"})}return b(e,t),r},"cmmn:CaseTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_FOLDER",{abspos:{x:7,y:7}}),{strokeWidth:1.25,fill:"white",stroke:"black"}),r},"cmmn:ProcessTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_CHEVRON",{abspos:{x:5,y:5}}),{strokeWidth:1.25,fill:"white",stroke:"black"}),r},"cmmn:DecisionTask":function(e,t,i){var r=v("cmmn:Task")(e,t,i);return p(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),{strokeWidth:1,fill:"000"}),p(e,n.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),{strokeWidth:1}),r},"cmmn:CaseFileItem":function(e,t,i){return p(e,n.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:"white"})},"cmmn:TextAnnotation":function(e,t){var i=l(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return p(e,n.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}})),m(e,Lt(t).text||"",{box:t,align:"left-middle",padding:5}),i},"cmmn:Association":function(e,t,n){var i=Lt(t);return n=At({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round"},n||{}),"One"!==i.associationDirection&&"Both"!==i.associationDirection||(n.markerEnd=a("association-end")),"Both"===i.associationDirection&&(n.markerStart=a("association-start")),function(e,t,n){n=c(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var i=en(t,n);return Yt(e,i),i}(e,t.waypoints,n)},StageMarker:function(e,t){var i=l(e,14,14,0,{strokeWidth:1,stroke:"black"});Jt(i,t.width/2-7,t.height-17);var r=Dt(t)?"MARKER_STAGE_COLLAPSED":"MARKER_STAGE_EXPANDED";p(e,n.getScaledPath(r,{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7)/t.width,my:(t.height-17)/t.height}}))},RequiredMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_REQUIRED",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}),{strokeWidth:3})},AutoCompleteMarker:function(e,t,n){var i=l(e,11,14,0,{strokeWidth:1,stroke:"black",fill:"black"});Jt(i,t.width/2+n+2,t.height-17)},ManualActivationMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_MANUAL_ACTIVATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}),{strokeWidth:1})},RepetitionMarker:function(e,t,i){p(e,n.getScaledPath("MARKER_REPEATABLE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+i)/t.width,my:(t.height-17)/t.height}}))},PlanningTableMarker:function(e,t,i){var r=l(e,30,24,0,{strokeWidth:1.5,stroke:"black"});Jt(r,t.width/2-15,-17);var o=It(t)?"MARKER_PLANNING_TABLE_COLLAPSED":"MARKER_PLANNING_TABLE_EXPANDED";p(e,n.getScaledPath(o,{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-15)/t.width,my:-17/t.height}}),{strokeWidth:1.5})},"cmmn:OnPart":function(e,t){return p(e,h(t),{strokeDasharray:"10, 5, 2, 5, 2, 5",strokeWidth:1.5})},"cmmn:PlanItemOnPart":function(e,t){return v("cmmn:OnPart")(e,t)},"cmmn:CaseFileItemOnPart":function(e,t){return v("cmmn:OnPart")(e,t)},"cmmn:EntryCriterion":function(e,t){return d(e,t.width,t.height,{fill:"white"})},"cmmn:ExitCriterion":function(e,t){return d(e,t.width,t.height,{fill:"black"})},"cmmndi:CMMNEdge":function(e,t){var n=Lt(t);return n.cmmnElementRef?v(n.cmmnElementRef.$type)(e,t):p(e,h(t),{strokeDasharray:"3, 5",strokeWidth:1})},label:function(e,t){var n,i=function(e,t){var n=Wt(t),i=!1,r=qt(t);if(r){var o=Nt(t);r="["+r+"]",n?o&&(n=n+" "+r):(n=r,t.hidden=i=!o)}var a={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return t.hidden=t.labelTarget.hidden||i||!n,m(e,n,{box:a,style:{fontSize:"11px"}})}(e,t);try{n=i.getBBox()}catch(e){n={width:0,height:0,x:0}}return t.x=Math.ceil(t.x+t.width/2)-Math.ceil(n.width/2),t.width=Math.ceil(n.width),t.height=Math.ceil(n.height),Xt(i,{transform:"translate("+-1*n.x+",0)"}),i}};function _(e,t){var n=Lt(t),i=[];Ft(n)&&i.push({marker:"RequiredMarker",width:1}),Ht(n)&&i.push({marker:"ManualActivationMarker",width:14}),$t(n)&&i.push({marker:"RepetitionMarker",width:14}),i.length&&(1===i.length?w(i[0].marker,e,t,i[0].width/2*-1):2===i.length?(w(i[0].marker,e,t,-1*i[0].width-3),w(i[1].marker,e,t,3)):3===i.length&&(w(i[1].marker,e,t,i[1].width/2*-1),w(i[0].marker,e,t,i[1].width/2*-1-6-i[0].width),w(i[2].marker,e,t,i[1].width/2+6)))}function x(e,t,n){var i=Lt(t);w("StageMarker",e,t,-7);var r=[];Ft(i)&&r.push({marker:"RequiredMarker",width:1}),Ut(i)&&r.push({marker:"AutoCompleteMarker",width:14}),r.length&&(1===r.length?w(r[0].marker,e,t,-1*r[0].width-7-6):2===r.length&&(w(r[0].marker,e,t,-1*r[1].width-7-6- -1*r[0].width-6),w(r[1].marker,e,t,-1*r[1].width-7-6)));var o=[];Ht(i)&&o.push({marker:"ManualActivationMarker",width:14}),$t(i)&&o.push({marker:"RepetitionMarker",width:14}),o.length&&(1===o.length?w(o[0].marker,e,t,13):2===o.length&&(w(o[0].marker,e,t,13),w(o[1].marker,e,t,13+o[0].width+6)))}function b(e,t){Vt(t)&&w("PlanningTableMarker",e,t)}function w(e,t,n,i){v(e)(t,n,i)}this.canRender=function(e){return Gt(e,"cmmn:CMMNElement")||Gt(e,"cmmndi:CMMNEdge")},this.drawShape=function(e,t){var n=g[t.type];return n?n(e,t):Ot.prototype.drawShape.apply(this,[e,t])},this.drawConnection=function(e,t){var n=t.type,i=g[n];return i?i(e,t):Ot.prototype.drawConnection.apply(this,[e,t])},e.on("canvas.init",function(e){s(e.svg)})}u(tn,Ot),tn.$inject=["eventBus","styles","pathMap"];var nn=function(){var e="m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5",t="m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005",n="m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z";this.pathMap={TASK_TYPE_FOLDER:{d:"m {mx},{my} l18,0 l0,12 l-18,0 l0,-12 m 2,0 l3,-4 l5,0 l3,4"},TASK_TYPE_CHEVRON:{d:"m {mx},{my} l15,0 l6,6 l-6,6 l-15,0 l6,-6 l-6,-6"},TASK_TYPE_USER_1:{d:e},TASK_TYPE_USER_2:{d:t},TASK_TYPE_USER_3:{d:n},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_USER_1:{d:e,height:36,width:36,heightElements:[],widthElements:[]},EVENT_USER_2:{d:t,height:36,width:36,heightElements:[],widthElements:[]},EVENT_USER_3:{d:n,height:36,width:36,heightElements:[],widthElements:[]},MARKER_STAGE_EXPANDED:{d:"m{mx},{my} m 2,7 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_STAGE_COLLAPSED:{d:"m{mx},{my} m 2,7 l 10,0 m -5,-5 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_REQUIRED:{d:"m{mx},{my} l 0,9 m 0,2 l0,3",height:14,width:3,heightElements:[],widthElements:[]},MARKER_MANUAL_ACTIVATION:{d:"m{mx}, {my} l 14,7 l -14,7 l 0,-14 z",height:14,width:14,heightElements:[],widthElements:[]},MARKER_REPEATABLE:{d:"m{mx},{my} m 3,0 l 0,14 m 6,-14 l 0,14 m -10,-10 l 14,0 m -14,6 l 14,0",height:14,width:14,heightElements:[],widthElements:[]},MARKER_PLANNING_TABLE_EXPANDED:{d:"m{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0",height:24,width:30,heightElements:[],widthElements:[]},MARKER_PLANNING_TABLE_COLLAPSED:{d:"m{mx},{my} m 0,12 l 30,0 m -20,-12 l 0, 24 m 10, -24 l 0, 24 m -10, -6 l 10,0 m -5, -6 l 0,12",height:10,width:10,heightElements:[],widthElements:[]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,i,r=this.pathMap[e];t.abspos?(n=t.abspos.x,i=t.abspos.y):(n=t.containerWidth*t.position.mx,i=t.containerHeight*t.position.my);var o,a,s={};if(t.position){for(var c=t.containerHeight/r.height*t.yScaleFactor,u=t.containerWidth/r.width*t.xScaleFactor,l=0;l<r.heightElements.length;l++)s["y"+l]=r.heightElements[l]*c;for(var d=0;d<r.widthElements.length;d++)s["x"+d]=r.widthElements[d]*u}return o=r.d,a={mx:n,my:i,e:s},String(o).replace(rn,function(e,t){return function(e,t,n){var i=n;return t.replace(on,function(e,t,n,r,o){t=t||r,i&&(t in i&&(i=i[t]),"function"==typeof i&&o&&(i=i()))}),i=(null==i||i==n?e:i)+""}(e,t,a)})}},rn=/\{([^}]+)\}/g,on=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;var an={__init__:["cmmnRenderer"],cmmnRenderer:["type",tn],pathMap:["type",nn]},sn={elementToString:function(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}},cn={},un=e.is,ln=l.assign,dn=cn.DEFAULT_LABEL_SIZE={width:90,height:20};cn.hasExternalLabel=function(e){return(un(e,"cmmn:PlanItem")||un(e,"cmmn:DiscretionaryItem"))&&(e=e.definitionRef),un(e,"cmmndi:CMMNEdge")&&e.cmmnElementRef&&un(e.cmmnElementRef,"cmmn:OnPart")&&(e=e.cmmnElementRef),un(e,"cmmn:EventListener")||un(e,"cmmn:OnPart")||un(e,"cmmn:CaseFileItem")};var pn=cn.getExternalLabelMid=function(e){var t,n,i,r,o=e.businessObject,a=o.di;return!a&&un(o,"cmmndi:CMMNEdge")&&o.cmmnElementRef&&(a=o),o&&a&&a.waypoint?(t=a.waypoint,n=t.length/2-1,i=t[Math.floor(n)],r=t[Math.ceil(n+.01)],{x:i.x+(r.x-i.x)/2,y:i.y+(r.y-i.y)/2}):{x:e.x+e.width/2,y:e.y+e.height+dn.height/2}};cn.getExternalLabelBounds=function(e,t){var n,i,r,o=(e.di||e).label;return o&&o.bounds?(r=o.bounds,i={width:Math.max(dn.width,r.width),height:r.height},n={x:r.x+r.width/2,y:r.y+r.height/2}):(n=pn(t),i=dn),ln({x:n.x-i.width/2,y:n.y-i.height/2},i)};var fn=l.assign,hn=l.map,mn=e.is,yn=cn.hasExternalLabel,vn=cn.getExternalLabelBounds,gn=me.isCollapsed,_n=sn.elementToString;function xn(e,t){return fn({id:e.id,type:e.$type,businessObject:e},t)}function bn(e,t,n){return new Error("element "+_n(t)+" referenced by "+_n(e)+"#"+n+" not yet drawn")}function wn(e,t,n,i){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i}wn.$inject=["eventBus","canvas","elementFactory","elementRegistry"];var En=wn;wn.prototype.root=function(e){var t=this._elementFactory.createRoot(xn(e));return this._canvas.setRootElement(t),t},wn.prototype.add=function(e,t){var n,i,r,o=e.di;if(o&&mn(o,"cmmndi:CMMNShape")&&!this._getElement(e)){var a=gn(e);i=t&&(t.hidden||t.collapsed);var s=e.di.bounds;n=this._elementFactory.createShape(xn(e,{collapsed:a,hidden:i,x:Math.round(s.x),y:Math.round(s.y),width:Math.round(s.width),height:Math.round(s.height)})),mn(e,"cmmn:Criterion")&&this._attachCriterion(e,n),this._canvas.addShape(n,t)}else{if(!(o&&mn(o,"cmmndi:CMMNEdge")||mn(e,"cmmndi:CMMNEdge")))throw new Error("unknown di "+_n(o)+" for element "+_n(e));var c=this._getSource(e),u=this._getTarget(e);i=t&&(t.hidden||t.collapsed)||c&&c.hidden||u&&u.hidden;var l=(e.di||{}).waypoint||e.waypoint;n=this._elementFactory.createConnection(xn(e,{hidden:i,source:c,target:u,waypoints:(r=l,hn(r,function(e){return{x:e.x,y:e.y}}))})),this._canvas.addConnection(n,t)}return yn(e)&&this.addLabel(e,n),this._eventBus.fire("cmmnElement.added",{element:n}),n},wn.prototype._attachCriterion=function(e,t){var n=e.$parent;if(!n)throw new Error("missing "+_n(e)+"$parent");var i=this._elementRegistry.get(n.id),r=i&&i.attachers;if(!i)throw bn(e,n,"criterion");t.host=i,r||(i.attachers=r=[]),-1===r.indexOf(t)&&r.push(t)},wn.prototype.addLabel=function(e,t){var n=vn(e,t),i=this._elementFactory.createLabel(xn(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden,x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)}));return this._canvas.addShape(i,t.parent)},wn.prototype._getSource=function(e){var t=e.cmmnElementRef;if(t){if(mn(t,"cmmn:OnPart"))return t.exitCriterionRef?this._getEnd(t,"exitCriterionRef"):this._getEnd(t,"sourceRef");if(mn(t,"cmmn:Association"))return this._getEnd(t,"sourceRef")}if(mn(e,"cmmndi:CMMNEdge"))return this._getEnd(e,"sourceCMMNElementRef")},wn.prototype._getTarget=function(e){var t=e.cmmnElementRef;return t&&mn(t,"cmmn:Association")?this._getEnd(t,"targetRef"):this._getEnd(e,"targetCMMNElementRef")},wn.prototype._getEnd=function(e,t){var n=e[t],i=n&&this._getElement(n);if(i)return i;throw n?bn(e,n,t):new Error(_n(e)+"#"+t+"Ref not specified")},wn.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};var Mn={__depends__:[an,{cmmnImporter:["type",En]}],itemRegistry:["type",pe]},Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.remove=function(e,t){if(!e||!t)return-1;var n=e.indexOf(t);-1!==n&&e.splice(n,1);return n},Sn.add=function(e,t,n){if(!e||!t)return;"number"!=typeof n&&(n=-1);var i=e.indexOf(t);if(-1!==i){if(i===n)return;if(-1===n)return;e.splice(i,1)}-1!==n?e.splice(n,0,t):e.push(t)},Sn.indexOf=function(e,t){if(!e||!t)return-1;return e.indexOf(t)};var Cn=l.forEach,Pn=l.filter,Rn=sn.elementToString,kn=e.is,Tn=new D({name:"cmmnElement",enumerable:!0},{name:"di"});var An=function(e){var t=[],n=[],i={},r=[],o={},a=[],s=[];function c(t,n){return e.element(t,n)}function u(t,n){try{return e.addItem(t),t.di&&c(t,n)}catch(e){l(e.message,{element:t,error:e}),console.error("failed to import "+Rn(t)),console.error(e)}}function l(t,n){e.error(t,n)}function d(e,t){return function(n){e(n,t)}}function p(e){var t,o=e.cmmnElementRef;if(o&&!kn(e,"cmmndi:CMMNEdge"))if(o.di)l("multiple DI elements defined for "+Rn(o),{element:o});else{var u=function(e){for(;e&&!kn(e,"cmmn:Case");)e=e.$parent;return e}(o);u&&-1===r.indexOf(u)&&r.push(u),(kn(o,"cmmn:TextAnnotation")||kn(o,"cmmn:CaseFileItem"))&&a.push(o),Tn.bind(o,"di"),o.di=e}else if(kn(e,"cmmndi:CMMNEdge")){var d=!0;if((kn((t=e).cmmnElementRef,"cmmn:Association")?!!t.cmmnElementRef.targetRef:!!t.targetCMMNElementRef)||(d=!1,l("no target referenced in "+Rn(e),{element:e})),function(e){return kn(e.cmmnElementRef,"cmmn:OnPart")?!(!e.cmmnElementRef.exitCriterionRef&&!e.cmmnElementRef.sourceRef):kn(e.cmmnElementRef,"cmmn:Association")?!!e.cmmnElementRef.sourceRef:!!e.sourceCMMNElementRef}(e)||(d=!1,l("no source referenced in "+Rn(e),{element:e})),d)if(kn(o,"cmmn:Association"))s.push(e);else if(o)n.push(function(t){c(e,t)});else{var p=e.sourceCMMNElementRef;i[p.id]=i[p.id]||[],i[p.id].push(e)}}else l("no cmmnElement referenced in "+Rn(e),{element:e})}function f(e){var t;t=e.diagramElements,Cn(t,h)}function h(e){p(e)}function m(e,t){!function(e,t){Cn(e,d(v,t))}(e.planItems,t),kn(e,"cmmn:Stage")&&function(e,t){y(e.planningTable,t)}(e,t)}function y(e,t){e&&Cn(e.tableItems,function(e){kn(e,"cmmn:DiscretionaryItem")?function(e,t){o[e.id]||(function(e){o[e.id]=e}(e),v(e,t))}(e,t):kn(e,"cmmn:PlanningTable")&&y(e,t)})}function v(e,t){var n=u(e,t);Cn(e.exitCriteria,d(g,t)),Cn(e.entryCriteria,d(g,t));var r=e.definitionRef;if(kn(r,"cmmn:PlanFragment"))m(r,n),_(e,n);else if(kn(r,"cmmn:HumanTask")){y(r.planningTable,t);var o=i[e.id];Cn(o,d(w,t)),delete i[e.id]}}function g(e,n){t.unshift(function(){u(e,n)})}function _(e,t){if(e.di&&e.di.bounds){var n=function(e,t){var n=t.di.bounds;return Pn(e,function(e){return e.di.bounds.x>n.x&&e.di.bounds.x<n.x+n.width&&e.di.bounds.y>n.y&&e.di.bounds.y<n.y+n.height})}(a,e);Cn(n,function(e){Sn.remove(a,e),x(e,t)})}}function x(e,t){kn(e,"cmmn:TextAnnotation")?function(e,t){u(e,t)}(e,t):kn(e,"cmmn:CaseFileItem")&&function(e,t){u(e,t)}(e,t)}function b(e,t){c(e,t)}function w(e,n){t.push(function(){c(e,n)})}return{handleDefinitions:function(i,o){var c=i.CMMNDI;if(c){var l=c.diagrams;if(o&&-1===l.indexOf(o))throw new Error("diagram not part of cmmn:Definitions");!o&&l&&l.length&&(o=l[0]),f(o);var p=function(t,n){return e.root(t,n)}(o,o);!function(e,i){Cn(e,function(e){!function(e,i){var r,o=e.casePlanModel;o&&(r=function(e,t){var n=u(e,t);return Cn(e.exitCriteria,d(g,n)),m(e,n),_(e,n),n}(o,i)),function(e){Cn(e,function(e){e()})}(t),Cn(n,function(e){e(r)})}(e,i),t=[],n=[]})}(r,p),Cn(a,d(x)),Cn(s,d(b))}}}},On={};On.importCmmnDiagram=function(e,t,n){var i,r=e.get("cmmnImporter"),o=e.get("eventBus"),a=e.get("itemRegistry"),s=[];o.fire("import.render.start",{definitions:t});try{!function(e){new An({root:function(e){return r.root(e)},element:function(e,t){return r.add(e,t)},error:function(e,t){s.push({message:e,context:t})},addItem:function(e){a.add(e)}}).handleDefinitions(e)}(t)}catch(e){i=e}o.fire("import.render.complete",{error:i,warnings:s}),n(i,s)};var jn={},Nn=at.domify,In=at.delegate,Dn='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>';function Bn(e){return e.join(";")}var Ln,zn=Bn(["color: #404040"]),Fn='<div class="bjs-powered-by-lightbox" style="'+Bn(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"])+'"><div class="backdrop" style="'+Bn(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"])+'"></div><div class="notice" style="'+Bn(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"])+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+zn+'">'+Dn+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>';jn.open=function(){Ln||(Ln=Nn(Fn),In.bind(Ln,".backdrop","click",function(e){document.body.removeChild(Ln)})),document.body.appendChild(Ln)},jn.BPMNIO_IMG=Dn,jn.LINK_STYLES=zn;var $n={};Object.defineProperty($n,"__esModule",{value:!0}),$n.hasLowerCaseAlias=function(e){return e.xml&&"lowerCase"===e.xml.tagAlias},$n.serializeAsType=function(e){return Un(e)===Hn},$n.serializeAsProperty=function(e){return"property"===Un(e)};$n.DEFAULT_NS_MAP={xsi:"http://www.w3.org/2001/XMLSchema-instance"};var Hn=$n.XSI_TYPE="xsi:type";function Un(e){return e.xml&&e.xml.serialize}var Vn={};function Wn(){}Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.default=Wn,Wn.prototype.get=function(e){return this.$model.properties.get(this,e)},Wn.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};var Gn={};Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.default=Yn;var qn,Kn=(qn=Vn)&&qn.__esModule?qn:{default:qn};function Yn(e,t){this.model=e,this.properties=t}Yn.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(Kn.default.prototype);(0,l.forEach)(e.properties,function(e){e.isMany||void 0===e.default||(i[e.name]=e.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var r=e.ns.name;function o(e){n.define(this,"$type",{value:r,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),(0,l.forEach)(e,(0,l.bind)(function(e,t){this.set(t,e)},this))}return o.prototype=i,o.hasType=i.$instanceOf=this.model.hasType,n.defineModel(o,t),n.defineDescriptor(o,e),o};var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.parseName=function(e,t){var n,i,r=e.split(/:/);if(1===r.length)n=e,i=t;else{if(2!==r.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=r[1],i=r[0]}return{name:e=(i?i+":":"")+n,prefix:i,localName:n}};var Zn={};function Qn(e){this.model=e}function Jn(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.default=Qn,Qn.prototype.set=function(e,t,n){var i=this.model.getPropertyDescriptor(e,t),r=i&&i.name;void 0===n?i?delete e[r]:delete e.$attrs[t]:i?r in e?e[r]=n:Jn(e,i,n):e.$attrs[t]=n},Qn.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&Jn(e,n,[]),e[i]},Qn.prototype.define=function(e,t,n){Object.defineProperty(e,t,n)},Qn.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},Qn.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};var ei={};function ti(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}Object.defineProperty(ei,"__esModule",{value:!0}),ei.default=ti,ti.prototype.build=function(){return(0,l.pick)(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},ti.prototype.addProperty=function(e,t,n){"boolean"==typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);var i=this.properties;void 0!==t?i.splice(t,0,e):i.push(e)},ti.prototype.replaceProperty=function(e,t,n){var i=e.ns,r=this.properties,o=this.propertiesByName,a=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=r.indexOf(e);if(-1===s)throw new Error("property <"+i.name+"> not found in property list");r.splice(s,1),this.addProperty(t,n?void 0:s,a),o[i.name]=o[i.localName]=t},ti.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,r=t.split("#"),o=(0,Xn.parseName)(r[0],i),a=(0,Xn.parseName)(r[1],o.prefix).name,s=this.propertiesByName[a];if(!s)throw new Error("refined property <"+a+"> not found");this.replaceProperty(s,e,n),delete e.redefines},ti.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e},ti.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]},ti.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},ti.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},ti.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},ti.prototype.hasProperty=function(e){return this.propertiesByName[e]},ti.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,r=e.name;r in n||((0,l.forEach)(e.properties,(0,l.bind)(function(n){n=(0,l.assign)({},n,{name:n.ns.localName,inherited:t}),Object.defineProperty(n,"definedBy",{value:e});var i=n.replaces,r=n.redefines;i||r?this.redefineProperty(n,i||r,i):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))},this)),i.push(e),n[r]=e)};var ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.coerceType=function(e,t){var n=ri[e];return n?n(t):t},ni.isBuiltIn=function(e){return!!ii[e]},ni.isSimple=function(e){return!!ri[e]};var ii={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},ri={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e,10)}};var oi={};Object.defineProperty(oi,"__esModule",{value:!0}),oi.default=si;var ai=function(e){return e&&e.__esModule?e:{default:e}}(ei);function si(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,(0,l.forEach)(e,(0,l.bind)(this.registerPackage,this))}function ci(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}si.prototype.getPackage=function(e){return this.packageMap[e]},si.prototype.getPackages=function(){return this.packages},si.prototype.registerPackage=function(e){e=(0,l.assign)({},e);var t=this.packageMap;ci(t,e,"prefix"),ci(t,e,"uri"),(0,l.forEach)(e.types,(0,l.bind)(function(t){this.registerType(t,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},si.prototype.registerType=function(e,t){e=(0,l.assign)({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:(0,l.assign)(e.meta||{})});var n=(0,Xn.parseName)(e.name,t.prefix),i=n.name,r={};(0,l.forEach)(e.properties,(0,l.bind)(function(e){var t=(0,Xn.parseName)(e.name,n.prefix),i=t.name;(0,ni.isBuiltIn)(e.type)||(e.type=(0,Xn.parseName)(e.type,t.prefix).name),(0,l.assign)(e,{ns:t,name:i}),r[i]=e},this)),(0,l.assign)(e,{ns:n,name:i,propertiesByName:r}),(0,l.forEach)(e.extends,(0,l.bind)(function(e){var t=this.typeMap[e];t.traits=t.traits||[],t.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e},si.prototype.mapTypes=function(e,t,n){var i=(0,ni.isBuiltIn)(e.name)?{name:e.name}:this.typeMap[e.name],r=this;function o(e){return a(e,!0)}function a(n,i){var o=(0,Xn.parseName)(n,(0,ni.isBuiltIn)(n)?"":e.prefix);r.mapTypes(o,t,i)}if(!i)throw new Error("unknown type <"+e.name+">");(0,l.forEach)(i.superClass,n?o:a),t(i,!n),(0,l.forEach)(i.traits,o)},si.prototype.getEffectiveDescriptor=function(e){var t=(0,Xn.parseName)(e),n=new ai.default(t);this.mapTypes(t,function(e,t){n.addTrait(e,t)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i},si.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};var ui={};Object.defineProperty(ui,"__esModule",{value:!0}),ui.default=hi;var li=fi(Gn),di=fi(oi),pi=fi(Zn);function fi(e){return e&&e.__esModule?e:{default:e}}function hi(e){this.properties=new pi.default(this),this.factory=new li.default(this,this.properties),this.registry=new di.default(e,this.properties),this.typeCache={}}hi.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)},hi.prototype.getType=function(e){var t=this.typeCache,n=(0,l.isString)(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i},hi.prototype.createAny=function(e,t,n){var i=(0,Xn.parseName)(e),r={$type:e,$instanceOf:function(e){return e===this.$type}},o={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(r,o),this.properties.defineModel(r,this),this.properties.define(r,"$parent",{enumerable:!1,writable:!0}),(0,l.forEach)(n,function(e,t){(0,l.isObject)(e)&&void 0!==e.value?r[e.name]=e.value:r[t]=e}),r},hi.prototype.getPackage=function(e){return this.registry.getPackage(e)},hi.prototype.getPackages=function(){return this.registry.getPackages()},hi.prototype.getElementDescriptor=function(e){return e.$descriptor},hi.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},hi.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},hi.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var mi={};Object.defineProperty(mi,"__esModule",{value:!0}),Object.defineProperty(mi,"default",{enumerable:!0,get:function(){return(e=ui,e&&e.__esModule?e:{default:e}).default;var e}});var yi={},vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(yi,"__esModule",{value:!0});var gi=String.fromCharCode,_i=Object.prototype.hasOwnProperty,xi=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/gi,bi={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};function wi(e,t,n,i){return i?_i.call(bi,i)?bi[i]:"&"+i+";":gi(t||parseInt(n,16))}function Ei(e){return e.length>3&&-1!==e.indexOf("&")?e.replace(xi,wi):e}Object.keys(bi).forEach(function(e){bi[e.toUpperCase()]=bi[e]});var Mi="http://www.w3.org/2001/XMLSchema-instance",Si="xsi",Ci="xsi:type",Pi="non-whitespace outside of root node";function Ri(e){return new Error(e)}function ki(e){return"missing namespace for prefix <"+e+">"}function Ti(e){return{get:e,enumerable:!0}}function Ai(e){var t,n={};for(t in e)n[t]=e[t];return n}function Oi(e){return e+"$uri"}function ji(){return{line:0,column:0}}function Ni(e){throw e}yi.Parser=function e(t){if(!this)return new e(t);var n,i,r,o,a,s,c,u,l,d=t&&t.proxy,p=Ni,f=ji,h=!1,m=!1,y=null,v=!1;function g(e){e instanceof Error||(e=Ri(e)),y=e,p(e,f)}function _(e){a&&(e instanceof Error||(e=Ri(e)),a(e,f))}this.on=function(e,t){if("function"!=typeof t)throw Ri("required args <name, cb>");switch(e){case"openTag":i=t;break;case"text":n=t;break;case"closeTag":r=t;break;case"error":p=t;break;case"warn":a=t;break;case"cdata":o=t;break;case"attention":u=t;break;case"question":c=t;break;case"comment":s=t;break;default:throw Ri("unsupported event: "+e)}return this},this.ns=function(e){if(void 0===e&&(e={}),"object"!==(void 0===e?"undefined":vi(e)))throw Ri("required args <nsMap={}>");var t,n={};for(t in e)n[t]=e[t];return n[Mi]=Si,m=!0,l=n,this},this.parse=function(e){if("string"!=typeof e)throw Ri("required args <xml=string>");return y=null,function(e){var t,a,p,y,x,b,w,E,M,S,C=m?[]:null,P=m?function(e){var t,n,i={};for(t in e)i[n=e[t]]=n,i[Oi(n)]=t;return i}(l):null,R=[],k=0,T=!1,A=!1,O=0,j=0,N="",I=0;function D(){if(null!==S)return S;var e,t,n,i,r,o,a,s,c,u,d,p=m&&P.xmlns,f=m&&h?[]:null,y=I,v=N,g=v.length,x={},b={};e:for(;y<g;y++)if(c=!1,!(32===(u=v.charCodeAt(y))||u<14&&u>8)){for((u<65||u>122||u>90&&u<97)&&95!==u&&58!==u&&(_("illegal first char attribute name"),c=!0),d=y+1;d<g;d++)if(!((u=v.charCodeAt(d))>96&&u<123||u>64&&u<91||u>47&&u<59||46===u||45===u||95===u)){if(32===u||u<14&&u>8){_("missing attribute value"),y=d;continue e}if(61===u)break;_("illegal attribute name char"),c=!0}if("xmlns:xmlns"===(s=v.substring(y,d))&&(_("illegal declaration of xmlns"),c=!0),34===(u=v.charCodeAt(d+1)))-1===(d=v.indexOf('"',y=d+2))&&-1!==(d=v.indexOf("'",y))&&(_("attribute value quote missmatch"),c=!0);else if(39===u)-1===(d=v.indexOf("'",y=d+2))&&-1!==(d=v.indexOf('"',y))&&(_("attribute value quote missmatch"),c=!0);else for(_("missing attribute value quotes"),c=!0,d+=1;d<g&&!(32===(u=v.charCodeAt(d+1))||u<14&&u>8);d++);for(-1===d&&(_("missing closing quotes"),d=g,c=!0),c||(o=v.substring(y,d)),y=d;d+1<g&&!(32===(u=v.charCodeAt(d+1))||u<14&&u>8);d++)y===d&&(_("illegal character after attribute end"),c=!0);if(y=d+1,!c)if(s in b)_("attribute <"+s+"> already defined");else if(b[s]=!0,m)if(h){if(null!==(r="xmlns"===s?"xmlns":120===s.charCodeAt(0)&&"xmlns:"===s.substr(0,6)?s.substr(6):null)){if(e=Ei(o),t=Oi(r),!(a=l[e])){if("xmlns"===r||t in P&&P[t]!==e)do{a="ns"+k++}while(void 0!==P[a]);else a=r;l[e]=a}P[r]!==a&&(i||(P=Ai(P),i=!0),P[r]=a,"xmlns"===r&&(P[Oi(a)]=e,p=a),P[t]=e),x[s]=o;continue}f.push(s,o)}else-1!==(u=s.indexOf(":"))?(n=P[s.substring(0,u)])?((s=p===n?s.substr(u+1):n+s.substr(u))===Ci&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),n=P[n]||n,o=n+o.substring(u)):o=p+":"+o),x[s]=o):_(ki(s.substring(0,u))):x[s]=o;else x[s]=o}if(h)for(y=0,g=f.length;y<g;y++){if(s=f[y++],o=f[y],-1!==(u=s.indexOf(":"))){if(!(n=P[s.substring(0,u)])){_(ki(s.substring(0,u)));continue}(s=p===n?s.substr(u+1):n+s.substr(u))===Ci&&(-1!==(u=o.indexOf(":"))?(n=o.substring(0,u),n=P[n]||n,o=n+o.substring(u)):o=p+":"+o)}x[s]=o}return S=x}for(f=function(){for(var t,n,i=/(\r\n|\r|\n)/g,r=0,o=0,a=0,s=j;O>=a&&(t=i.exec(e))&&!((s=t[0].length+t.index)>O);)r+=1,a=s;return-1==O?(o=s,n=e.substring(j)):0===j?(console.log(O-a),n=e.substring(j,O)):(o=O-a,n=-1==j?e.substring(O):e.substring(O,j+1)),{data:n,line:r,column:o}},d&&(M=Object.create({},{name:Ti(function(){return w}),originalName:Ti(function(){return E}),attrs:Ti(D),ns:Ti(function(){return P})}));-1!==j;){if(-1===(O=60===e.charCodeAt(j)?j:e.indexOf("<",j)))return R.length?g("unexpected end of file"):0===j?g("missing start tag"):void(j<e.length&&e.substring(j).trim()&&_(Pi));if(j!==O)if(R.length){if(n&&(n(e.substring(j,O),Ei,f),v))return}else if(e.substring(j,O).trim()&&(_(Pi),v))return;if(33!==(x=e.charCodeAt(O+1)))if(63!==x){if(-1==(j=e.indexOf(">",O+1)))return g("unclosed tag");if(S={},47===x){if(T=!1,A=!0,!R.length)return g("missing open tag");if(a=w=R.pop(),y=O+2+a.length,e.substring(O+2,y)!==a)return g("closing tag mismatch");for(;y<j;y++)if(!(32===(x=e.charCodeAt(y))||x>8&&x<14))return g("close tag")}else{if(47===e.charCodeAt(j-1)?(a=w=e.substring(O+1,j-1),T=!0,A=!0):(a=w=e.substring(O+1,j),T=!0,A=!1),!(x>96&&x<123||x>64&&x<91||95===x||58===x))return g("illegal first char nodeName");for(y=1,p=a.length;y<p;y++)if(!((x=a.charCodeAt(y))>96&&x<123||x>64&&x<91||x>47&&x<59||45===x||95===x||46==x)){if(32===x||x<14&&x>8){w=a.substring(0,y),S=null;break}return g("invalid nodeName")}A||R.push(w)}if(m){if(t=P,T&&(A||C.push(t),null===S&&(h=-1!==a.indexOf("xmlns",y))&&(I=y,N=a,D(),h=!1)),E=w,-1!==(x=w.indexOf(":"))){if(!(b=P[w.substring(0,x)]))return g("missing namespace on <"+E+">");w=w.substr(x+1)}else b=P.xmlns;b&&(w=b+":"+w)}if(T&&(I=y,N=a,i&&(d?i(M,Ei,A,f):i(w,D,Ei,A,f),v)))return;if(A){if(r&&(r(d?M:w,Ei,T,f),v))return;m&&(P=T?t:C.pop())}j+=1}else{if(-1===(j=e.indexOf("?>",O)))return g("unclosed question");if(c&&(c(e.substring(O,j+2),f),v))return;j+=2}else{if(91===(x=e.charCodeAt(O+2))&&"CDATA["===e.substr(O+3,6)){if(-1===(j=e.indexOf("]]>",O)))return g("unclosed cdata");if(o&&(o(e.substring(O+9,j),f),v))return;j+=3;continue}if(45===x&&45===e.charCodeAt(O+3)){if(-1===(j=e.indexOf("--\x3e",O)))return g("unclosed comment");if(s&&(s(e.substring(O+4,j),Ei,f),v))return;j+=3;continue}if(-1===(j=e.indexOf(">",O+1)))return g("unclosed tag");if(u&&(u(e.substring(O,j+1),Ei,f),v))return;j+=1}}}(e),f=ji,v=!1,y},this.stop=function(){v=!0}};var Ii={};(function(e){"use strict";var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();!function(e){var n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];this.data=[null].concat(n),this.top=this.data.length-1}return t(e,[{key:"clear",value:function(){return this.data.length=1,this.top=0,this}},{key:"empty",value:function(){return 0===this.top}},{key:"length",value:function(){return this.top}},{key:"peek",value:function(){return this.data[this.top]}},{key:"pop",value:function(){var e=void 0;return this.top>0&&(e=this.data.pop(),this.top--),e}},{key:"push",value:function(e){return this.data[++this.top]=e,this}},{key:"search",value:function(e){var t=this.data.indexOf(e);return-1===t?-1:this.data.length-t}}]),e}();function i(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new(Function.prototype.bind.apply(n,[null].concat(t)))}void 0!==Ii?Ii=i:e.stack=i}("undefined"!=typeof window?window:e)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Di={};Object.defineProperty(Di,"__esModule",{value:!0}),Di.Reader=Ji;var Bi=zi(Ii),Li=zi(mi);function zi(e){return e&&e.__esModule?e:{default:e}}function Fi(e,t){return(0,$n.hasLowerCaseAlias)(t)?e.prefix+":"+((n=e.localName).charAt(0).toUpperCase()+n.slice(1)):e.name;var n}function $i(e){return new Error(e)}function Hi(e){return e.$descriptor}function Ui(e){(0,l.assign)(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw $i("expected element");var t,n=this.elementsById,i=Hi(e).idProperty;if(i&&(t=e.get(i.name))){if(n[t])throw $i("duplicate ID <"+t+">");n[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}function Vi(){}function Wi(){}function Gi(){}function qi(e,t){this.property=e,this.context=t}function Ki(e,t){this.element=t,this.propertyDesc=e}function Yi(){}function Xi(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function Zi(e,t,n){Xi.call(this,e,t,n)}function Qi(e,t,n){this.model=e,this.context=n}function Ji(e){e instanceof Li.default&&(e={model:e}),(0,l.assign)(this,{lax:!1},e)}Vi.prototype.handleEnd=function(){},Vi.prototype.handleText=function(){},Vi.prototype.handleNode=function(){},Wi.prototype=Object.create(Vi.prototype),Wi.prototype.handleNode=function(){return this},Gi.prototype=Object.create(Vi.prototype),Gi.prototype.handleText=function(e){this.body=(this.body||"")+e},qi.prototype=Object.create(Gi.prototype),qi.prototype.handleNode=function(e){if(this.element)throw $i("expected no sub nodes");return this.element=this.createReference(e),this},qi.prototype.handleEnd=function(){this.element.id=this.body},qi.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},Ki.prototype=Object.create(Gi.prototype),Ki.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=(0,ni.coerceType)(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)},Yi.prototype=Object.create(Gi.prototype),Yi.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t},Xi.prototype=Object.create(Yi.prototype),Xi.prototype.addReference=function(e){this.context.addReference(e)},Xi.prototype.handleEnd=function(){var e=this.body,t=this.element,n=Hi(t).bodyProperty;n&&void 0!==e&&(e=(0,ni.coerceType)(n.type,e),t.set(n.name,e))},Xi.prototype.createElement=function(e){var t,n=e.attributes,i=this.type,r=Hi(i),o=this.context,a=new i({}),s=this.model;return(0,l.forEach)(n,function(e,n){var i,c=r.propertiesByName[n];c&&c.isReference?c.isMany?(i=e.split(" "),(0,l.forEach)(i,function(e){o.addReference({element:a,property:c.ns.name,id:e})})):o.addReference({element:a,property:c.ns.name,id:e}):(c?e=(0,ni.coerceType)(c.type,e):"xmlns"!==n&&(t=(0,Xn.parseName)(n,r.ns.prefix),s.getPackage(t.prefix)&&o.addWarning({message:"unknown attribute <"+n+">",element:a,property:n,value:e})),a.set(n,e))}),a},Xi.prototype.getPropertyForNode=function(e){var t,n,i=e.name,r=(0,Xn.parseName)(i),o=this.type,a=this.model,s=Hi(o),c=r.name,u=s.propertiesByName[c];if(u)return(0,$n.serializeAsType)(u)&&(t=e.attributes[$n.XSI_TYPE])?(t=function(e,t){var n=(0,Xn.parseName)(e);return function(e,t){var n=e.name,i=e.localName,r=t.xml&&t.xml.typePrefix;return r&&0===i.indexOf(r)?e.prefix+":"+i.slice(r.length):n}(n,t.getPackage(n.prefix))}(t,a),n=a.getType(t),(0,l.assign)({},u,{effectiveType:Hi(n).name})):u;var d=a.getPackage(r.prefix);if(d){if(t=Fi(r,d),n=a.getType(t),u=(0,l.find)(s.properties,function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)}))return(0,l.assign)({},u,{effectiveType:Hi(n).name})}else if(u=(0,l.find)(s.properties,function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type}))return u;throw $i("unrecognized element <"+r.name+">")},Xi.prototype.toString=function(){return"ElementDescriptor["+Hi(this.type).name+"]"},Xi.prototype.valueHandler=function(e,t){return new Ki(e,t)},Xi.prototype.referenceHandler=function(e){return new qi(e,this.context)},Xi.prototype.handler=function(e){return"Element"===e?new Qi(this.model,e,this.context):new Xi(this.model,e,this.context)},Xi.prototype.handleChild=function(e){var t,n,i,r;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,(0,ni.isSimple)(n))return this.valueHandler(t,i);var o=(r=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(n).handleNode(e)).element;return void 0!==o&&(t.isMany?i.get(t.name).push(o):i.set(t.name,o),t.isReference?((0,l.assign)(o,{element:i}),this.context.addReference(o)):o.$parent=i),r},Zi.prototype=Object.create(Xi.prototype),Zi.prototype.createElement=function(e){var t=e.name,n=(0,Xn.parseName)(t),i=this.model,r=this.type,o=i.getPackage(n.prefix),a=o&&Fi(n,o)||t;if(!r.hasType(a))throw $i("unexpected element <"+e.originalName+">");return Xi.prototype.createElement.call(this,e)},Qi.prototype=Object.create(Yi.prototype),Qi.prototype.createElement=function(e){var t=e.name,n=(0,Xn.parseName)(t).prefix,i=e.ns[n+"$uri"],r=e.attributes;return this.model.createAny(t,i,r)},Qi.prototype.handleChild=function(e){var t=new Qi(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element;return void 0!==i&&((n.$children=n.$children||[]).push(i),i.$parent=n),t},Qi.prototype.handleText=function(e){this.body=this.body||""+e},Qi.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},Ji.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof Xi?(i=t,t={}):"string"==typeof t?(i=this.handler(t),t={}):"string"==typeof i&&(i=this.handler(i));var r=this.model,o=this.lax,a=new Ui((0,l.assign)({},t,{rootHandler:i})),s=new yi.Parser({proxy:!0}),c=new Bi.default;function u(e,t,n){var i=t(),r=i.line,o=i.column,s=i.data;"<"===s.charAt(0)&&-1!==s.indexOf(" ")&&(s=s.slice(0,s.indexOf(" "))+">");var c="unparsable content "+(s?s+" ":"")+"detected\n\tline: "+r+"\n\tcolumn: "+o+"\n\tnested error: "+e.message;if(n)return a.addWarning({message:c,error:e}),console.warn("could not parse node"),console.warn(e),!0;throw console.error("could not parse document"),console.error(e),$i(c)}i.context=a,c.push(i);var d=/^<\?xml /i,p=/ encoding="([^"]+)"/i,f=/^utf-8$/i;var h=r.getPackages().reduce(function(e,t){return e[t.uri]=t.prefix,e},{});s.ns(h).on("openTag",function(e,t,n,i){var r=e.attrs||{},a=Object.keys(r).reduce(function(e,n){var i=t(r[n]);return e[n]=i,e},{});!function(e,t){var n=c.peek();try{c.push(n.handleNode(e))}catch(e){u(e,t,o)&&c.push(new Wi)}}({name:e.name,originalName:e.originalName,attributes:a,ns:e.ns},i)}).on("question",function(e){if(d.test(e)){var t=p.exec(e),n=t&&t[1];n&&!f.test(n)&&a.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}}).on("closeTag",function(){c.pop().handleEnd()}).on("cdata",function(e){c.peek().handleText(e)}).on("text",function(e,t){!function(e){(e=e.trim())&&c.peek().handleText(e)}(t(e))}).on("error",u).on("warn",function(e,t){return u(e,t,!0)}),setTimeout(function(){var t;try{s.parse(e),function(){var e,t,n=a.elementsById,i=a.references;for(e=0;t=i[e];e++){var r=t.element,o=n[t.id],s=Hi(r).propertiesByName[t.property];if(o||a.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),s.isMany){var c=r.get(s.name),u=c.indexOf(t);-1===u&&(u=c.length),o?c[u]=o:c.splice(u,1)}else r.set(s.name,o)}}()}catch(e){t=e}var r=i.element;t||r||(t=$i("failed to parse document as <"+i.type.$descriptor.name+">")),n(t,t?void 0:r,a)},0)},Ji.prototype.handler=function(e){return new Zi(this.model,e)};var er={};Object.defineProperty(er,"__esModule",{value:!0}),er.Writer=function(e){return e=(0,l.assign)({format:!1,preamble:!0},e||{}),{toXML:function(t,n){var i=n||new function(){this.value="",this.write=function(e){this.value+=e}},r=new function(e,t){var n=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}(i,e.format);if(e.preamble&&r.append(tr),(new hr).build(t).serializeTo(r),!n)return i.value}}};var tr='<?xml version="1.0" encoding="UTF-8"?>\n',nr=/<|>|'|"|&|\n\r|\n/g,ir=/<|>|&/g;function rr(e){var t={},n={},i={},r=[],o=[];this.byUri=function(t){return n[t]||e&&e.byUri(t)},this.add=function(e,t){n[e.uri]=e,t?r.push(e):o.push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return t[e||"xmlns"]},this.mapPrefix=function(e,n){t[e||"xmlns"]=n},this.logUsed=function(e){var t=e.uri;i[t]=this.byUri(t)},this.getUsed=function(e){return[].concat(r,o).filter(function(e){return i[e.uri]})}}function or(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function ar(e){return(0,l.isString)(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function sr(e,t){return t.isGeneric?(0,l.assign)({localName:t.ns.localName},e):(0,l.assign)({localName:(n=t.ns.localName,i=t.$pkg,(0,$n.hasLowerCaseAlias)(i)?(r=n).charAt(0).toLowerCase()+r.slice(1):n)},e);var n,i,r}var cr={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},ur={"<":"lt",">":"gt","&":"amp"};function lr(e,t,n){return(e=(0,l.isString)(e)?e:""+e).replace(t,function(e){return"&"+n[e]+";"})}function dr(e){this.tagName=e}function pr(){}function fr(e){this.tagName=e}function hr(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function mr(e,t){hr.call(this,e,t)}dr.prototype.build=function(e){return this.element=e,this},dr.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},pr.prototype.serializeValue=pr.prototype.serializeTo=function(e){e.append(this.escape?lr(this.value,ir,ur):this.value)},pr.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(ir)&&(this.escape=!0),this},or(fr,pr),fr.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},hr.prototype.build=function(e){this.element=e;var t,n,i,r=e.$descriptor,o=this.propertyDescriptor,a=r.isGeneric;return t=a?this.parseGeneric(e):this.parseNsAttributes(e),this.ns=o?this.nsPropertyTagName(o):this.nsTagName(r),this.tagName=this.addTagName(this.ns),a||(n=function(e){var t=e.$descriptor;return(0,l.filter)(t.properties,function(t){var n=t.name;if(t.isVirtual)return!1;if(!e.hasOwnProperty(n))return!1;var i=e[n];return i!==t.default&&null!==i&&(!t.isMany||i.length)})}(e),this.parseAttributes((i=n,(0,l.filter)(i,function(e){return e.isAttr}))),this.parseContainments(function(e){return(0,l.filter)(e,function(e){return!e.isAttr})}(n))),this.parseGenericAttributes(e,t),this},hr.prototype.nsTagName=function(e){return sr(this.logNamespaceUsed(e.ns),e)},hr.prototype.nsPropertyTagName=function(e){return function(e,t){return(0,l.assign)({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},hr.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},hr.prototype.nsAttributeName=function(e){var t;if(t=(0,l.isString)(e)?(0,Xn.parseName)(e):e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:(0,l.assign)({localName:t.localName},n)},hr.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return(0,l.forEach)(e,function(r,o){"$body"===o?n.push((new pr).build({type:"String"},r)):"$children"===o?(0,l.forEach)(r,function(e){n.push(new hr(t).build(e))}):0!==o.indexOf("$")&&t.parseNsAttribute(e,o,r)&&i.push({name:o,value:r})}),i},hr.prototype.parseNsAttribute=function(e,t,n){var i,r=e.$model,o=(0,Xn.parseName)(t);if("xmlns"===o.prefix&&(i={prefix:o.localName,uri:n}),o.prefix||"xmlns"!==o.localName||(i={uri:n}),!i)return{name:t,value:n};if(r&&r.getPackage(n))this.logNamespace(i,!0,!0);else{var a=this.logNamespaceUsed(i,!0);this.getNamespaces().logUsed(a)}},hr.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,r=[];return(0,l.forEach)(i,function(t,i){var o=n.parseNsAttribute(e,i,t);o&&r.push(o)}),r},hr.prototype.parseGenericAttributes=function(e,t){var n=this;(0,l.forEach)(t,function(t){if(t.name!==$n.XSI_TYPE)try{n.addAttribute(n.nsAttributeName(t.name),t.value)}catch(n){console.warn("missing namespace information for ",t.name,"=",t.value,"on",e,n)}})},hr.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;(0,l.forEach)(e,function(e){var r=i.get(e.name),o=e.isReference;if(e.isMany||(r=[r]),e.isBody)n.push((new pr).build(e,r[0]));else if((0,ni.isSimple)(e.type))(0,l.forEach)(r,function(i){n.push(new fr(t.addTagName(t.nsPropertyTagName(e))).build(e,i))});else if(o)(0,l.forEach)(r,function(i){n.push(new dr(t.addTagName(t.nsPropertyTagName(e))).build(i))});else{var a=(0,$n.serializeAsType)(e),s=(0,$n.serializeAsProperty)(e);(0,l.forEach)(r,function(i){var r;r=a?new mr(t,e):s?new hr(t,e):new hr(t),n.push(r.build(i))})}})},hr.prototype.getNamespaces=function(e){var t,n=this.namespaces,i=this.parent;return n||(t=i&&i.getNamespaces(),e||!t?this.namespaces=n=new rr(t):n=t),n},hr.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),r=e.uri,o=e.prefix;return i.byUri(r)||i.add(e,t),i.mapPrefix(o,r),e},hr.prototype.logNamespaceUsed=function(e,t){var n,i,r,o=this.element.$model,a=this.getNamespaces(t),s=e.prefix,c=e.uri;if(!s&&!c)return{localName:e.localName};if(r=$n.DEFAULT_NS_MAP[s]||o&&(o.getPackage(s)||{}).uri,!(c=c||r||a.uriByPrefix(s)))throw new Error("no namespace uri given for prefix <"+s+">");if(!(e=a.byUri(c))){for(n=s,i=1;a.uriByPrefix(n);)n=s+"_"+i++;e=this.logNamespace({prefix:n,uri:c},r===c)}return s&&a.mapPrefix(s,c),e},hr.prototype.parseAttributes=function(e){var t=this,n=this.element;(0,l.forEach)(e,function(e){var i=n.get(e.name);if(e.isReference)if(e.isMany){var r=[];(0,l.forEach)(i,function(e){r.push(e.id)}),i=r.join(" ")}else i=i.id;t.addAttribute(t.nsAttributeName(e),i)})},hr.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),ar(e)},hr.prototype.addAttribute=function(e,t){var n=this.attrs;(0,l.isString)(t)&&(t=lr(t,nr,cr)),n.push({name:e,value:t})},hr.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=function(e){return(0,l.map)(e.getUsed(),function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}})}(n).concat(t)),(0,l.forEach)(t,function(t){e.append(" ").append(ar(t.name)).append('="').append(t.value).append('"')})},hr.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==pr;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),(0,l.forEach)(this.body,function(t){t.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},or(mr,hr),mr.prototype.parseNsAttributes=function(e){var t=hr.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var r=e.$model.getPackage(i.uri),o=r.xml&&r.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName($n.XSI_TYPE),(i.prefix?i.prefix+":":"")+o+n.ns.localName),t},mr.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};var yr={};Object.defineProperty(yr,"__esModule",{value:!0}),Object.defineProperty(yr,"Reader",{enumerable:!0,get:function(){return Di.Reader}}),Object.defineProperty(yr,"Writer",{enumerable:!0,get:function(){return er.Writer}});var vr={};Object.defineProperty(vr,"__esModule",{value:!0}),vr.default=_r;var gr=function(e){return e&&e.__esModule?e:{default:e}}(mi);function _r(e,t){gr.default.call(this,e,t)}_r.prototype=Object.create(gr.default.prototype),_r.prototype.fromXML=function(e,t,n,i){(0,l.isString)(t)||(i=n,n=t,t="cmmn:Definitions"),(0,l.isFunction)(n)&&(i=n,n={});var r=new yr.Reader((0,l.assign)({model:this,lax:!0},n)),o=r.handler(t);r.fromXML(e,o,i)},_r.prototype.toXML=function(e,t,n){(0,l.isFunction)(t)&&(n=t,t={});var i,r,o=new yr.Writer(t);try{i=o.toXML(e)}catch(e){r=e}return n(r,i)};var xr={};Object.defineProperty(xr,"__esModule",{value:!0}),xr.default=function(e,t){var n=(0,l.assign)({},Pr,e);return new br.default(n,t)};var br=Cr(vr),wr=Cr({name:"CMMN",uri:"http://www.omg.org/spec/CMMN/20151109/MODEL",types:[{name:"ApplicabilityRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["CMMNElement"]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"CMMNElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"CMMNElement",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"ManualActivationRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Case",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"caseFileModel",type:"CaseFile",xml:{serialize:"property"}},{name:"casePlanModel",type:"Stage",xml:{serialize:"property"}},{name:"caseRoles",type:"CaseRoles"},{name:"input",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}}]},{name:"CaseFile",superClass:["CMMNElement"],properties:[{name:"caseFileItems",type:"CaseFileItem",isMany:!0}]},{name:"CaseFileItem",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"multiplicity",type:"String",isAttr:!0,default:"Unspecified"},{name:"definitionRef",type:"CaseFileItemDefinition",isAttr:!0,isReference:!0},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"targetRefs",type:"CaseFileItem",isAttr:!0,isReference:!0,isMany:!0},{name:"children",type:"Children",xml:{serialize:"property"}}]},{name:"CaseFileItemDefinition",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"definitionType",type:"String",default:"http://www.omg.org/spec/CMMN/DefinitionType/Unspecified",isAttr:!0},{name:"properties",type:"Property",isMany:!0},{name:"structureRef",type:"String",isAttr:!0},{name:"importRef",type:"Import",isAttr:!0,isReference:!0}]},{name:"CaseFileItemOnPart",superClass:["OnPart"],properties:[{name:"standardEvent",type:"String"},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"CaseParameter",superClass:["Parameter"],properties:[{name:"bindingRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"bindingRefinement",type:"Expression",xml:{serialize:"property"}}]},{name:"CaseRoles",superClass:["Parameter"],properties:[{name:"role",type:"Role",isMany:!0}]},{name:"CaseTask",superClass:["Task"],properties:[{name:"parameterMapping",type:"ParameterMapping",isMany:!0},{name:"caseRefExpression",type:"Expression",xml:{serialize:"property"}},{name:"caseRef",type:"String",isAttr:!0}]},{name:"Children",superClass:["CMMNElement"],properties:[{name:"caseFileItems",type:"CaseFileItem",isMany:!0}]},{name:"CMMNElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionElements",type:"ExtensionElements"},{name:"extensionDefinitions",type:"ExtensionDefinition",isReference:!0,isMany:!0}]},{name:"Definitions",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",type:"String",isAttr:!0},{name:"expressionLanguage",type:"String",isAttr:!0,default:"http://www.w3.org/1999/XPath"},{name:"exporter",isAttr:!0,type:"String"},{name:"exporterVersion",isAttr:!0,type:"String"},{name:"author",isAttr:!0,type:"String"},{name:"creationDate",type:"DateTime",isAttr:!0},{name:"imports",type:"Import",isMany:!0},{name:"caseFileItemDefinitions",type:"CaseFileItemDefinition",isMany:!0},{name:"cases",type:"Case",isMany:!0},{name:"processes",type:"Process",isMany:!0},{name:"decisions",type:"Decision",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"relationships",type:"Relationship",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"CMMNDI",type:"cmmndi:CMMNDI"}]},{name:"DiscretionaryItem",superClass:["TableItem"],properties:[{name:"itemControl",type:"PlanItemControl",xml:{serialize:"property"}},{name:"definitionRef",type:"PlanItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"entryCriteria",type:"EntryCriterion",isMany:!0},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"EventListener",superClass:["PlanItemDefinition"]},{name:"Expression",superClass:["CMMNElement"],properties:[{name:"language",type:"String",isAttr:!0},{name:"body",isBody:!0,type:"String"}]},{name:"HumanTask",superClass:["Task"],properties:[{name:"planningTable",type:"PlanningTable"},{name:"performerRef",type:"Role",isAttr:!0,isReference:!0}]},{name:"IfPart",superClass:["CMMNElement"],properties:[{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0},{name:"condition",type:"Expression",xml:{serialize:"property"}}]},{name:"Import",properties:[{name:"location",isAttr:!0,type:"String"},{name:"namespace",type:"String",isAttr:!0},{name:"importType",isAttr:!0,type:"String"}]},{name:"Milestone",superClass:["PlanItemDefinition"]},{name:"On",isAbstract:!0,superClass:["CMMNElement"]},{name:"OnPart",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"Parameter",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ParameterMapping",properties:[{name:"sourceRef",type:"Parameter",isAttr:!0,isReference:!0},{name:"targetRef",type:"Parameter",isAttr:!0,isReference:!0},{name:"transformation",type:"Expression",xml:{serialize:"property"}}]},{name:"PlanFragment",superClass:["PlanItemDefinition"],properties:[{name:"planItems",type:"PlanItem",isMany:!0},{name:"sentries",type:"Sentry",isMany:!0}]},{name:"PlanItem",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"definitionRef",type:"PlanItemDefinition",isAttr:!0,isReference:!0},{name:"itemControl",type:"PlanItemControl",xml:{serialize:"property"}},{name:"entryCriteria",type:"EntryCriterion",isMany:!0},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"PlanItemControl",superClass:["CMMNElement"],properties:[{name:"repetitionRule",type:"RepetitionRule"},{name:"requiredRule",type:"RequiredRule"},{name:"manualActivationRule",type:"ManualActivationRule"}]},{name:"PlanItemDefinition",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"defaultControl",type:"PlanItemControl",xml:{serialize:"property"}}]},{name:"PlanItemOnPart",superClass:["OnPart"],properties:[{name:"standardEvent",type:"String"},{name:"sourceRef",type:"PlanItem",isAttr:!0,isReference:!0},{name:"exitCriterionRef",type:"ExitCriterion",isAttr:!0,isReference:!0}]},{name:"PlanningTable",superClass:["TableItem"],properties:[{name:"tableItems",type:"TableItem",isMany:!0},{name:"applicabilityRules",type:"ApplicabilityRule",isMany:!0}]},{name:"Process",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"implementationType",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/ProcessType/Unspecified"},{name:"externalRef",type:"String",isAttr:!0},{name:"input",type:"ProcessParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"ProcessParameter",isMany:!0,xml:{serialize:"property"}}]},{name:"ProcessParameter",superClass:["Parameter"]},{name:"ProcessTask",superClass:["Task"],properties:[{name:"parameterMapping",type:"ParameterMapping",isMany:!0},{name:"processRefExpression",type:"Expression",xml:{serialize:"property"}},{name:"processRef",type:"String",isAttr:!0}]},{name:"Property",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/PropertyType/Unspecified"}]},{name:"RepetitionRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"RequiredRule",superClass:["CMMNElement"],properties:[{name:"condition",type:"Expression",xml:{serialize:"property"}},{name:"name",isAttr:!0,type:"String"},{name:"contextRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Role",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"Sentry",superClass:["CMMNElement"],properties:[{name:"onParts",type:"OnPart",isMany:!0},{name:"ifPart",type:"IfPart"},{name:"name",isAttr:!0,type:"String"}]},{name:"Stage",superClass:["PlanFragment"],properties:[{name:"planningTable",type:"PlanningTable"},{name:"planItemDefinitions",type:"PlanItemDefinition",isMany:!0},{name:"autoComplete",isAttr:!0,type:"Boolean"},{name:"exitCriteria",type:"ExitCriterion",isMany:!0}]},{name:"TableItem",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"authorizedRoleRefs",type:"Role",isAttr:!0,isReference:!0,isMany:!0},{name:"applicabilityRuleRefs",type:"ApplicabilityRule",isAttr:!0,isReference:!0,isMany:!0}]},{name:"Task",superClass:["PlanItemDefinition"],properties:[{name:"input",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"CaseParameter",isMany:!0,xml:{serialize:"property"}},{name:"isBlocking",isAttr:!0,default:!0,type:"Boolean"}]},{name:"TimerEventListener",superClass:["EventListener"],properties:[{name:"timerExpression",type:"Expression",xml:{serialize:"property"}},{name:"timerStart",type:"StartTrigger"}]},{name:"UserEventListener",superClass:["EventListener"],properties:[{name:"authorizedRoleRefs",type:"Role",isMany:!0,isAttr:!0}]},{name:"DateTime",superClass:[]},{name:"StartTrigger",isAbstract:!0,superClass:["CMMNElement"]},{name:"PlanItemStartTrigger",superClass:["StartTrigger"],properties:[{name:"standardEvent",type:"String",isAttr:!0},{name:"sourceRef",type:"PlanItem",isAttr:!0,isReference:!0}]},{name:"CaseFileItemStartTrigger",superClass:["StartTrigger"],properties:[{name:"standardEvent",type:"String",isAttr:!0},{name:"sourceRef",type:"CaseFileItem",isAttr:!0,isReference:!0}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition"}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",isAttr:!0,default:!1,type:"Boolean"}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Relationship",properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,type:"Element"},{name:"target",isMany:!0,type:"Element"}]},{name:"Documentation",superClass:["CMMNElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"DecisionTask",superClass:["Task"],properties:[{name:"mappings",type:"ParameterMapping",isMany:!0},{name:"decisionRef",type:"String",isAttr:!0},{name:"decisionRefExpression",type:"Expression",xml:{serialize:"property"}}]},{name:"Decision",superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"implementationType",type:"String",isAttr:!0,default:"http://www.omg.org/spec/CMMN/DecisionType/Unspecified"},{name:"input",type:"DecisionParameter",isMany:!0,xml:{serialize:"property"}},{name:"output",type:"DecisionParameter",isMany:!0,xml:{serialize:"property"}},{name:"externalRef",type:"String",isAttr:!0}]},{name:"DecisionParameter",superClass:["Parameter"]},{name:"Criterion",isAbstract:!0,superClass:["CMMNElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sentryRef",type:"Sentry",isAttr:!0,isReference:!0}]},{name:"EntryCriterion",superClass:["Criterion"]},{name:"ExitCriterion",superClass:["Criterion"]}],emumerations:[{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"CaseFileItemTransition",literalValues:[{name:"addChild"},{name:"addReference"},{name:"create"},{name:"delete"},{name:"removeChild"},{name:"removeReference"},{name:"replace"},{name:"update"}]},{name:"MultiplicityEnum",literalValues:[{name:"ZeroOrOne"},{name:"ZeroOrMore"},{name:"ExactlyOne"},{name:"OneOrMore"},{name:"Unspecified"},{name:"Unknown"}]},{name:"PlanItemTransition",literalValues:[{name:"close"},{name:"complete"},{name:"create"},{name:"disable"},{name:"enable"},{name:"exit"},{name:"fault"},{name:"manualStart"},{name:"occur"},{name:"parentResume"},{name:"parentSuspend"},{name:"reactivate"},{name:"reenable"},{name:"resume"},{name:"start"},{name:"suspend"},{name:"terminate"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]}],associations:[],xml:{tagAlias:"lowerCase",typePrefix:"t"},prefix:"cmmn"}),Er=Cr({name:"CMMNDI",uri:"http://www.omg.org/spec/CMMN/20151109/CMMNDI",types:[{name:"CMMNDI",properties:[{name:"diagrams",type:"CMMNDiagram",isMany:!0},{name:"styles",type:"CMMNStyle",isMany:!0}]},{name:"CMMNDiagram",properties:[{name:"cmmnElementRef",isAttr:!0,type:"cmmn:CMMNElement",isReference:!0},{name:"Size",type:"dc:Dimension",xml:{serialize:"xsi:type"}},{name:"diagramElements",type:"CMMNDiagramElement",isMany:!0}],superClass:["di:Diagram"]},{name:"CMMNDiagramElement",superClass:["di:DiagramElement"]},{name:"CMMNShape",properties:[{name:"cmmnElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"label",type:"CMMNLabel"},{name:"isCollapsed",isAttr:!0,type:"Boolean"},{name:"isPlanningTableCollapsed",isAttr:!0,type:"Boolean"}],superClass:["CMMNDiagramElement","di:Shape"]},{name:"CMMNEdge",properties:[{name:"label",type:"CMMNLabel"},{name:"cmmnElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"sourceCMMNElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"targetCMMNElementRef",isAttr:!0,isReference:!0,type:"cmmn:CMMNElement"},{name:"isStandardEventVisible",type:"Boolean",isAttr:!0}],superClass:["CMMNDiagramElement","di:Edge"]},{name:"CMMNLabel",superClass:["di:Shape"]},{name:"CMMNStyle",properties:[{name:"FillColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"StrokeColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"FontColor",type:"dc:Color",xml:{serialize:"xsi:type"}},{name:"fontFamily",type:"String",isAttr:!0},{name:"fontSize",type:"Real",isAttr:!0},{name:"fontItalic",type:"Boolean",isAttr:!0},{name:"fontBold",type:"Boolean",isAttr:!0},{name:"fontUnderline",type:"Boolean",isAttr:!0},{name:"fontStrikeThrough",type:"Boolean",isAttr:!0}],superClass:["di:Style"]}],associations:[],prefix:"cmmndi"}),Mr=Cr({name:"DC",uri:"http://www.omg.org/spec/CMMN/20151109/DC",types:[{name:"rgb"},{name:"Real"},{name:"Color",properties:[{name:"red",type:"rgb",isAttr:!0},{name:"green",type:"rgb",isAttr:!0},{name:"blue",type:"rgb",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",isAttr:!0},{name:"y",type:"Real",isAttr:!0}]},{name:"Dimension",properties:[{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",isAttr:!0},{name:"y",type:"Real",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]}),Sr=Cr({name:"DI",uri:"http://www.omg.org/spec/CMMN/20151109/DI",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"style",type:"Style"},{name:"sharedStyle",type:"Style",isReference:!0,isAttr:!0},{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"waypoint",isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"name",type:"String",isAttr:!0},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,default:300,type:"double"}]},{name:"Shape",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"extension",type:"Extension"},{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Extension",properties:[{name:"values",type:"Element",isMany:!0}]}],associations:[],prefix:"di",xml:{tagAlias:"lowerCase"}});function Cr(e){return e&&e.__esModule?e:{default:e}}var Pr={cmmn:wr.default,cmmndi:Er.default,dc:Mr.default,di:Sr.default},Rr={};Object.defineProperty(Rr,"__esModule",{value:!0}),Object.defineProperty(Rr,"default",{enumerable:!0,get:function(){return(e=xr,e&&e.__esModule?e:{default:e}).default;var e}});var kr={};function Tr(e,t,n){var i=!n||-1===e.indexOf(t);return i&&e.push(t),i}function Ar(e,t,n){n=n||0,(0,l.isArray)(e)||(e=[e]),(0,l.forEach)(e,function(e,i){var r=t(e,i,n);(0,l.isArray)(r)&&r.length&&Ar(r,t,n+1)})}function Or(e,t,n){var i=[],r=[];return Ar(e,function(e,o,a){Tr(i,e,t);var s=e.children;if((-1===n||a<n)&&s&&Tr(r,s,t))return s}),i}function jr(e,t){var n,i,r,o;return t=!!t,(0,l.isArray)(e)||(e=[e]),(0,l.forEach)(e,function(e){var a=e;e.waypoints&&!t&&(a=jr(e.waypoints,!0));var s=a.x,c=a.y,u=a.height||0,l=a.width||0;(s<n||void 0===n)&&(n=s),(c<i||void 0===i)&&(i=c),(s+l>r||void 0===r)&&(r=s+l),(c+u>o||void 0===o)&&(o=c+u)}),{x:n,y:i,height:o-i,width:r-n}}function Nr(e,t){return(0,l.assign)({},e||{},t||{})}Object.defineProperty(kr,"__esModule",{value:!0}),kr.eachElement=Ar,kr.selfAndAllChildren=function(e,t){return Or(e,!t,-1)},kr.getClosure=function(e,t,n){(0,l.isUndefined)(t)&&(t=!0);(0,l.isObject)(t)&&(n=t,t=!0);var i=Nr((n=n||{}).allShapes),r=Nr(n.allConnections),o=Nr(n.enclosedElements),a=Nr(n.enclosedConnections),s=Nr(n.topLevel,t&&(0,l.groupBy)(e,function(e){return e.id}));function c(e){s[e.source.id]&&s[e.target.id]&&(s[e.id]=[e]),i[e.source.id]&&i[e.target.id]&&(a[e.id]=o[e.id]=e),r[e.id]=e}return Ar(e,function(e){if(o[e.id]=e,!e.waypoints)return i[e.id]=e,(0,l.forEach)(e.incoming,c),(0,l.forEach)(e.outgoing,c),e.children;a[e.id]=r[e.id]=e}),{allShapes:i,allConnections:r,topLevel:s,enclosedConnections:a,enclosedElements:o}},kr.getBBox=jr,kr.getEnclosedElements=function(e,t){var n={};return(0,l.forEach)(e,function(e){var i=e;i.waypoints&&(i=jr(i)),!(0,l.isNumber)(t.y)&&i.x>t.x&&(n[e.id]=e),!(0,l.isNumber)(t.x)&&i.y>t.y&&(n[e.id]=e),i.x>t.x&&i.y>t.y&&((0,l.isNumber)(t.width)&&(0,l.isNumber)(t.height)&&i.width+i.x<t.width+t.x&&i.height+i.y<t.height+t.y?n[e.id]=e:(0,l.isNumber)(t.width)&&(0,l.isNumber)(t.height)||(n[e.id]=e))}),n},kr.getType=function(e){if("waypoints"in e)return"connection";if("x"in e)return"shape";return"root"},kr.isFrameElement=function(e){return!(!e||!e.isFrame)};var Ir={};Object.defineProperty(Ir,"__esModule",{value:!0});var Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Br(e,t){return Math.round(e*t)/t}function Lr(e){return(0,l.isNumber)(e)?e+"px":e}function zr(e,t,n){var i=(0,we.create)("g");(0,we.classes)(i).add(t);var r=void 0!==n?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[r]||null),i}Ir.default=$r;var Fr={shape:["x","y","width","height"],connection:["waypoints"]};function $r(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}function Hr(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}$r.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],$r.prototype._init=function(e){var t=this._eventBus,n=this._container=function(e){var t=(e=(0,l.assign)({},{width:"100%",height:"100%"},e)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),(0,l.assign)(n.style,{position:"relative",overflow:"hidden",width:Lr(e.width),height:Lr(e.height)}),t.appendChild(n),n}(e),i=this._svg=(0,we.create)("svg");(0,we.attr)(i,{width:"100%",height:"100%"}),(0,we.append)(n,i);var r=this._viewport=zr(i,"viewport");this._layers={},!1!==e.deferUpdate&&(this._viewboxChanged=(0,l.debounce)((0,l.bind)(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:r})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)},$r.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},$r.prototype._clear=function(){var e=this;this._elementRegistry.getAll().forEach(function(t){var n=(0,kr.getType)(t);"root"===n?e.setRootElement(null,!0):e._removeElement(t,n)}),delete this._cachedViewbox},$r.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},$r.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),void 0!==t&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group},$r.prototype._createLayer=function(e,t){t||(t=0);var n=(0,l.reduce)(this._layers,function(e,n){return t>=n.index&&e++,e},0);return{group:zr(this._viewport,"layer-"+e,n),index:t}},$r.prototype.getContainer=function(){return this._container},$r.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),(i=this._elementRegistry._elements[e.id])&&((0,l.forEach)([i.gfx,i.secondaryGfx],function(e){e&&(n?(0,we.classes)(e).add(t):(0,we.classes)(e).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))},$r.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)},$r.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)},$r.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return(0,we.classes)(n).has(t)},$r.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)},$r.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},$r.prototype.setRootElement=function(e,t){e&&this._ensureValid("root",e);var n=this._rootElement,i=this._elementRegistry,r=this._eventBus;if(n){if(!t)throw new Error("rootElement already set, need to specify override");r.fire("root.remove",{element:n}),r.fire("root.removed",{element:n}),i.remove(n)}if(e){var o=this.getDefaultLayer();r.fire("root.add",{element:e}),i.add(e,o,this._svg),r.fire("root.added",{element:e,gfx:o})}return this._rootElement=e,e},$r.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=Fr[e];if(!(0,l.every)(n,function(e){return void 0!==t[e]}))throw new Error("must supply { "+n.join(", ")+" } with "+e)},$r.prototype._setParent=function(e,t,n){(0,Sn.add)(t.children,e,n),e.parent=t},$r.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var r=this._eventBus,o=this._graphicsFactory;this._ensureValid(e,t),r.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var a=o.create(e,t,i);return this._elementRegistry.add(t,a),o.update(e,t,a),r.fire(e+".added",{element:t,gfx:a}),t},$r.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)},$r.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)},$r.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,r=this._eventBus;if(e=n.get(e.id||e))return r.fire(t+".remove",{element:e}),i.remove(e),(0,Sn.remove)(e.parent&&e.parent.children,e),e.parent=null,r.fire(t+".removed",{element:e}),n.remove(e),e},$r.prototype.removeShape=function(e){return this._removeElement(e,"shape")},$r.prototype.removeConnection=function(e){return this._removeElement(e,"connection")},$r.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)},$r.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()},$r.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},$r.prototype.viewbox=function(e){if(void 0===e&&this._cachedViewbox)return this._cachedViewbox;var t,n,i,r,o,a,s=this._viewport,c=this.getSize();return e?(this._changeViewbox(function(){r=Math.min(c.width/e.width,c.height/e.height);var t=this._svg.createSVGMatrix().scale(r).translate(-e.x,-e.y);(0,we.transform)(s,t)}),e):(t=this.getDefaultLayer().getBBox(),n=(i=(0,we.transform)(s))?i.matrix:(0,we.createMatrix)(),r=Br(n.a,1e3),o=Br(-n.e||0,1e3),a=Br(-n.f||0,1e3),e=this._cachedViewbox={x:o?o/r:0,y:a?a/r:0,width:c.width/r,height:c.height/r,scale:r,inner:{width:t.width,height:t.height,x:t.x,y:t.y},outer:c})},$r.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=(0,l.assign)({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),Hr(t,n)}),{x:n.e,y:n.f}},$r.prototype.zoom=function(e,t){return e?"fit-viewport"===e?this._fitViewport(t):(this._changeViewbox(function(){"object"!==(void 0===t?"undefined":Dr(t))&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),Br(i.a,1e3)):this.viewbox(e).scale;var n,i},$r.prototype._fitViewport=function(e){var t,n,i=this.viewbox(),r=i.outer,o=i.inner;return o.x>=0&&o.y>=0&&o.x+o.width<=r.width&&o.y+o.height<=r.height&&!e?n={x:0,y:0,width:Math.max(o.width+o.x,r.width),height:Math.max(o.height+o.y,r.height)}:(t=Math.min(1,r.width/o.width,r.height/o.height),n={x:o.x+(e?o.width/2-r.width/t/2:0),y:o.y+(e?o.height/2-r.height/t/2:0),width:r.width/t,height:r.height/t}),this.viewbox(n),this.viewbox(!1).scale},$r.prototype._setZoom=function(e,t){var n,i,r,o,a=this._svg,s=this._viewport,c=a.createSVGMatrix(),u=a.createSVGPoint(),d=(i=s.getCTM()).a;return t?(n=(0,l.assign)(u,t).matrixTransform(i.inverse()),r=c.translate(n.x,n.y).scale(1/d*e).translate(-n.x,-n.y),o=i.multiply(r)):o=c.scale(e),Hr(this._viewport,o),o},$r.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},$r.prototype.getAbsoluteBBox=function(e){var t,n=this.viewbox();e.waypoints?t=this.getGraphics(e).getBBox():t=e;return{x:t.x*n.scale-n.x*n.scale,y:t.y*n.scale-n.y*n.scale,width:t.width*n.scale,height:t.height*n.scale}},$r.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var Ur={};function Vr(){this._uid=12}Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.default=Vr,Vr.prototype.createRoot=function(e){return this.create("root",e)},Vr.prototype.createLabel=function(e){return this.create("label",e)},Vr.prototype.createShape=function(e){return this.create("shape",e)},Vr.prototype.createConnection=function(e){return this.create("connection",e)},Vr.prototype.create=function(e,t){return(t=(0,l.assign)({},t||{})).id||(t.id=e+"_"+this._uid++),(0,B.create)(e,t)};var Wr={};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.default=qr;var Gr="data-element-id";function qr(e){this._elements={},this._eventBus=e}qr.$inject=["eventBus"],qr.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),(0,we.attr)(t,Gr,i),n&&(0,we.attr)(n,Gr,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}},qr.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&((0,we.attr)(i.gfx,Gr,""),i.secondaryGfx&&(0,we.attr)(i.secondaryGfx,Gr,""),delete t[n])},qr.prototype.updateId=function(e,t){this._validateId(t),"string"==typeof e&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)},qr.prototype.get=function(e){var t;t="string"==typeof e?e:e&&(0,we.attr)(e,Gr);var n=this._elements[t];return n&&n.element},qr.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t},qr.prototype.getAll=function(){return this.filter(function(e){return e})},qr.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],r=i.element,o=i.gfx;return e(r,o)})},qr.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)},qr.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});var Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Kr.default=Zr;var Xr=Array.prototype.slice;function Zr(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function Qr(){}Zr.prototype.on=function(e,t,n,i){if(e=(0,l.isArray)(e)?e:[e],(0,l.isFunction)(t)&&(i=n,n=t,t=1e3),!(0,l.isNumber)(t))throw new Error("priority must be a number");var r=n;i&&((r=(0,l.bind)(n,i)).__fn=n.__fn||n);var o=this;e.forEach(function(e){o._addListener(e,{priority:t,callback:r,next:null})})},Zr.prototype.once=function(e,t,n,i){var r=this;if((0,l.isFunction)(t)&&(i=n,n=t,t=1e3),!(0,l.isNumber)(t))throw new Error("priority must be a number");function o(){var t=n.apply(i,arguments);return r.off(e,o),t}o.__fn=n,this.on(e,t,o)},Zr.prototype.off=function(e,t){e=(0,l.isArray)(e)?e:[e];var n=this;e.forEach(function(e){n._removeListener(e,t)})},Zr.prototype.createEvent=function(e){var t=new Qr;return t.init(e),t},Zr.prototype.fire=function(e,t){var n,i,r,o;if(o=Xr.call(arguments),"object"===(void 0===e?"undefined":Yr(e))&&(e=(n=e).type),!e)throw new Error("no event type specified");if(i=this._listeners[e]){n=t instanceof Qr?t:this.createEvent(t),o[0]=n;var a=n.type;e!==a&&(n.type=e);try{r=this._invokeListeners(n,o,i)}finally{e!==a&&(n.type=a)}return void 0===r&&n.defaultPrevented&&(r=!1),r}},Zr.prototype.handleError=function(e){return!1===this.fire("error",{error:e})},Zr.prototype._destroy=function(){this._listeners={}},Zr.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i},Zr.prototype._invokeListener=function(e,t,n){var i;try{void 0!==(i=function(e,t){return e.apply(null,t)}(n.callback,t))&&(e.returnValue=i,e.stopPropagation()),!1===i&&e.preventDefault()}catch(e){if(!this.handleError(e))throw console.error("unhandled error in event listener"),console.error(e.stack),e}return i},Zr.prototype._addListener=function(e,t){var n,i=this._getListeners(e);if(i){for(;i;){if(i.priority<t.priority)return t.next=i,void(n?n.next=t:this._setListeners(e,t));n=i,i=i.next}n.next=t}else this._setListeners(e,t)},Zr.prototype._getListeners=function(e){return this._listeners[e]},Zr.prototype._setListeners=function(e,t){this._listeners[e]=t},Zr.prototype._removeListener=function(e,t){var n,i,r,o=this._getListeners(e);if(t)for(;o;)n=o.next,(r=o.callback)!==t&&r.__fn!==t||(i?i.next=n:this._setListeners(e,n)),i=o,o=n;else this._setListeners(e,null)},Qr.prototype.stopPropagation=function(){this.cancelBubble=!0},Qr.prototype.preventDefault=function(){this.defaultPrevented=!0},Qr.prototype.init=function(e){(0,l.assign)(this,e||{})};var Jr={};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.getVisual=function(e){return(0,at.query)(".djs-visual",e)},Jr.getChildren=function(e){return e.parentNode.childNodes[1]};var eo={};function to(e,t){this._eventBus=e,this._elementRegistry=t}function no(e,t,n){t.insertBefore(e,n||t.firstChild)}Object.defineProperty(eo,"__esModule",{value:!0}),eo.default=to,to.$inject=["eventBus","elementRegistry"],to.prototype._getChildren=function(e){var t,n=this._elementRegistry.getGraphics(e);return e.parent?(t=(0,Jr.getChildren)(n))||(t=(0,we.create)("g"),(0,we.classes)(t).add("djs-children"),(0,we.append)(n.parentNode,t)):t=n,t},to.prototype._clear=function(e){var t=(0,Jr.getVisual)(e);return(0,at.clear)(t),t},to.prototype._createContainer=function(e,t,n,i){var r=(0,we.create)("g");(0,we.classes)(r).add("djs-group"),void 0!==n?no(r,t,t.childNodes[n]):(0,we.append)(t,r);var o=(0,we.create)("g");(0,we.classes)(o).add("djs-element"),(0,we.classes)(o).add("djs-"+e),i&&(0,we.classes)(o).add("djs-frame"),(0,we.append)(r,o);var a=(0,we.create)("g");return(0,we.classes)(a).add("djs-visual"),(0,we.append)(o,a),o},to.prototype.create=function(e,t,n){var i=this._getChildren(t.parent);return this._createContainer(e,i,n,(0,kr.isFrameElement)(t))},to.prototype.updateContainments=function(e){var t,n=this,i=this._elementRegistry;t=(0,l.reduce)(e,function(e,t){return t.parent&&(e[t.parent.id]=t.parent),e},{}),(0,l.forEach)(t,function(e){var t=e.children;if(t&&!(t.length<2)){var r=n._getChildren(e);(0,l.forEach)(t.slice().reverse(),function(e){no(i.getGraphics(e).parentNode,r)})}})},to.prototype.drawShape=function(e,t){return this._eventBus.fire("render.shape",{gfx:e,element:t})},to.prototype.getShapePath=function(e){return this._eventBus.fire("render.getShapePath",e)},to.prototype.drawConnection=function(e,t){return this._eventBus.fire("render.connection",{gfx:e,element:t})},to.prototype.getConnectionPath=function(e){return this._eventBus.fire("render.getConnectionPath",e)},to.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if("shape"===e)this.drawShape(i,t),(0,Ze.translate)(n,t.x,t.y);else{if("connection"!==e)throw new Error("unknown type: "+e);this.drawConnection(i,t)}t.hidden?(0,we.attr)(n,"display","none"):(0,we.attr)(n,"display","block")}},to.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);(0,we.remove)(t.parentNode)};var io={};Object.defineProperty(io,"__esModule",{value:!0}),io.default=co;var ro=ao(u),oo=ao(_e);function ao(e){return e&&e.__esModule?e:{default:e}}var so=1;function co(e,t){oo.default.call(this,e,so),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}(0,ro.default)(co,oo.default),co.prototype.canRender=function(){return!0},co.prototype.drawShape=function(e,t){var n=(0,we.create)("rect");return(0,we.attr)(n,{x:0,y:0,width:t.width||0,height:t.height||0}),(0,kr.isFrameElement)(t)?(0,we.attr)(n,this.FRAME_STYLE):(0,we.attr)(n,this.SHAPE_STYLE),(0,we.append)(e,n),n},co.prototype.drawConnection=function(e,t){var n=(0,Ye.createLine)(t.waypoints,this.CONNECTION_STYLE);return(0,we.append)(e,n),n},co.prototype.getShapePath=function(e){var t=e.x,n=e.y,i=e.width,r=[["M",t,n],["l",i,0],["l",0,e.height],["l",-i,0],["z"]];return(0,Ye.componentsToPath)(r)},co.prototype.getConnectionPath=function(e){var t,n,i=e.waypoints,r=[];for(t=0;n=i[t];t++)n=n.original||n,r.push([0===t?"M":"L",n.x,n.y]);return(0,Ye.componentsToPath)(r)},co.$inject=["eventBus","styles"];var uo={};Object.defineProperty(uo,"__esModule",{value:!0}),uo.default=function(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(e,t,n){var i=this.style(t,n);return(0,l.assign)(i,{class:e})},this.style=function(t,n){(0,l.isArray)(t)||n||(n=t,t=[]);var i=(0,l.reduce)(t,function(t,n){return(0,l.assign)(t,e[n]||{})},{});return n?(0,l.assign)(i,n):i},this.computeStyle=function(e,n,i){return(0,l.isArray)(n)||(i=n,n=[]),t.style(n||[],(0,l.assign)({},i,e||{}))}};var lo={};Object.defineProperty(lo,"__esModule",{value:!0});var po=ho(io),fo=ho(uo);function ho(e){return e&&e.__esModule?e:{default:e}}lo.default={__init__:["defaultRenderer"],defaultRenderer:["type",po.default],styles:["type",fo.default]};var mo={};Object.defineProperty(mo,"__esModule",{value:!0});var yo=wo(lo),vo=wo(Ir),go=wo(Wr),_o=wo(Ur),xo=wo(Kr),bo=wo(eo);function wo(e){return e&&e.__esModule?e:{default:e}}mo.default={__depends__:[yo.default],__init__:["canvas"],canvas:["type",vo.default],elementRegistry:["type",go.default],elementFactory:["type",_o.default],eventBus:["type",xo.default],graphicsFactory:["type",bo.default]};var Eo={},Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(Eo,"__esModule",{value:!0});var So=/^class /;function Co(e){return"[object Array]"===Object.prototype.toString.call(e)}function Po(){var e=Array.prototype.slice.call(arguments);1===e.length&&Co(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Ro=/constructor\s*[^(]*\(\s*([^)]*)\)/m,ko=/^function\s*[^(]*\(\s*([^)]*)\)/m,To=/\/\*([^*]*)\*\//m;function Ao(e){if("function"!=typeof e)throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(function(e){return So.test(e.toString())}(e)?Ro:ko);return t&&t[1]&&t[1].split(",").map(function(e){return(t=e.match(To))?t[1].trim():e.trim()})||[]}function Oo(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}var jo="function"==typeof Symbol&&"symbol"===Mo(Symbol.iterator)?function(e){return void 0===e?"undefined":Mo(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":Mo(e)};function No(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function Io(e,t){return Object.hasOwnProperty.call(e,t)}Eo.Injector=function e(t,n){n=n||{get:function(e,t){if(i.push(e),!1===t)return null;throw s('No provider for "'+e+'"!')}};var i=[],r=this._providers=Object.create(n._providers||null),o=this._instances=Object.create(null),a=o.injector=this,s=function(e){var t=i.join(" -> ");return i.length=0,new Error(t?e+" (Resolving: "+t+")":e)},c=function e(t,a){if(!r[t]&&-1!==t.indexOf(".")){for(var c=t.split("."),u=e(c.shift());c.length;)u=u[c.shift()];return u}if(Io(o,t))return o[t];if(Io(r,t)){if(-1!==i.indexOf(t))throw i.push(t),s("Cannot resolve circular dependency!");return i.push(t),o[t]=r[t][0](r[t][1]),i.pop(),o[t]}return n.get(t,a)},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof e){if(!Co(e))throw new Error('Cannot invoke "'+e+'". Expected a function!');e=Po(e.slice())}return{fn:e,dependencies:(e.$inject||Ao(e)).map(function(e){return Io(t,e)?t[e]:c(e)})}},l=function(e){var t=u(e),n=t.dependencies,i=t.fn;return new(Function.prototype.bind.apply(i,[null].concat(No(n))))},d=function(e,t,n){var i=u(e,n),r=i.dependencies,o=i.fn;return o.call.apply(o,[t].concat(No(r)))},p=function(e){return Po(function(t){return e.get(t)})},f={factory:d,type:l,value:function(e){return e}};t.forEach(function(t){function n(e,t){return"value"!==e&&Co(t)&&(t=Po(t.slice())),t}if(t instanceof Oo)t.forEach(function(e){var t=e[0],i=e[1],o=e[2];r[t]=[f[i],n(i,o),i]});else if("object"===(void 0===t?"undefined":jo(t)))if(t.__exports__){var i=Object.keys(t).reduce(function(e,n){return"__"!==n.substring(0,2)&&(e[n]=t[n]),e},Object.create(null)),o=new e((t.__modules__||[]).concat([i]),a),s=Po(function(e){return o.get(e)});t.__exports__.forEach(function(e){r[e]=[s,e,"private",o]})}else Object.keys(t).forEach(function(e){if("private"!==t[e][2]){var i=t[e][0],o=t[e][1];r[e]=[f[i],n(i,o),i]}else r[e]=t[e]})}),this.get=c,this.invoke=d,this.instantiate=l,this.createChild=function(t,n){if(n&&n.length){var i,o,s,c,u=Object.create(null),l=Object.create(null),d=[],f=[],h=[];for(var m in r)i=r[m],-1!==n.indexOf(m)&&("private"===i[2]?-1===(o=d.indexOf(i[3]))?(s=i[3].createChild([],n),c=p(s),d.push(i[3]),f.push(s),h.push(c),u[m]=[c,m,"private",s]):u[m]=[h[o],m,"private",f[o]]:u[m]=[i[2],i[1]],l[m]=!0),"factory"!==i[2]&&"type"!==i[2]||!i[1].$scope||n.forEach(function(e){-1!==i[1].$scope.indexOf(e)&&(u[m]=[i[2],i[1]],l[e]=!0)});n.forEach(function(e){if(!l[e])throw new Error('No provider for "'+e+'". Cannot use provider from the parent!')}),t.unshift(u)}return new e(t,a)}};var Do={};Object.defineProperty(Do,"__esModule",{value:!0}),Do.default=zo;var Bo=function(e){return e&&e.__esModule?e:{default:e}}(mo);function Lo(e){var t=[],n=[];function i(e){return t.indexOf(e)>=0}e.forEach(function e(r){i(r)||((r.__depends__||[]).forEach(e),i(r)||(function(e){t.push(e)}(r),(r.__init__||[]).forEach(function(e){n.push(e)})))});var r=new Eo.Injector(t);return n.forEach(function(e){try{r["string"==typeof e?"get":"invoke"](e)}catch(e){throw console.error("Failed to instantiate component"),console.error(e.stack),e}}),r}function zo(e,t){this.injector=t=t||function(e){return Lo([{config:["value",e=e||{}]},Bo.default].concat(e.modules||[]))}(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}zo.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},zo.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var Fo={};Object.defineProperty(Fo,"__esModule",{value:!0}),Object.defineProperty(Fo,"default",{enumerable:!0,get:function(){return(e=Do,e&&e.__esModule?e:{default:e}).default;var e}});var $o={};function Ho(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(1e9*Math.random())+"-"}Object.defineProperty($o,"__esModule",{value:!0}),$o.default=Ho,Ho.prototype.next=function(){return this._prefix+ ++this._counter};var Uo={};Object.defineProperty(Uo,"__esModule",{value:!0}),Uo.default=Wo;var Vo=new(function(e){return e&&e.__esModule?e:{default:e}}($o).default)("ov");function Wo(e,t,n,i){var r,o;this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=Vo,this._overlayDefaults=(0,l.assign)({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(r=n.getContainer(),o=(0,at.domify)('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),r.insertBefore(o,r.firstChild),o),this._init()}function Go(e,t,n){(0,l.assign)(e.style,{left:t+"px",top:n+"px"})}function qo(e,t){e.style.display=!1===t?"none":""}function Ko(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}Wo.$inject=["config.overlays","eventBus","canvas","elementRegistry"],Wo.prototype.get=function(e){if((0,l.isString)(e)&&(e={id:e}),(0,l.isString)(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?(0,l.filter)(t.overlays,(0,l.matchPattern)({type:e.type})):t.overlays.slice():[]}return e.type?(0,l.filter)(this._overlays,(0,l.matchPattern)({type:e.type})):e.id?this._overlays[e.id]:null},Wo.prototype.add=function(e,t,n){if((0,l.isObject)(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=(0,l.assign)({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i},Wo.prototype.remove=function(e){var t=this.get(e)||[];(0,l.isArray)(t)||(t=[t]);var n=this;(0,l.forEach)(t,function(e){var t=n._getOverlayContainer(e.element,!0);if(e&&((0,at.remove)(e.html),(0,at.remove)(e.htmlContainer),delete e.htmlContainer,delete e.element,delete n._overlays[e.id]),t){var i=t.overlays.indexOf(e);-1!==i&&t.overlays.splice(i,1)}})},Wo.prototype.show=function(){qo(this._overlayRoot)},Wo.prototype.hide=function(){qo(this._overlayRoot,!1)},Wo.prototype.clear=function(){this._overlays={},this._overlayContainers=[],(0,at.clear)(this._overlayRoot)},Wo.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,r=t.y;if(t.waypoints){var o=(0,kr.getBBox)(t);i=o.x,r=o.y}Go(n,i,r),(0,at.attr)(e.html,"data-container-id",t.id)},Wo.prototype._updateOverlay=function(e){var t,n,i=e.position,r=e.htmlContainer,o=e.element,a=i.left,s=i.top;void 0!==i.right&&(t=o.waypoints?(0,kr.getBBox)(o).width:o.width,a=-1*i.right+t);void 0!==i.bottom&&(n=o.waypoints?(0,kr.getBBox)(o).height:o.height,s=-1*i.bottom+n);Go(r,a||0,s||0)},Wo.prototype._createOverlayContainer=function(e){var t=(0,at.domify)('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},Wo.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";Ko(this._overlayRoot,n)},Wo.prototype._getOverlayContainer=function(e,t){var n=(0,l.find)(this._overlayContainers,function(t){return t.element===e});return n||t?n:this._createOverlayContainer(e)},Wo.prototype._addOverlay=function(e){var t,n,i=e.id,r=e.element,o=e.html;o.get&&o.constructor.prototype.jquery&&(o=o.get(0)),(0,l.isString)(o)&&(o=(0,at.domify)(o)),n=this._getOverlayContainer(r),(t=(0,at.domify)('<div class="djs-overlay" data-overlay-id="'+i+'" style="position: absolute">')).appendChild(o),e.type&&(0,at.classes)(t).add("djs-overlay-"+e.type),e.htmlContainer=t,n.overlays.push(e),n.html.appendChild(t),this._overlays[i]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())},Wo.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=n&&n.minZoom,r=n&&n.maxZoom,o=e.htmlContainer,a=!0;n&&(((0,l.isDefined)(i)&&i>t.scale||(0,l.isDefined)(r)&&r<t.scale)&&(a=!1),qo(o,a)),this._updateOverlayScale(e,t)},Wo.prototype._updateOverlayScale=function(e,t){var n,i,r,o=e.scale,a=e.htmlContainer,s="";!0!==o&&(!1===o?(n=1,i=1):(n=o.min,i=o.max),(0,l.isDefined)(n)&&t.scale<n&&(r=(1/t.scale||1)*n),(0,l.isDefined)(i)&&t.scale>i&&(r=(1/t.scale||1)*i)),(0,l.isDefined)(r)&&(s="scale("+r+","+r+")"),Ko(a,s)},Wo.prototype._updateOverlaysVisibilty=function(e){var t=this;(0,l.forEach)(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})},Wo.prototype._init=function(){var e=this._eventBus,t=this;e.on("canvas.viewbox.changing",function(e){t.hide()}),e.on("canvas.viewbox.changed",function(e){var n;n=e.viewbox,t._updateRoot(n),t._updateOverlaysVisibilty(n),t.show()}),e.on(["shape.remove","connection.remove"],function(e){var n=e.element,i=t.get({element:n});(0,l.forEach)(i,function(e){t.remove(e.id)});var r=t._getOverlayContainer(n);if(r){(0,at.remove)(r.html);var o=t._overlayContainers.indexOf(r);-1!==o&&t._overlayContainers.splice(o,1)}}),e.on("element.changed",500,function(e){var n=e.element,i=t._getOverlayContainer(n,!0);i&&((0,l.forEach)(i.overlays,function(e){t._updateOverlay(e)}),t._updateOverlayContainer(i))}),e.on("element.marker.update",function(e){var n=t._getOverlayContainer(e.element,!0);n&&(0,at.classes)(n.html)[e.add?"add":"remove"](e.marker)}),e.on("diagram.clear",this.clear,this)};var Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});var Xo=function(e){return e&&e.__esModule?e:{default:e}}(Uo);Yo.default={__init__:["overlays"],overlays:["type",Xo.default]};var Zo={};function Qo(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()}function Jo(e){return e.originalEvent||e.srcEvent}Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.getOriginal=Jo,Zo.stopPropagation=function(e,t){Qo(e),Qo(Jo(e))},Zo.toPoint=function(e){e.pointers&&e.pointers.length&&(e=e.pointers[0]);e.touches&&e.touches.length&&(e=e.touches[0]);return e?{x:e.clientX,y:e.clientY}:null};var ea={};Object.defineProperty(ea,"__esModule",{value:!0}),ea.isMac=function(){return/mac/i.test(navigator.platform)};var ta={};function na(e){return!((0,Zo.getOriginal)(e)||e).button}Object.defineProperty(ta,"__esModule",{value:!0}),Object.defineProperty(ta,"isMac",{enumerable:!0,get:function(){return ea.isMac}}),ta.isPrimaryButton=na,ta.hasPrimaryModifier=function(e){var t=(0,Zo.getOriginal)(e)||e;if(!na(e))return!1;return(0,ea.isMac)()?t.metaKey:t.ctrlKey},ta.hasSecondaryModifier=function(e){var t=(0,Zo.getOriginal)(e)||e;return na(e)&&t.shiftKey};var ia={};function ra(e){return!0}Object.defineProperty(ia,"__esModule",{value:!0}),ia.default=aa;var oa=500;function aa(e,t,n){var i=n.cls("djs-hit",["no-fill","no-border"],{stroke:"white",strokeWidth:15});function r(n,i,r){var o,a;(function(e,t){return!(c[e]||ta.isPrimaryButton)(t)})(n,i)||(r?a=t.getGraphics(r):(o=i.delegateTarget||i.target)&&(a=o,r=t.get(a)),a&&r&&!1===e.fire(n,{element:r,gfx:a,originalEvent:i})&&(i.stopPropagation(),i.preventDefault()))}var o={};function a(e){return o[e]}var s={mouseover:"element.hover",mouseout:"element.out",click:"element.click",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseup:"element.mouseup",contextmenu:"element.contextmenu"},c={"element.contextmenu":ra};var u="svg, .djs-element";function d(e,t,n,i){var a=o[n]=function(e){r(n,e)};i&&(c[n]=i),a.$delegate=at.delegate.bind(e,u,t,a)}function p(e,t,n){var i=a(n);i&&at.delegate.unbind(e,t,i.$delegate)}e.on("canvas.destroy",function(e){var t;t=e.svg,(0,l.forEach)(s,function(e,n){p(t,n,e)})}),e.on("canvas.init",function(e){var t;t=e.svg,(0,l.forEach)(s,function(e,n){d(t,n,e)})}),e.on(["shape.added","connection.added"],function(e){var t,n=e.element,r=e.gfx;n.waypoints?t=(0,Ye.createLine)(n.waypoints):(t=(0,we.create)("rect"),(0,we.attr)(t,{x:0,y:0,width:n.width,height:n.height})),(0,we.attr)(t,i),(0,we.append)(r,t)}),e.on("shape.changed",oa,function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-hit",n);(0,we.attr)(i,{width:t.width,height:t.height})}),e.on("connection.changed",function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-hit",n);(0,Ye.updateLine)(i,t.waypoints)}),this.fire=r,this.triggerMouseEvent=function(e,t,n){var i=s[e];if(!i)throw new Error("unmapped DOM event name <"+e+">");return r(i,t,n)},this.mouseHandler=a,this.registerEvent=d,this.unregisterEvent=p}aa.$inject=["eventBus","elementRegistry","styles"];var sa={};Object.defineProperty(sa,"__esModule",{value:!0});var ca=function(e){return e&&e.__esModule?e:{default:e}}(ia);sa.default={__init__:["interactionEvents"],interactionEvents:["type",ca.default]};var ua={};Object.defineProperty(ua,"__esModule",{value:!0}),ua.default=da;var la=500;function da(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),r=this;function o(e,t){var n=(0,we.create)("rect");return(0,we.attr)(n,(0,l.assign)({x:10,y:10,width:100,height:100},i)),(0,we.append)(e,n),n}e.on(["shape.added","shape.changed"],la,function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-outline",n);i||(i=o(n)),r.updateShapeOutline(i,t)}),e.on(["connection.added","connection.changed"],function(e){var t=e.element,n=e.gfx,i=(0,at.query)(".djs-outline",n);i||(i=o(n)),r.updateConnectionOutline(i,t)})}da.prototype.updateShapeOutline=function(e,t){(0,we.attr)(e,{x:-this.offset,y:-this.offset,width:t.width+2*this.offset,height:t.height+2*this.offset})},da.prototype.updateConnectionOutline=function(e,t){var n=(0,kr.getBBox)(t);(0,we.attr)(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},da.$inject=["eventBus","styles","elementRegistry"];var pa={};Object.defineProperty(pa,"__esModule",{value:!0});var fa=function(e){return e&&e.__esModule?e:{default:e}}(ua);pa.default={__init__:["outline"],outline:["type",fa.default]};var ha={};function ma(e){this._eventBus=e,this._selectedElements=[];var t=this;e.on(["shape.remove","connection.remove"],function(e){var n=e.element;t.deselect(n)}),e.on(["diagram.clear"],function(e){t.select(null)})}Object.defineProperty(ha,"__esModule",{value:!0}),ha.default=ma,ma.$inject=["eventBus"],ma.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(-1!==n){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}},ma.prototype.get=function(){return this._selectedElements},ma.prototype.isSelected=function(e){return-1!==this._selectedElements.indexOf(e)},ma.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();(0,l.isArray)(e)||(e=e?[e]:[]),t?(0,l.forEach)(e,function(e){-1===n.indexOf(e)&&n.push(e)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var ya={};function va(e,t,n,i){e.on("create.end",500,function(e){e.context.canExecute&&t.select(e.context.shape)}),e.on("connect.end",500,function(e){e.context.canExecute&&e.context.target&&t.select(e.context.target)}),e.on("shape.move.end",500,function(e){var n=e.previousSelection||[],r=i.get(e.context.shape.id);(0,l.find)(n,function(e){return r.id===e.id})||t.select(r)}),e.on("element.click",function(e){var i=e.element;i===n.getRootElement()&&(i=null);var r=t.isSelected(i),o=t.get().length>1,a=(0,ta.hasPrimaryModifier)(e);if(r&&o)return a?t.deselect(i):t.select(i);r?t.deselect(i):t.select(i,a)})}Object.defineProperty(ya,"__esModule",{value:!0}),ya.default=va,va.$inject=["eventBus","selection","canvas","elementRegistry"];var ga={};Object.defineProperty(ga,"__esModule",{value:!0}),ga.default=ba;var _a="hover",xa="selected";function ba(e,t,n,i){function r(e,n){t.addMarker(e,n)}function o(e,n){t.removeMarker(e,n)}this._multiSelectionBox=null,e.on("element.hover",function(e){r(e.element,_a)}),e.on("element.out",function(e){o(e.element,_a)}),e.on("selection.changed",function(e){var t=e.oldSelection,n=e.newSelection;(0,l.forEach)(t,function(e){-1===n.indexOf(e)&&o(e,xa)}),(0,l.forEach)(n,function(e){-1===t.indexOf(e)&&r(e,xa)})})}ba.$inject=["eventBus","canvas","selection","styles"];var wa={};Object.defineProperty(wa,"__esModule",{value:!0});var Ea=Ra(sa),Ma=Ra(pa),Sa=Ra(ha),Ca=Ra(ga),Pa=Ra(ya);function Ra(e){return e&&e.__esModule?e:{default:e}}wa.default={__init__:["selectionVisuals","selectionBehavior"],__depends__:[Ea.default,Ma.default],selection:["type",Sa.default],selectionVisuals:["type",Ca.default],selectionBehavior:["type",Pa.default]};var ka=l.assign,Ta=l.omit,Aa=l.isNumber,Oa=at.domify,ja=at.query,Na=at.remove,Ia=we.innerSVG,Da=Fo.default,Ba=Rr.default;var La={width:"100%",height:"100%",position:"relative"};function za(e){return e+(Aa(e)?"px":"")}function Fa(e){var t,n,i;e=ka({},La,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),t=this._container,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+jn.LINK_STYLES+'">'+jn.BPMNIO_IMG+"</a>",i=Oa(n),t.appendChild(i),Ha.bind(i,"click",function(e){jn.open(),e.preventDefault()}),this._init(this._container,this._moddle,e)}u(Fa,Da);var $a=Fa;Fa.prototype.importXML=function(e,t){t=t||function(){};var n=this;e=this._emit("import.parse.start",{xml:e})||e,this._moddle.fromXML(e,"cmmn:Definitions",function(e,i,r){i=n._emit("import.parse.complete",{error:e,definitions:i,context:r})||i;var o=r.warnings;if(e)return e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);return t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid CMMN 1.1 diagram file"+t[2]),e}(e),n._emit("import.done",{error:e,warnings:o}),t(e,o);n.importDefinitions(i,function(e,i){var r=[].concat(o,i||[]);n._emit("import.done",{error:e,warnings:r}),t(e,r)})})},Fa.prototype.saveXML=function(e,t){t||(t=e,e={});var n=this,i=this._definitions;if(!i)return t(new Error("no definitions loaded"));i=this._emit("saveXML.start",{definitions:i})||i,this._moddle.toXML(i,e,function(e,i){try{i=n._emit("saveXML.serialized",{error:e,xml:i})||i,n._emit("saveXML.done",{error:e,xml:i})}catch(e){console.error("error in saveXML life-cycle listener",e)}t(e,i)})},Fa.prototype.saveSVG=function(e,t){t||(t=e,e={});var n=this.get("canvas"),i=n.getDefaultLayer(),r=ja("defs",n._svg),o=Ia(i),a=r&&r.outerHTML||"",s=i.getBBox();t(null,'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with cmmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+s.width+'" height="'+s.height+'" viewBox="'+s.x+" "+s.y+" "+s.width+" "+s.height+'" version="1.1">'+a+o+"</svg>")},Fa.prototype.importDefinitions=function(e,t){try{this._definitions&&this.clear(),this._definitions=e,On.importCmmnDiagram(this,e,t)}catch(e){t(e)}},Fa.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"==typeof e&&(e=ja(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},Fa.prototype.getDefinitions=function(){return this._definitions},Fa.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},Fa.prototype.getModules=function(){return this._modules},Fa.prototype.destroy=function(){Da.prototype.destroy.call(this),Na(this._container)},Fa.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)},Fa.prototype.off=function(e,t){this.get("eventBus").off(e,t)},Fa.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),r=n.additionalModules||[],o=[].concat([{cmmnjs:["value",this],moddle:["value",t]}],i,r),a=ka(Ta(n,"additionalModules"),{canvas:ka({},n.canvas,{container:e}),modules:o});Da.call(this,a),n&&n.container&&this.attachTo(n.container)},Fa.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},Fa.prototype._createContainer=function(e){var t=Oa('<div class="cjs-container"></div>');return ka(t.style,{width:za(e.width),height:za(e.height),position:e.position}),t},Fa.prototype._createModdle=function(e){var t=ka({},this._moddleExtensions,e.moddleExtensions);return new Ba(t)},Fa.prototype._modules=[Mn,wa.default,Yo.default];var Ha=at.event;var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0}),Ua.install=function(e,t){function n(){return!1}return t=t||"element.click",e.once(t,Va,n),function(){e.off(t,n)}};var Va=5e3;var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0}),Wa.set=qa,Wa.unset=function(){qa(null)};var Ga=/^djs-cursor-.*$/;function qa(e){var t=(0,at.classes)(document.body);t.removeMatching(Ga),e&&t.add("djs-cursor-"+e)}var Ka={};Object.defineProperty(Ka,"__esModule",{value:!0}),Ka.center=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}},Ka.delta=function(e,t){return{x:e.x-t.x,y:e.y-t.y}};var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0}),Ya.default=Za;var Xa=15;function Za(e,t){var n;function i(i){var r,o=n.start,a=(0,Zo.toPoint)(i),s=(0,Ka.delta)(a,o);if(!n.dragging&&(r=s,Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))>Xa)&&(n.dragging=!0,(0,Ua.install)(e),(0,Wa.set)("grab")),n.dragging){var c=n.last||n.start;s=(0,Ka.delta)(a,c),t.scroll({dx:s.x,dy:s.y}),n.last=a}i.preventDefault()}function r(e){at.event.unbind(document,"mousemove",i),at.event.unbind(document,"mouseup",r),n=null,(0,Wa.unset)()}e.on("element.mousedown",500,function(e){return function(e){if((0,at.closest)(e.target,".djs-draggable"))return;if(e.button||e.ctrlKey||e.shiftKey||e.altKey)return;return n={start:(0,Zo.toPoint)(e)},at.event.bind(document,"mousemove",i),at.event.bind(document,"mouseup",r),!0}(e.originalEvent)})}Za.$inject=["eventBus","canvas"];var Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});var Ja=function(e){return e&&e.__esModule?e:{default:e}}(Ya);Qa.default={__init__:["moveCanvas"],moveCanvas:["type",Ja.default]};var es={};Object.defineProperty(es,"__esModule",{value:!0}),es.log10=function(e){return Math.log(e)/Math.log(10)},Object.defineProperty(es,"substract",{enumerable:!0,get:function(){return Ka.delta}});var ts={};Object.defineProperty(ts,"__esModule",{value:!0}),ts.getStepSize=function(e,t){var n=(0,es.log10)(e.min),i=(0,es.log10)(e.max);return(Math.abs(n)+Math.abs(i))/t},ts.cap=function(e,t){return Math.max(e.min,Math.min(e.max,t))};var ns={};Object.defineProperty(ns,"__esModule",{value:!0}),ns.default=as;var is=Math.sign||function(e){return e>=0?1:-1},rs={min:.2,max:4},os=.75;function as(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=(0,l.bind)(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||os;var i=this;t.on("canvas.init",function(t){i._init(!1!==e.enabled)})}as.$inject=["config.zoomScroll","eventBus","canvas"],as.prototype.scroll=function(e){this._canvas.scroll(e)},as.prototype.reset=function(){this._canvas.zoom("fit-viewport")},as.prototype.zoom=function(e,t){var n=(0,ts.getStepSize)(rs,20);this._totalDelta+=e,Math.abs(this._totalDelta)>.1&&(this._zoom(e,t,n),this._totalDelta=0)},as.prototype._handleWheel=function(e){if(!(0,at.closest)(e.target,".djs-scrollable",!0)){var t=this._container;e.preventDefault();var n,i=e.ctrlKey,r=e.shiftKey,o=-1*this._scale;if(o*=i?0===e.deltaMode?.02:.32:0===e.deltaMode?1:16,i){var a=t.getBoundingClientRect(),s={x:e.clientX-a.left,y:e.clientY-a.top};n=Math.sqrt(Math.pow(e.deltaY,2)+Math.pow(e.deltaX,2))*is(e.deltaY)*o,this.zoom(n,s)}else n=r?{dx:o*e.deltaY,dy:0}:{dx:o*e.deltaX,dy:o*e.deltaY},this.scroll(n)}},as.prototype.stepZoom=function(e,t){var n=(0,ts.getStepSize)(rs,10);this._zoom(e,t,n)},as.prototype._zoom=function(e,t,n){var i=this._canvas,r=e>0?1:-1,o=(0,es.log10)(i.zoom()),a=Math.round(o/n)*n;a+=n*r;var s=Math.pow(10,a);i.zoom((0,ts.cap)(rs,s),t)},as.prototype.toggle=function(e){var t=this._container,n=this._handleWheel,i=this._enabled;return void 0===e&&(e=!i),i!==e&&at.event[e?"bind":"unbind"](t,"wheel",n,!1),this._enabled=e,e},as.prototype._init=function(e){this.toggle(e)};var ss={};Object.defineProperty(ss,"__esModule",{value:!0});var cs=function(e){return e&&e.__esModule?e:{default:e}}(ns);function us(e){$a.call(this,e)}ss.default={__init__:["zoomScroll"],zoomScroll:["type",cs.default]},u(us,$a);var ls=us;us.prototype._navigationModules=[ss.default,Qa.default],us.prototype._modules=[].concat(us.prototype._modules,us.prototype._navigationModules);var ds={};Object.defineProperty(ds,"__esModule",{value:!0}),ds.default=ps;function ps(e){this._eventBus=e}ps.$inject=["eventBus"],ps.prototype.on=function(e,t,n,i,r,o){if(((0,l.isFunction)(t)||(0,l.isNumber)(t))&&(o=r,r=i,i=n,n=t,t=null),(0,l.isFunction)(n)&&(o=r,r=i,i=n,n=1e3),(0,l.isObject)(r)&&(o=r,r=!1),!(0,l.isFunction)(i))throw new Error("handlerFn must be a function");(0,l.isArray)(e)||(e=[e]);var a=this._eventBus;(0,l.forEach)(e,function(e){var s=["commandStack",e,t].filter(function(e){return e}).join(".");a.on(s,n,r?function(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}(i,o):i,o)})};(0,l.forEach)(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(e){ps.prototype[e]=function(t,n,i,r,o){((0,l.isFunction)(t)||(0,l.isNumber)(t))&&(o=r,r=i,i=n,n=t,t=null),this.on(t,e,n,i,r,o)}});var fs={};Object.defineProperty(fs,"__esModule",{value:!0}),fs.default=vs;var hs=ys(u),ms=ys(ds);function ys(e){return e&&e.__esModule?e:{default:e}}function vs(e){ms.default.call(this,e),this.init()}vs.$inject=["eventBus"],(0,hs.default)(vs,ms.default),vs.prototype.addRule=function(e,t,n){var i=this;"string"==typeof e&&(e=[e]),e.forEach(function(e){i.canExecute(e,t,function(e,t,i){return n(e)},!0)})},vs.prototype.init=function(){};var gs={};Object.defineProperty(gs,"__esModule",{value:!0}),gs.default=ws;var _s=bs(fs),xs=bs(u);function bs(e){return e&&e.__esModule?e:{default:e}}function ws(e){_s.default.call(this,e);var t=this;this.addRule("element.autoResize",function(e){return t.canResize(e.elements,e.target)})}ws.$inject=["eventBus"],(0,xs.default)(ws,_s.default),ws.prototype.canResize=function(e,t){return!1};var Es=e.is,Ms=e.getDefinition,Ss=l.forEach,Cs=gs.default;function Ps(e){Cs.call(this,e)}u(Ps,Cs),Ps.$inject=["eventBus"];var Rs=Ps;Ps.prototype.canResize=function(e,t){if(Es(t,"cmmn:CMMNElement")){var n=!0;if(Ss(e,function(e){Es(e,"cmmn:Criterion")||(n=!1)}),!n){var i=Ms(t);return Es(i,"cmmn:PlanFragment")}}};var ks={};function Ts(e,t){return e&&t?Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)):-1}Object.defineProperty(ks,"__esModule",{value:!0}),ks.pointDistance=Ts,ks.pointsOnLine=function(e,t,n,i){void 0===i&&(i=5);if(!e||!t||!n)return!1;var r=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),o=Ts(e,t);return Math.abs(r/o)<=i},ks.pointsAligned=function(e,t){if(Math.abs(e.x-t.x)<=As)return"v";if(Math.abs(e.y-t.y)<=As)return"h";return!1},ks.pointInRect=function(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n},ks.getMidPoint=function(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}};var As=2;var Os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},js="hasOwnProperty",Ns=/,?([a-z]),?/gi,Is=parseFloat,Ds=Math,Bs=Ds.PI,Ls=Ds.min,zs=Ds.max,Fs=Ds.pow,$s=Ds.abs,Hs=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,Us=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;function Vs(e,t){return"finite"==(t=String.prototype.toLowerCase.call(t))?isFinite(e):!("array"!=t||!(e instanceof Array||Array.isArray&&Array.isArray(e)))||("null"==t&&null===e||t==(void 0===e?"undefined":Os(e))&&null!==e||"object"==t&&e===Object(e)||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()==t)}function Ws(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[js](n)&&(t[n]=Ws(e[n]));return t}function Gs(e){var t=Gs.ps=Gs.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[js](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function qs(e,t,n,i){return null==e&&(e=t=n=i=0),null==t&&(t=e.y,n=e.width,i=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:i,h:i,x2:e+n,y2:t+i,cx:e+n/2,cy:t+i/2,r1:Ds.min(n,i)/2,r2:Ds.max(n,i)/2,r0:Ds.sqrt(n*n+i*i)/2,path:function(e,t,n,i,r){if(r)return[["M",+e+ +r,t],["l",n-2*r,0],["a",r,r,0,0,1,r,r],["l",0,i-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-n,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-i],["a",r,r,0,0,1,r,-r],["z"]];var o=[["M",e,t],["l",n,0],["l",0,i],["l",-n,0],["z"]];return o.toString=Ks,o}(e,t,n,i),vb:[e,t,n,i].join(" ")}}function Ks(){return this.join(",").replace(Ns,"$1")}function Ys(e){var t=Ws(e);return t.toString=Ks,t}function Xs(e,t,n,i,r,o,a,s,c){var u=1-c,l=Fs(u,3),d=Fs(u,2),p=c*c,f=p*c,h=e+2*c*(n-e)+p*(r-2*n+e),m=t+2*c*(i-t)+p*(o-2*i+t),y=n+2*c*(r-n)+p*(a-2*r+n),v=i+2*c*(o-i)+p*(s-2*o+i);return{x:l*e+3*d*c*n+3*u*c*c*r+f*a,y:l*t+3*d*c*i+3*u*c*c*o+f*s,m:{x:h,y:m},n:{x:y,y:v},start:{x:u*e+c*n,y:u*t+c*i},end:{x:u*r+c*a,y:u*o+c*s},alpha:90-180*Ds.atan2(h-y,m-v)/Bs}}function Zs(e,t,n,i,r,o,a,s){Vs(e,"array")||(e=[e,t,n,i,r,o,a,s]);var c=function(e,t,n,i,r,o,a,s){for(var c,u,l,d,p,f,h,m,y=[],v=[[],[]],g=0;g<2;++g)if(0==g?(u=6*e-12*n+6*r,c=-3*e+9*n-9*r+3*a,l=3*n-3*e):(u=6*t-12*i+6*o,c=-3*t+9*i-9*o+3*s,l=3*i-3*t),$s(c)<1e-12){if($s(u)<1e-12)continue;0<(d=-l/u)&&d<1&&y.push(d)}else h=u*u-4*l*c,m=Ds.sqrt(h),h<0||(0<(p=(-u+m)/(2*c))&&p<1&&y.push(p),0<(f=(-u-m)/(2*c))&&f<1&&y.push(f));var _,x=y.length,b=x;for(;x--;)d=y[x],_=1-d,v[0][x]=_*_*_*e+3*_*_*d*n+3*_*d*d*r+d*d*d*a,v[1][x]=_*_*_*t+3*_*_*d*i+3*_*d*d*o+d*d*d*s;return v[0][b]=e,v[1][b]=t,v[0][b+1]=a,v[1][b+1]=s,v[0].length=v[1].length=b+2,{min:{x:Ls.apply(0,v[0]),y:Ls.apply(0,v[1])},max:{x:zs.apply(0,v[0]),y:zs.apply(0,v[1])}}}.apply(null,e);return qs(c.min.x,c.min.y,c.max.x-c.min.x,c.max.y-c.min.y)}function Qs(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function Js(e,t,n,i,r){return e*(e*(-3*t+9*n-9*i+3*r)+6*t-12*n+6*i)-3*t+3*n}function ec(e,t,n,i,r,o,a,s,c){null==c&&(c=1);for(var u=(c=c>1?1:c<0?0:c)/2,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,f=0;f<12;f++){var h=u*l[f]+u,m=Js(h,e,n,r,a),y=Js(h,t,i,o,s),v=m*m+y*y;p+=d[f]*Ds.sqrt(v)}return u*p}function tc(e,t,n,i,r,o,a,s){if(!(zs(e,n)<Ls(r,a)||Ls(e,n)>zs(r,a)||zs(t,i)<Ls(o,s)||Ls(t,i)>zs(o,s))){var c=(e-n)*(o-s)-(t-i)*(r-a);if(c){var u=((e*i-t*n)*(r-a)-(e-n)*(r*s-o*a))/c,l=((e*i-t*n)*(o-s)-(t-i)*(r*s-o*a))/c,d=+u.toFixed(2),p=+l.toFixed(2);if(!(d<+Ls(e,n).toFixed(2)||d>+zs(e,n).toFixed(2)||d<+Ls(r,a).toFixed(2)||d>+zs(r,a).toFixed(2)||p<+Ls(t,i).toFixed(2)||p>+zs(t,i).toFixed(2)||p<+Ls(o,s).toFixed(2)||p>+zs(o,s).toFixed(2)))return{x:u,y:l}}}}function nc(e,t,n){if(!function(e,t){return e=qs(e),Qs(t=qs(t),e.x,e.y)||Qs(t,e.x2,e.y)||Qs(t,e.x,e.y2)||Qs(t,e.x2,e.y2)||Qs(e,t.x,t.y)||Qs(e,t.x2,t.y)||Qs(e,t.x,t.y2)||Qs(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}(Zs(e),Zs(t)))return n?0:[];for(var i=~~(ec.apply(0,e)/5),r=~~(ec.apply(0,t)/5),o=[],a=[],s={},c=n?0:[],u=0;u<i+1;u++){var l=Xs.apply(0,e.concat(u/i));o.push({x:l.x,y:l.y,t:u/i})}for(u=0;u<r+1;u++)l=Xs.apply(0,t.concat(u/r)),a.push({x:l.x,y:l.y,t:u/r});for(u=0;u<i;u++)for(var d=0;d<r;d++){var p=o[u],f=o[u+1],h=a[d],m=a[d+1],y=$s(f.x-p.x)<.01?"y":"x",v=$s(m.x-h.x)<.01?"y":"x",g=tc(p.x,p.y,f.x,f.y,h.x,h.y,m.x,m.y);if(g){if(s[g.x.toFixed(0)]==g.y.toFixed(0))continue;s[g.x.toFixed(0)]=g.y.toFixed(0);var _=p.t+$s((g[y]-p[y])/(f[y]-p[y]))*(f.t-p.t),x=h.t+$s((g[v]-h[v])/(m[v]-h[v]))*(m.t-h.t);_>=0&&_<=1&&x>=0&&x<=1&&(n?c++:c.push({x:g.x,y:g.y,t1:_,t2:x}))}}return c}function ic(e,t,n,i,r){if(null==r&&null==i&&(i=n),e=+e,t=+t,n=+n,i=+i,null!=r)var o=Math.PI/180,a=e+n*Math.cos(-i*o),s=e+n*Math.cos(-r*o),c=[["M",a,t+n*Math.sin(-i*o)],["A",n,n,0,+(r-i>180),0,s,t+n*Math.sin(-r*o)]];else c=[["M",e,t],["m",0,-i],["a",n,i,0,1,1,0,2*i],["a",n,i,0,1,1,0,-2*i],["z"]];return c.toString=Ks,c}function rc(e){var t=Gs(e);if(t.abs)return Ys(t.abs);if(Vs(e,"array")&&Vs(e&&e[0],"array")||(e=function(e){if(!e)return null;var t=Gs(e);if(t.arr)return Ws(t.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},i=[];return Vs(e,"array")&&Vs(e[0],"array")&&(i=Ws(e)),i.length||String(e).replace(Hs,function(e,t,r){var o=[],a=t.toLowerCase();if(r.replace(Us,function(e,t){t&&o.push(+t)}),"m"==a&&o.length>2&&(i.push([t].concat(o.splice(0,2))),a="l",t="m"==t?"l":"L"),"o"==a&&1==o.length&&i.push([t,o[0]]),"r"==a)i.push([t].concat(o));else for(;o.length>=n[a]&&(i.push([t].concat(o.splice(0,n[a]))),n[a]););}),i.toString=Gs.toString,t.arr=Ws(i),i}(e)),!e||!e.length)return[["M",0,0]];var n,i=[],r=0,o=0,a=0,s=0,c=0;"M"==e[0][0]&&(a=r=+e[0][1],s=o=+e[0][2],c++,i[0]=["M",r,o]);for(var u,l,d=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),p=c,f=e.length;p<f;p++){if(i.push(u=[]),(n=(l=e[p])[0])!=n.toUpperCase())switch(u[0]=n.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+r,u[7]=+l[7]+o;break;case"V":u[1]=+l[1]+o;break;case"H":u[1]=+l[1]+r;break;case"R":for(var h=[r,o].concat(l.slice(1)),m=2,y=h.length;m<y;m++)h[m]=+h[m]+r,h[++m]=+h[m]+o;i.pop(),i=i.concat(cc(h,d));break;case"O":i.pop(),(h=ic(r,o,l[1],l[2])).push(h[0]),i=i.concat(h);break;case"U":i.pop(),i=i.concat(ic(r,o,l[1],l[2],l[3])),u=["U"].concat(i[i.length-1].slice(-2));break;case"M":a=+l[1]+r,s=+l[2]+o;default:for(m=1,y=l.length;m<y;m++)u[m]=+l[m]+(m%2?r:o)}else if("R"==n)h=[r,o].concat(l.slice(1)),i.pop(),i=i.concat(cc(h,d)),u=["R"].concat(l.slice(-2));else if("O"==n)i.pop(),(h=ic(r,o,l[1],l[2])).push(h[0]),i=i.concat(h);else if("U"==n)i.pop(),i=i.concat(ic(r,o,l[1],l[2],l[3])),u=["U"].concat(i[i.length-1].slice(-2));else for(var v=0,g=l.length;v<g;v++)u[v]=l[v];if("O"!=(n=n.toUpperCase()))switch(u[0]){case"Z":r=+a,o=+s;break;case"H":r=u[1];break;case"V":o=u[1];break;case"M":a=u[u.length-2],s=u[u.length-1];default:r=u[u.length-2],o=u[u.length-1]}}return i.toString=Ks,t.abs=Ys(i),i}function oc(e,t,n,i){return[e,t,n,i,n,i]}function ac(e,t,n,i,r,o){return[1/3*e+2/3*n,1/3*t+2/3*i,1/3*r+2/3*n,1/3*o+2/3*i,r,o]}function sc(e,t,n,i,r,o,a,s,c,u){var l,d,p,f,h=120*Bs/180,m=Bs/180*(+r||0),y=[],v=(d=function(e,t,n){return{x:e*Ds.cos(n)-t*Ds.sin(n),y:e*Ds.sin(n)+t*Ds.cos(n)}},function e(){var t=Array.prototype.slice.call(arguments,0),n=t.join(""),i=e.cache=e.cache||{},r=e.count=e.count||[];return i[js](n)?(function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}(r,n),f?f(i[n]):i[n]):(r.length>=1e3&&delete i[r.shift()],r.push(n),i[n]=d.apply(p,t),f?f(i[n]):i[n])});if(u)C=u[0],P=u[1],M=u[2],S=u[3];else{e=(l=v(e,t,-m)).x,t=l.y;var g=(e-(s=(l=v(s,c,-m)).x))/2,_=(t-(c=l.y))/2,x=g*g/(n*n)+_*_/(i*i);x>1&&(n*=x=Ds.sqrt(x),i*=x);var b=n*n,w=i*i,E=(o==a?-1:1)*Ds.sqrt($s((b*w-b*_*_-w*g*g)/(b*_*_+w*g*g))),M=E*n*_/i+(e+s)/2,S=E*-i*g/n+(t+c)/2,C=Ds.asin(((t-S)/i).toFixed(9)),P=Ds.asin(((c-S)/i).toFixed(9));(C=e<M?Bs-C:C)<0&&(C=2*Bs+C),(P=s<M?Bs-P:P)<0&&(P=2*Bs+P),a&&C>P&&(C-=2*Bs),!a&&P>C&&(P-=2*Bs)}var R=P-C;if($s(R)>h){var k=P,T=s,A=c;P=C+h*(a&&P>C?1:-1),y=sc(s=M+n*Ds.cos(P),c=S+i*Ds.sin(P),n,i,r,0,a,T,A,[P,k,M,S])}R=P-C;var O=Ds.cos(C),j=Ds.sin(C),N=Ds.cos(P),I=Ds.sin(P),D=Ds.tan(R/4),B=4/3*n*D,L=4/3*i*D,z=[e,t],F=[e+B*j,t-L*O],$=[s+B*I,c-L*N],H=[s,c];if(F[0]=2*z[0]-F[0],F[1]=2*z[1]-F[1],u)return[F,$,H].concat(y);for(var U=[],V=0,W=(y=[F,$,H].concat(y).join().split(",")).length;V<W;V++)U[V]=V%2?v(y[V-1],y[V],m).y:v(y[V],y[V+1],m).x;return U}function cc(e,t){for(var n=[],i=0,r=e.length;r-2*!t>i;i+=2){var o=[{x:+e[i-2],y:+e[i-1]},{x:+e[i],y:+e[i+1]},{x:+e[i+2],y:+e[i+3]},{x:+e[i+4],y:+e[i+5]}];t?i?r-4==i?o[3]={x:+e[0],y:+e[1]}:r-2==i&&(o[2]={x:+e[0],y:+e[1]},o[3]={x:+e[2],y:+e[3]}):o[0]={x:+e[r-2],y:+e[r-1]}:r-4==i?o[3]=o[2]:i||(o[0]={x:+e[i],y:+e[i+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}function uc(e,t){var n=!t&&Gs(e);if(!t&&n.curve)return Ys(n.curve);for(var i=rc(e),r=t&&rc(t),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=function(e,t,n){var i,r;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(sc.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==n||"S"==n?(i=2*t.x-t.bx,r=2*t.y-t.by):(i=t.x,r=t.y),e=["C",i,r].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(ac(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(ac(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(oc(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(oc(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(oc(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(oc(t.x,t.y,t.X,t.Y))}return e},c=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)l[t]="A",r&&(d[t]="A"),e.splice(t++,0,["C"].concat(n.splice(0,6)));e.splice(t,1),m=zs(i.length,r&&r.length||0)}},u=function(e,t,n,o,a){e&&t&&"M"==e[a][0]&&"M"!=t[a][0]&&(t.splice(a,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=e[a][1],n.y=e[a][2],m=zs(i.length,r&&r.length||0))},l=[],d=[],p="",f="",h=0,m=zs(i.length,r&&r.length||0);h<m;h++){i[h]&&(p=i[h][0]),"C"!=p&&(l[h]=p,h&&(f=l[h-1])),i[h]=s(i[h],o,f),"A"!=l[h]&&"C"==p&&(l[h]="C"),c(i,h),r&&(r[h]&&(p=r[h][0]),"C"!=p&&(d[h]=p,h&&(f=d[h-1])),r[h]=s(r[h],a,f),"A"!=d[h]&&"C"==p&&(d[h]="C"),c(r,h)),u(i,r,o,a,h),u(r,i,a,o,h);var y=i[h],v=r&&r[h],g=y.length,_=r&&v.length;o.x=y[g-2],o.y=y[g-1],o.bx=Is(y[g-4])||o.x,o.by=Is(y[g-3])||o.y,a.bx=r&&(Is(v[_-4])||a.x),a.by=r&&(Is(v[_-3])||a.y),a.x=r&&v[_-2],a.y=r&&v[_-1]}return r||(n.curve=Ys(i)),r?[i,r]:i}var lc=function(e,t,n){e=uc(e),t=uc(t);for(var i,r,o,a,s,c,u,l,d,p,f=n?0:[],h=0,m=e.length;h<m;h++){var y=e[h];if("M"==y[0])i=s=y[1],r=c=y[2];else{"C"==y[0]?(i=(d=[i,r].concat(y.slice(1)))[6],r=d[7]):(d=[i,r,i,r,s,c,s,c],i=s,r=c);for(var v=0,g=t.length;v<g;v++){var _=t[v];if("M"==_[0])o=u=_[1],a=l=_[2];else{"C"==_[0]?(o=(p=[o,a].concat(_.slice(1)))[6],a=p[7]):(p=[o,a,o,a,u,l,u,l],o=u,a=l);var x=nc(d,p,n);if(n)f+=x;else{for(var b=0,w=x.length;b<w;b++)x[b].segment1=h,x[b].segment2=v,x[b].bez1=d,x[b].bez2=p;f=f.concat(x)}}}}}return f},dc={};Object.defineProperty(dc,"__esModule",{value:!0}),dc.roundBounds=function(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}},dc.roundPoint=fc,dc.asTRBL=hc,dc.asBounds=function(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}},dc.getMid=function(e){return fc({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})},dc.getOrientation=function(e,t,n){n=n||0,(0,l.isObject)(n)||(n={x:n,y:n});var i=hc(e),r=hc(t),o=i.bottom+n.y<=r.top,a=i.left-n.x>=r.right,s=i.top-n.y>=r.bottom,c=i.right+n.x<=r.left,u=o?"top":s?"bottom":null,d=c?"left":a?"right":null;return d&&u?u+"-"+d:d||u||"intersect"},dc.getElementLineIntersection=function(e,t,n){var i=mc(e,t);if(1===i.length)return fc(i[0]);if(2===i.length&&(0,ks.pointDistance)(i[0],i[1])<1)return fc(i[0]);if(i.length>1)return fc((i=(0,l.sortBy)(i,function(e){var t=Math.floor(100*e.t2)||1;return t=((t=100-t)<10?"0":"")+t,e.segment2+"#"+t}))[n?0:i.length-1]);return null},dc.filterRedundantWaypoints=function(e){e=e.slice();var t,n,i,r=0;for(;e[r];)t=e[r],n=e[r-1],i=e[r+1],0===(0,ks.pointDistance)(t,i)||(0,ks.pointsOnLine)(n,i,t)?e.splice(r,1):r++;return e};var pc=function(e){return e&&e.__esModule?e:{default:e}}(lc);function fc(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function hc(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function mc(e,t){return(0,pc.default)(e,t)}var yc={};Object.defineProperty(yc,"__esModule",{value:!0}),yc.default=xc;var vc=_c(u),gc=_c(ds);function _c(e){return e&&e.__esModule?e:{default:e}}function xc(e,t,n,i){gc.default.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var r=this;this.postExecuted(["shape.create"],function(e){var t=e.context,n=t.hints,i=t.shape,o=t.parent||t.newParent;(!n||!1!==n.root&&!1!==n.autoResize)&&r._expand([i],o)}),this.postExecuted(["elements.move"],function(e){var t=e.context,n=(0,l.flatten)((0,l.values)(t.closure.topLevel)),i=t.hints,o=!i||i.autoResize;if(!1!==o){var a=(0,l.groupBy)(n,function(e){return e.parent.id});(0,l.forEach)(a,function(e,t){(0,l.isArray)(o)&&(e=e.filter(function(e){return-1!==o.indexOf(e)})),r._expand(e,t)})}}),this.postExecuted(["shape.toggleCollapse"],function(e){var t=e.context,n=t.hints,i=t.shape;(!n||!1!==n.root&&!1!==n.autoResize)&&(i.collapsed||r._expand(i.children||[],i))}),this.postExecuted(["shape.resize"],function(e){var t=e.context,n=t.hints,i=t.shape,o=i.parent;(!n||!1!==n.root&&!1!==n.autoResize)&&o&&r._expand([i],o)})}xc.$inject=["eventBus","elementRegistry","modeling","rules"],(0,vc.default)(xc,gc.default),xc.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),r=(0,dc.asTRBL)((0,kr.getBBox)(e)),o=(0,dc.asTRBL)(t),a={};return r.top-o.top<i.top&&(a.top=r.top-n.top),r.left-o.left<i.left&&(a.left=r.left-n.left),o.right-r.right<i.right&&(a.right=r.right+n.right),o.bottom-r.bottom<i.bottom&&(a.bottom=r.bottom+n.bottom),(0,dc.asBounds)((0,l.assign)({},o,a))},xc.prototype._expand=function(e,t){if("string"==typeof t&&(t=this._elementRegistry.get(t)),this._rules.allowed("element.autoResize",{elements:e,target:t})){var n=this._getOptimalBounds(e,t);if(function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(n,t)){var i=function(e,t){var n="";e=(0,dc.asTRBL)(e),t=(0,dc.asTRBL)(t),e.top>t.top&&(n=n.concat("n"));e.right<t.right&&(n=n.concat("w"));e.bottom<t.bottom&&(n=n.concat("s"));e.left>t.left&&(n=n.concat("e"));return n}((0,l.pick)(t,["x","y","width","height"]),n);this.resize(t,n,{autoResize:i});var r=t.parent;r&&this._expand([t],r)}}},xc.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}},xc.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}},xc.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};var bc={};Object.defineProperty(bc,"__esModule",{value:!0});var wc=function(e){return e&&e.__esModule?e:{default:e}}(yc);bc.default={__init__:["autoResize"],autoResize:["type",wc.default]};var Ec={__init__:["cmmnAutoResizeProvider"],__depends__:[bc.default],cmmnAutoResizeProvider:["type",Rs]},Mc=l.assign,Sc=l.isArray,Cc=Q.isAny,Pc=e.is,Rc=e.getDefinition;function kc(e,t,n,i,r,o,a,s){e.registerProvider(this),this._contextPad=e,this._connect=t,this._create=n,this._elementFactory=i,this._modeling=r,this._rules=o,this._popupMenu=a,this._canvas=s}kc.$inject=["contextPad","connect","create","elementFactory","modeling","rules","popupMenu","canvas"];var Tc=kc;kc.prototype.getContextPadEntries=function(e){var t,n,i,r=this._contextPad,o=this._connect,a=this._create,s=this._elementFactory,c=this._modeling,u=this._canvas,l=this._rules,d=this._popupMenu,p={};if("label"===e.type)return p;function f(e,t,n){o.start(e,t,n)}function h(e,t,n,i,r){function o(t,n){var r=s.createShape(Mc({type:e},i));a.start(t,r,n)}return"string"!=typeof n&&(i=n,n="Append "+e.replace(/^cmmn:/,"")),{group:"model",className:t,title:n,action:{dragstart:r||o,click:r||o}}}Cc(e,["cmmn:PlanItem","cmmn:CaseFileItem"])&&Mc(p,{"append.entryCriterion":(t="cmmn-icon-entry-criterion",n="Append Criterion",h("cmmn:EntryCriterion",t,n,i,function(e,t){var n=s.createCriterionShape("cmmn:EntryCriterion");a.start(e,n,t)}))}),function(e){var t=Rc(e);return Pc(t,"cmmn:HumanTask")&&t.isBlocking}(e)&&Mc(p,{"append.discretionaryItem":function(e,t,n){return h("cmmn:DiscretionaryItem",e,t,n,function(e,t){var n=s.createDiscretionaryItemShape("cmmn:Task");a.start(e,n,t)})}("cmmn-icon-task-discretionary","Append DiscretionaryItem")}),d.isEmpty(e,"cmmn-replace")||Mc(p,{replace:{group:"edit",className:"cmmn-icon-screw-wrench",title:"Change type",action:{click:function(e,t){var n=Mc(function(e){var t=u.getContainer(),n=r.getPad(e).html,i=t.getBoundingClientRect(),o=n.getBoundingClientRect(),a=o.top-i.top;return{x:o.left-i.left,y:a+o.height+5}}(t),{cursor:{x:e.x,y:e.y}});d.open(t,"cmmn-replace",n)}}}}),Cc(e,["cmmndi:CMMNEdge","cmmn:TextAnnotation"])||Mc(p,{"append.text-annotation":h("cmmn:TextAnnotation","cmmn-icon-text-annotation")}),Cc(e,["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:CaseFileItem","cmmn:Criterion"])&&Mc(p,{connect:{group:"connect",className:"cmmn-icon-connection",title:"Connect using Discretionary/OnPart or Association",action:{click:f,dragstart:f}}});var m=l.allowed("elements.delete",{elements:[e]});return Sc(m)&&(m=m[0]===e),m&&Mc(p,{delete:{group:"edit",className:"cmmn-icon-trash",title:"Remove",action:{click:function(t){c.removeElements([e])}}}}),p};var Ac={},Oc=e.is,jc=e.getDefinition,Nc=e.getBusinessObject,Ic=Q.isAny,Dc=Q.getParent,Bc=kr.eachElement;function Lc(e){zc(e=Nc(e))&&(e=jc(e));var t=[];if(Fc(e)&&(e=e.planningTable)){var n=e.get("tableItems");Bc(n,function(e){if(!$c(e))return e.get("tableItems");t.push(e)})}return t}function zc(e){return Ic(e,["cmmn:DiscretionaryItem","cmmn:PlanItem"])}function Fc(e){return Ic(e,["cmmn:HumanTask","cmmn:Stage"])}function $c(e){return Oc(e,"cmmn:DiscretionaryItem")}Ac.getAllDiscretionaryItems=Lc,Ac.getDirectItemCapables=function(e){zc(e=Nc(e))&&(e=jc(e));var t,n=[];function i(e){n.push(e)}return e&&(Oc(e,"cmmn:PlanFragment")&&(t=e.get("planItems"),Bc(t,i)),Fc(e)&&(t=Lc(e),Bc(t,i))),n},Ac.isItemCapable=zc,Ac.isPlanningTableCapable=Fc,Ac.isDiscretionaryItem=$c,Ac.isDiscretionaryToHumanTask=function(e){var t=Nc(e),n=Dc(t,"cmmn:PlanItemDefinition");return Oc(n,"cmmn:HumanTask")},Ac.isHumanTask=function(e){return Oc(e,"cmmn:HumanTask")},Ac.isPlanFragment=function(e){return Oc(e,"cmmn:PlanFragment")&&!Oc(e,"cmmn:Stage")};var Hc={TASK:[{label:"Task",actionName:"replace-with-task-plan-item",className:"cmmn-icon-task-none",target:{definitionType:"cmmn:Task",type:"cmmn:PlanItem"}},{label:"Human Task",actionName:"replace-with-blocking-human-task-plan-item",className:"cmmn-icon-human-blocking-task",target:{definitionType:"cmmn:HumanTask",type:"cmmn:PlanItem",isBlocking:!0}},{label:"Human Task",actionName:"replace-with-non-blocking-human-task-plan-item",className:"cmmn-icon-human-non-blocking-task",target:{definitionType:"cmmn:HumanTask",type:"cmmn:PlanItem",isBlocking:!1}},{label:"Decision Task",actionName:"replace-with-decision-task-plan-item",className:"cmmn-icon-decision-task",target:{definitionType:"cmmn:DecisionTask",type:"cmmn:PlanItem"}},{label:"Process Task",actionName:"replace-with-process-task-plan-item",className:"cmmn-icon-process-task",target:{definitionType:"cmmn:ProcessTask",type:"cmmn:PlanItem"}},{label:"Case Task",actionName:"replace-with-case-task-plan-item",className:"cmmn-icon-case-task",target:{definitionType:"cmmn:CaseTask",type:"cmmn:PlanItem"}},{label:"Stage (collapsed)",actionName:"replace-with-collapsed-stage-plan-item",className:"cmmn-icon-stage-collapsed",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!0}},{label:"Stage (expanded)",actionName:"replace-with-expanded-stage-plan-item",className:"cmmn-icon-stage-expanded",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!1}},{label:"Discretionary Task",actionName:"replace-with-task-discretionary-item",className:"cmmn-icon-task-discretionary",target:{definitionType:"cmmn:Task",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Human Task",actionName:"replace-with-blocking-human-task-discretionary-item",className:"cmmn-icon-human-blocking-task-discretionary",target:{definitionType:"cmmn:HumanTask",type:"cmmn:DiscretionaryItem",isBlocking:!0}},{label:"Discretionary Human Task",actionName:"replace-with-non-blocking-human-task-discretionary-item",className:"cmmn-icon-human-non-blocking-task-discretionary",target:{definitionType:"cmmn:HumanTask",type:"cmmn:DiscretionaryItem",isBlocking:!1}},{label:"Discretionary Decision Task",actionName:"replace-with-decision-task-discretionary-item",className:"cmmn-icon-decision-task-discretionary",target:{definitionType:"cmmn:DecisionTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Process Task",actionName:"replace-with-process-task-discretionary-item",className:"cmmn-icon-process-task-discretionary",target:{definitionType:"cmmn:ProcessTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Case Task",actionName:"replace-with-case-task-discretionary-item",className:"cmmn-icon-case-task-discretionary",target:{definitionType:"cmmn:CaseTask",type:"cmmn:DiscretionaryItem"}},{label:"Discretionary Stage (collapsed)",actionName:"replace-with-collapsed-stage-discretionary-item",className:"cmmn-icon-stage-collapsed-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!0}},{label:"Discretionary Stage (expanded)",actionName:"replace-with-expanded-stage-discretionary-item",className:"cmmn-icon-stage-expanded-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!1}}],PLAN_FRAGMENT_EXPANDED:[{label:"Stage",actionName:"replace-with-stage-plan-item",className:"cmmn-icon-stage-expanded",target:{definitionType:"cmmn:Stage",type:"cmmn:PlanItem",isCollapsed:!1}},{label:"Discretionary Stage",actionName:"replace-with-stage-discretionary-item",className:"cmmn-icon-stage-expanded-discretionary",target:{definitionType:"cmmn:Stage",type:"cmmn:DiscretionaryItem",isCollapsed:!1}},{label:"Discretionary Plan Fragment",actionName:"replace-with-plan-fragment-discretionary-item",className:"cmmn-icon-plan-fragment-expanded-discretionary",target:{definitionType:"cmmn:PlanFragment",type:"cmmn:DiscretionaryItem",isCollapsed:!1}}],EVENT_LISTENER:[{label:"Event Listener",actionName:"replace-with-event-listener-plan-item",className:"cmmn-icon-event-listener",target:{definitionType:"cmmn:EventListener",type:"cmmn:PlanItem"}},{label:"Timer Event Listener",actionName:"replace-with-timer-event-listener-plan-item",className:"cmmn-icon-timer-event-listener",target:{definitionType:"cmmn:TimerEventListener",type:"cmmn:PlanItem"}},{label:"User Event Listener",actionName:"replace-with-user-event-listener-plan-item",className:"cmmn-icon-user-event-listener",target:{definitionType:"cmmn:UserEventListener",type:"cmmn:PlanItem"}}],CRITERION:[{label:"Entry Criterion",actionName:"replace-with-entry-criterion",className:"cmmn-icon-entry-criterion",target:{type:"cmmn:EntryCriterion"}},{label:"Exit Criterion",actionName:"replace-with-exit-criterion",className:"cmmn-icon-exit-criterion",target:{type:"cmmn:ExitCriterion"}}]},Uc=l.forEach,Vc=l.filter,Wc=Ac.isItemCapable,Gc=Q.isAny,qc=e.getBusinessObject,Kc=e.getDefinition,Yc=e.isCasePlanModel,Xc=e.isRequired,Zc=e.isRepeatable,Qc=e.isManualActivation,Jc=e.is,eu=me.isCollapsed;function tu(e,t){return qc(e).$type!==t.target.type}function nu(e,t){return Kc(e).$type!==t.target.definitionType}function iu(e,t){var n=t.type,i=t.definitionType,r=e.parent,o=Kc(e);if(function(e){return Jc(e,"cmmn:PlanItem")}(e)&&"cmmn:DiscretionaryItem"===n&&!au(r))return!1;if("cmmn:HumanTask"===i){if(ou(e)&&!t.isBlocking)return!1;if(su(e)&&o.isBlocking!==t.isBlocking)return!1}return!0}function ru(e,t,n,i,r){this._popupMenu=e,this._cmmnReplace=t,this._cmmnFactory=n,this._modeling=i,this._rules=r,this.register()}function ou(e){return Jc(Kc(e),"cmmn:PlanFragment")}function au(e){return Jc(Kc(e),"cmmn:Stage")}function su(e){return Jc(Kc(e),"cmmn:Task")}ru.$inject=["popupMenu","cmmnReplace","cmmnFactory","modeling","rules"],ru.prototype.register=function(){this._popupMenu.registerProvider("cmmn-replace",this)},ru.prototype.getEntries=function(e){var t,n=this._rules,i=Kc(e);if(!n.allowed("shape.replace",{element:e}))return[];if(Wc(e)){if(su(e))return t=Vc(Hc.TASK,function(t){var n=t.target;if(iu(e,n))return tu(e,t)^nu(e,t)}),this._createEntries(e,t);if(ou(e)){if(!eu(e))return t=Vc(Hc.PLAN_FRAGMENT_EXPANDED,function(t){var n=t.target;if(iu(e,n))return tu(e,t)||nu(e,t)}),this._createEntries(e,t);if(eu(e))return t=Vc(Hc.TASK,function(t){var n=t.target,r=n.definitionType;return!!iu(e,n)&&(r===i.$type&&!n.isCollapsed||tu(e,t)^nu(e,t))}),this._createEntries(e,t)}if(function(e){return Jc(Kc(e),"cmmn:EventListener")}(e))return t=Vc(Hc.EVENT_LISTENER,function(t){return nu(e,t)}),this._createEntries(e,t)}return function(e){return Jc(e,"cmmn:Criterion")}(e)?(t=Vc(Hc.CRITERION,function(t){return tu(e,t)}),this._createEntries(e,t)):[]},ru.prototype.getHeaderEntries=function(e){var t=[];return su(e)&&(t=t.concat(this._getBlockingEntry(e))),au(e)&&(t=t.concat(this._getAutoCompleteEntry(e))),function(e){var t=Kc(e);return!Yc(e)&&Gc(t,["cmmn:Stage","cmmn:Milestone","cmmn:Task"])}(e)&&(t=t.concat(this._getRuleEntries(e))),t},ru.prototype._createEntries=function(e,t){var n=[],i=this;return Uc(t,function(t){var r=i._createMenuEntry(t,e);n.push(r)}),n},ru.prototype._createMenuEntry=function(e,t,n){var i=this._cmmnReplace.replaceElement;return n=n||function(){return i(t,e.target)},{label:e.label,className:e.className,id:e.actionName,action:n}},ru.prototype._getBlockingEntry=function(e){var t=this;return[{id:"toggle-is-blocking",className:"cmmn-icon-blocking",title:"Blocking",active:Kc(e).isBlocking,action:function(n,i){var r=!i.active;t._modeling.updateControls(e,{isBlocking:r})}}]},ru.prototype._getAutoCompleteEntry=function(e){var t=this;return[{id:"toggle-auto-complete",className:"cmmn-icon-auto-complete-marker",title:"Auto Complete",active:Kc(e).autoComplete,action:function(n,i){var r=!i.active;t._modeling.updateControls(e,{autoComplete:r})}}]},ru.prototype._getRuleEntries=function(e){var t=this;function n(n,i){return function(r,o){var a={};o.active?a[n]=void 0:a[n]=t._cmmnFactory.create(i),t._modeling.updateControls(e,a)}}var i=Zc(e),r=Xc(e),o=Qc(e),a=[{id:"toggle-required-rule",className:"cmmn-icon-required-marker",title:"Required Rule",active:r,action:n("requiredRule","cmmn:RequiredRule")}];return function(e){return Jc(Kc(e),"cmmn:Milestone")}(e)||a.push({id:"toggle-manual-activation-rule",className:"cmmn-icon-manual-activation-marker",title:"Manual Activation Rule",active:o,action:n("manualActivationRule","cmmn:ManualActivationRule")}),a.push({id:"toggle-repetition-rule",className:"cmmn-icon-repetition-marker",title:"Repetition Rule",active:i,action:n("repetitionRule","cmmn:RepetitionRule")}),a};var cu={__init__:["replaceMenuProvider"],replaceMenuProvider:["type",ru]},uu={};Object.defineProperty(uu,"__esModule",{value:!0});var lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function du(e,t,n,i){function r(e,t){return i.allowed("connection.create",{source:e,target:t})}e.on("connect.hover",function(e){var t=e.context,n=t.source,i=e.hover;null!==(t.canExecute=r(n,i))&&(t.target=i)}),e.on(["connect.out","connect.cleanup"],function(e){var t=e.context;t.target=null,t.canExecute=!1}),e.on("connect.end",function(e){var t=e.context,i=t.source,o=t.sourcePosition,a=t.target,s={x:e.x,y:e.y},c=t.canExecute||r(i,a);if(!c)return!1;var u=null,l={connectionStart:o,connectionEnd:s};"object"===(void 0===c?"undefined":lu(c))&&(u=c),n.connect(i,a,u,l)}),this.start=function(e,n,i,r){"object"!==(void 0===i?"undefined":lu(i))&&(r=i,i=(0,dc.getMid)(n)),t.init(e,"connect",{autoActivate:r,data:{shape:n,context:{source:n,sourcePosition:i}}})}}uu.default=du,du.$inject=["eventBus","dragging","modeling","rules"];var pu={};Object.defineProperty(pu,"__esModule",{value:!0}),pu.default=vu;var fu=1100,hu=900,mu="connect-ok",yu="connect-not-ok";function vu(e,t,n){var i=e.get("connectionPreview",!1);t.on("connect.move",function(e){var t=e.context,n=t.source,r=t.target,o=t.canExecute,a={x:e.x,y:e.y};i&&i.drawPreview(t,o,{source:n,target:r,connectionEnd:a})}),t.on("connect.hover",hu,function(e){var t=e.context,i=e.hover,r=t.canExecute;null!==r&&n.addMarker(i,r?mu:yu)}),t.on(["connect.out","connect.cleanup"],fu,function(e){var t=e.context;t.target&&n.removeMarker(t.target,t.canExecute?mu:yu)}),t.on("connect.cleanup",function(e){i&&i.cleanUp(e.context)})}vu.$inject=["injector","eventBus","canvas"];var gu={};Object.defineProperty(gu,"__esModule",{value:!0}),gu.default=wu;var _u=Math.round,xu="djs-drag-active";function bu(e){e.preventDefault()}function wu(e,t,n){var i,r={threshold:5,trapClick:!0};function o(e){var n=t.viewbox(),i=t._container.getBoundingClientRect();return{x:n.x+(e.x-i.left)/n.scale,y:n.y+(e.y-i.top)/n.scale}}function a(t,n){n=n||i;var r=e.createEvent((0,l.assign)({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==e.fire("drag."+t,r)&&e.fire(n.prefix+"."+t,r)}function s(e,r){var s,c=i.payload,u=i.displacement,d=i.globalStart,p=(0,Zo.toPoint)(e),f=(0,Ka.delta)(p,d),h=i.localStart,y=o(p),v=(0,Ka.delta)(y,h);if(!i.active&&(r||(s=f,Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2))>i.threshold))){if((0,l.assign)(c,{x:_u(h.x+u.x),y:_u(h.y+u.y),dx:0,dy:0},{originalEvent:e}),!1===a("start"))return m();i.active=!0,i.keepSelection||(c.previousSelection=n.get(),n.select(null)),i.cursor&&(0,Wa.set)(i.cursor),t.addMarker(t.getRootElement(),xu)}(0,Zo.stopPropagation)(e),i.active&&((0,l.assign)(c,{x:_u(y.x+u.x),y:_u(y.y+u.y),dx:_u(v.x),dy:_u(v.y)},{originalEvent:e}),a("move"))}function c(e){var t=!0;i.active&&(e&&(i.payload.originalEvent=e,(0,Zo.stopPropagation)(e)),t=a("end")),!1===t&&a("rejected"),a("ended",y(!0!==t))}function u(e){27===e.which&&(bu(e),m())}function d(t){var n;i.active&&(n=(0,Ua.install)(e),setTimeout(n,400),bu(t)),c(t)}function p(e){s(e)}function f(e){var t=i.payload;t.hoverGfx=e.gfx,t.hover=e.element,a("hover")}function h(e){a("out");var t=i.payload;t.hoverGfx=null,t.hover=null}function m(e){var t;if(i){var n=i.active;n&&a("cancel"),t=y(e),n&&a("canceled",t)}}function y(r){var o,l;a("cleanup"),(0,Wa.unset)(),l=i.trapClick?d:c,at.event.unbind(document,"mousemove",s),at.event.unbind(document,"dragstart",bu),at.event.unbind(document,"selectstart",bu),at.event.unbind(document,"mousedown",l,!0),at.event.unbind(document,"mouseup",l,!0),at.event.unbind(document,"keyup",u),at.event.unbind(document,"touchstart",p,!0),at.event.unbind(document,"touchcancel",m,!0),at.event.unbind(document,"touchmove",s,!0),at.event.unbind(document,"touchend",c,!0),e.off("element.hover",f),e.off("element.out",h),t.removeMarker(t.getRootElement(),xu);var y=i.payload.previousSelection;return!1!==r&&y&&!n.get().length&&n.select(y),o=i,i=null,o}e.on("diagram.destroy",m),this.init=function(t,n,y,v){i&&m(!1),"string"==typeof n&&(v=y,y=n,n=null);var g,_,x,b,w,E=(v=(0,l.assign)({},r,v||{})).data||{};b=v.trapClick?d:c,t?(g=(0,Zo.getOriginal)(t)||t,_=(0,Zo.toPoint)(t),(0,Zo.stopPropagation)(t),"dragstart"===g.type&&bu(g)):(g=null,_={x:0,y:0}),x=o(_),n||(n=x),w=function(e){return"undefined"!=typeof TouchEvent&&e instanceof TouchEvent}(g),i=(0,l.assign)({prefix:y,data:E,payload:{},globalStart:_,displacement:(0,Ka.delta)(n,x),localStart:x,isTouch:w},v),v.manual||(w?(at.event.bind(document,"touchstart",p,!0),at.event.bind(document,"touchcancel",m,!0),at.event.bind(document,"touchmove",s,!0),at.event.bind(document,"touchend",c,!0)):(at.event.bind(document,"mousemove",s),at.event.bind(document,"dragstart",bu),at.event.bind(document,"selectstart",bu),at.event.bind(document,"mousedown",b,!0),at.event.bind(document,"mouseup",b,!0)),at.event.bind(document,"keyup",u),e.on("element.hover",f),e.on("element.out",h)),a("init"),v.autoActivate&&s(t,!0)},this.move=s,this.hover=f,this.out=h,this.end=c,this.cancel=m,this.context=function(){return i},this.setOptions=function(e){(0,l.assign)(r,e)}}wu.$inject=["eventBus","canvas","selection"];var Eu={};function Mu(e,t,n){var i=this;e.on("drag.start",function(t){e.once("drag.move",function(){e.once("drag.move",function(e){i.ensureHover(e)})})}),this.ensureHover=function(e){if(!e.hover){var i,r,o,a=e.originalEvent;a instanceof MouseEvent&&(i=(0,Zo.toPoint)(a),(o=function(e){return(0,at.closest)(e,"svg, .djs-element",!0)}(document.elementFromPoint(i.x,i.y)))&&(r=n.get(o),t.hover({element:r,gfx:o})))}}}Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.default=Mu,Mu.$inject=["eventBus","dragging","elementRegistry"];var Su={};Object.defineProperty(Su,"__esModule",{value:!0});var Cu=ku(wa),Pu=ku(gu),Ru=ku(Eu);function ku(e){return e&&e.__esModule?e:{default:e}}Su.default={__init__:["hoverFix"],__depends__:[Cu.default],dragging:["type",Pu.default],hoverFix:["type",Ru.default]};var Tu={};function Au(e){this._commandStack=e.get("commandStack",!1)}Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.default=Au,Au.$inject=["injector"],Au.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),void 0===n||n};var Ou={};Object.defineProperty(Ou,"__esModule",{value:!0});var ju=function(e){return e&&e.__esModule?e:{default:e}}(Tu);Ou.default={__init__:["rules"],rules:["type",ju.default]};var Nu={};Object.defineProperty(Nu,"__esModule",{value:!0});var Iu=Fu(wa),Du=Fu(Ou),Bu=Fu(Su),Lu=Fu(uu),zu=Fu(pu);function Fu(e){return e&&e.__esModule?e:{default:e}}Nu.default={__depends__:[Iu.default,Du.default,Bu.default],__init__:["connectPreview"],connect:["type",Lu.default],connectPreview:["type",zu.default]};var $u={};Object.defineProperty($u,"__esModule",{value:!0}),$u.default=Hu;function Hu(e,t,n){this._providers=[],this._eventBus=t,this._overlays=n;var i=(0,l.isDefined)(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}Hu.$inject=["config.contextPad","eventBus","overlays"],Hu.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(e){var n=e.newSelection;1===n.length?t.open(n[0]):t.close()}),e.on("elements.delete",function(e){var n=e.elements;(0,l.forEach)(n,function(e){t.isOpen(e)&&t.close()})}),e.on("element.changed",function(e){var n=e.element,i=t._current;i&&i.element===n&&t.open(n,!0)})},Hu.prototype.registerProvider=function(e){this._providers.push(e)},Hu.prototype.getEntries=function(e){var t={};return(0,l.forEach)(this._providers,function(n){var i=n.getContextPadEntries(e);(0,l.forEach)(i,function(e,n){t[n]=e})}),t},Hu.prototype.trigger=function(e,t,n){var i,r,o=this._current.element,a=this._current.entries,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();if(i=a[(0,at.attr)(s,"data-action")].action,r=t.originalEvent||t,(0,l.isFunction)(i)){if("click"===e)return i(r,o,n)}else if(i[e])return i[e](r,o,n);t.preventDefault()},Hu.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))},Hu.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;(0,l.forEach)(t,function(e,t){var n,r,o,a,s=e.group||"default",c=(0,at.domify)(e.html||'<div class="entry" draggable="true"></div>');(0,at.attr)(c,"data-action",t),(n=(0,at.query)("[data-group="+s+"]",i))||(n=(0,at.domify)('<div class="group" data-group="'+s+'"></div>'),i.appendChild(n)),n.appendChild(c),e.className&&(r=c,o=e.className,a=(0,at.classes)(r),((0,l.isArray)(o)?o:o.split(/\s+/g)).forEach(function(e){a.add(e)})),e.title&&(0,at.attr)(c,"title",e.title),e.imageUrl&&c.appendChild((0,at.domify)('<img src="'+e.imageUrl+'">'))}),(0,at.classes)(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})},Hu.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=(0,at.domify)('<div class="djs-context-pad"></div>'),r=(0,l.assign)({html:i},this._overlaysConfig);at.delegate.bind(i,".entry","click",function(e){t.trigger("click",e)}),at.delegate.bind(i,".entry","dragstart",function(e){t.trigger("dragstart",e)}),at.event.bind(i,"mousedown",function(e){e.stopPropagation()}),this._overlayId=n.add(e,"context-pad",r);var o=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:o}),o},Hu.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},Hu.prototype.isOpen=function(e){return!(!this._current||e&&this._current.element!==e)};var Uu={};Object.defineProperty(Uu,"__esModule",{value:!0});var Vu=qu(sa),Wu=qu(Yo),Gu=qu($u);function qu(e){return e&&e.__esModule?e:{default:e}}Uu.default={__depends__:[Vu.default,Wu.default],contextPad:["type",Gu.default]};var Ku={};Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.default=el;var Yu=750,Xu="drop-ok",Zu="drop-not-ok",Qu="attach-ok",Ju="new-parent";function el(e,t,n,i,r,o,a){function s(e,t){[Qu,Xu,Zu,Ju].forEach(function(n){n===t?r.addMarker(e,n):r.removeMarker(e,n)})}e.on("create.move",function(e){var t,i=e.context,r=e.hover,o=i.shape,a=i.source;tl(e);var c={x:e.x,y:e.y};t=i.canExecute=r&&function(e,t,i,r){if(!t)return!1;var o,a,s={source:i,shape:e,target:t,position:r};return(a=n.allowed("shape.attach",s))||(o=n.allowed("shape.create",s)),o||a?{attach:a,connect:i&&n.allowed("connection.create",{source:i,target:e,hints:{targetParent:t,targetAttach:a}})}:(null===o||null===a)&&null}(o,r,a,c),r&&null!==t&&(i.target=r,t&&t.attach?s(r,Qu):s(r,t?Ju:Zu))}),e.on("create.move",Yu,function(e){var t=e.context,n=t.shape,i=t.visual;i||(i=t.visual=function(e){var t,n,i;t=(0,we.create)("g"),(0,we.attr)(t,o.cls("djs-drag-group",["no-events"])),(0,we.append)(r.getDefaultLayer(),t),n=(0,we.create)("g"),(0,we.classes)(n).add("djs-dragger"),(0,we.append)(t,n),(0,Ze.translate)(n,e.width/-2,e.height/-2);var s=(0,we.create)("g");return(0,we.classes)(s).add("djs-visual"),(0,we.append)(n,s),i=s,a.drawShape(i,e),t}(n)),(0,Ze.translate)(i,e.x,e.y)}),e.on(["create.end","create.out","create.cleanup"],function(e){var t=e.context.target;t&&s(t,null)}),e.on("create.end",function(e){var t=e.context,n=t.source,r=t.hints,o=t.shape,a=t.target,s=t.canExecute,c=s&&s.attach,u=s&&s.connect;if(!1===s||!a)return!1;tl(e);var d={x:e.x,y:e.y};o=u?i.appendShape(n,o,d,a,{attach:c,connection:!0===u?{}:u}):i.createShape(o,d,a,(0,l.assign)({},r,{attach:c})),t.shape=o}),e.on("create.cleanup",function(e){var t=e.context;t.visual&&(0,we.remove)(t.visual)}),this.start=function(e,n,i){var r;r=!i||i instanceof B.Shape?{hints:{},shape:n,source:i}:(0,l.assign)({hints:{},shape:n},i),t.init(e,"create",{cursor:"grabbing",autoActivate:!0,data:{shape:n,context:r}})}}function tl(e){var t=e.context.createConstraints;t&&(t.left&&(e.x=Math.max(e.x,t.left)),t.right&&(e.x=Math.min(e.x,t.right)),t.top&&(e.y=Math.max(e.y,t.top)),t.bottom&&(e.y=Math.min(e.y,t.bottom)))}el.$inject=["eventBus","dragging","rules","modeling","canvas","styles","graphicsFactory"];var nl={};Object.defineProperty(nl,"__esModule",{value:!0});var il=sl(Su),rl=sl(wa),ol=sl(Ou),al=sl(Ku);function sl(e){return e&&e.__esModule?e:{default:e}}nl.default={__depends__:[il.default,rl.default,ol.default],create:["type",al.default]};var cl={__depends__:[Nu.default,Uu.default,nl.default,wa.default,cu],__init__:["contextPadProvider"],contextPadProvider:["type",Tc]},ul={};Object.defineProperty(ul,"__esModule",{value:!0}),ul.default=ll;function ll(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}function dl(e,t){return new Error(e+" "+t)}ll.$inject=["eventBus","injector"],ll.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),r=e.get("zoomScroll",!1),o=e.get("copyPaste",!1),a=e.get("canvas",!1),s=e.get("rules",!1),c=e.get("mouseTracking",!1),u=e.get("keyboardMove",!1),d=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),o&&i&&this.register("copy",function(){var e=i.get();o.copy(e)}),c&&o&&this.register("paste",function(){var e=c.getHoverContext();o.paste(e)}),r&&this.register("stepZoom",function(e){r.stepZoom(e.value)}),a&&this.register("zoom",function(e){a.zoom(e.value)}),n&&i&&s&&this.register("removeSelection",function(){var e=i.get();if(e.length){var t,r=s.allowed("elements.delete",{elements:e});!1!==r&&(t=(0,l.isArray)(r)?r:e).length&&n.removeElements(t.slice())}}),u&&this.register("moveCanvas",function(e){u.moveCanvas(e)}),d&&this.register("moveSelection",function(e){d.moveSelection(e.direction,e.accelerated)})},ll.prototype.trigger=function(e,t){if(!this._actions[e])throw dl(e,"is not a registered action");return this._actions[e](t)},ll.prototype.register=function(e,t){var n=this;if("string"==typeof e)return this._registerAction(e,t);(0,l.forEach)(e,function(e,t){n._registerAction(t,e)})},ll.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw dl(e,"is already registered");this._actions[e]=t},ll.prototype.unregister=function(e){if(!this.isRegistered(e))throw dl(e,"is not a registered action");this._actions[e]=void 0},ll.prototype.getActions=function(){return Object.keys(this._actions)},ll.prototype.isRegistered=function(e){return!!this._actions[e]};var pl=ul.default;function fl(e){e.invoke(pl,this)}u(fl,pl),fl.$inject=["injector"];var hl=fl;fl.prototype._registerDefaultActions=function(e){pl.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),r=e.get("spaceTool",!1),o=e.get("lassoTool",!1),a=e.get("handTool",!1),s=e.get("globalConnect",!1),c=e.get("directEditing",!1),u=e.get("searchPad",!1);t&&n&&i&&this._registerAction("selectElements",function(){var e=t.getRootElement(),r=n.filter(function(t){return t!==e});return i.select(r),r}),r&&this._registerAction("spaceTool",function(){r.toggle()}),o&&this._registerAction("lassoTool",function(){o.toggle()}),a&&this._registerAction("handTool",function(){a.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&c&&this._registerAction("directEditing",function(){var e=i.get();e.length&&c.activate(e[0])}),u&&this._registerAction("find",function(){u.toggle()})};var ml={};Object.defineProperty(ml,"__esModule",{value:!0});var yl=function(e){return e&&e.__esModule?e:{default:e}}(ul);ml.default={__init__:["editorActions"],editorActions:["type",yl.default]};var vl={__depends__:[ml.default],editorActions:["type",hl]},gl={};Object.defineProperty(gl,"__esModule",{value:!0}),gl.hasModifier=function(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey},gl.isCmd=function(e){if(e.altKey)return!1;return e.ctrlKey||e.metaKey},gl.isKey=function(e,t){return(e=(0,l.isArray)(e)?e:[e]).indexOf(t.key)>-1},gl.isShift=function(e){return e.shiftKey};var _l={};Object.defineProperty(_l,"__esModule",{value:!0}),_l.default=bl;var xl=500;function bl(e,t){var n=this;e.on("editorActions.init",xl,function(e){var i=e.editorActions;n.registerBindings(t,i)})}bl.$inject=["eventBus","keyboard"],bl.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}n("undo",function(e){var n=e.keyEvent;if((0,gl.isCmd)(n)&&!(0,gl.isShift)(n)&&(0,gl.isKey)(["z","Z"],n))return t.trigger("undo"),!0}),n("redo",function(e){var n=e.keyEvent;if((0,gl.isCmd)(n)&&((0,gl.isKey)(["y","Y"],n)||(0,gl.isKey)(["z","Z"],n)&&(0,gl.isShift)(n)))return t.trigger("redo"),!0}),n("copy",function(e){var n=e.keyEvent;if((0,gl.isCmd)(n)&&(0,gl.isKey)(["c","C"],n))return t.trigger("copy"),!0}),n("paste",function(e){var n=e.keyEvent;if((0,gl.isCmd)(n)&&(0,gl.isKey)(["v","V"],n))return t.trigger("paste"),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,gl.isKey)(["+","Add"],n)&&(0,gl.isCmd)(n))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(e){var n=e.keyEvent;if((0,gl.isKey)(["-","Subtract"],n)&&(0,gl.isCmd)(n))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(e){var n=e.keyEvent;if((0,gl.isKey)("0",n)&&(0,gl.isCmd)(n))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(e){var n=e.keyEvent;if((0,gl.isKey)(["Delete","Del"],n))return t.trigger("removeSelection"),!0})};var wl=_l.default;function El(e){e.invoke(wl,this)}u(El,wl),El.$inject=["injector"];var Ml=El;El.prototype.registerBindings=function(e,t){function n(n,i){t.isRegistered(n)&&e.addListener(i)}wl.prototype.registerBindings.call(this,e,t),n("selectElements",function(n){var i=n.keyEvent;if(e.isKey(["a","A"],i)&&e.isCmd(i))return t.trigger("selectElements"),!0}),n("find",function(n){var i=n.keyEvent;if(e.isKey(["f","F"],i)&&e.isCmd(i))return t.trigger("find"),!0}),n("spaceTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["s","S"],i)?(t.trigger("spaceTool"),!0):void 0}),n("lassoTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["l","L"],i)?(t.trigger("lassoTool"),!0):void 0}),n("handTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["h","H"],i)?(t.trigger("handTool"),!0):void 0}),n("globalConnectTool",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["c","C"],i)?(t.trigger("globalConnectTool"),!0):void 0}),n("directEditing",function(n){var i=n.keyEvent;if(!e.hasModifier(i))return e.isKey(["e","E"],i)?(t.trigger("directEditing"),!0):void 0})};var Sl={};Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.default=Cl;function Cl(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}Cl.$inject=["config.keyboard","eventBus"],Cl.prototype._keydownHandler=function(e){this._keyHandler(e,"keyboard.keydown")},Cl.prototype._keyupHandler=function(e){this._keyHandler(e,"keyboard.keyup")},Cl.prototype._keyHandler=function(e,t){if(!function(e){return e&&((0,at.matches)(e,"input, textarea")||"true"===e.contentEditable)}(e.target)){var n={keyEvent:e};this._eventBus.fire(t||"keyboard.keydown",n)&&e.preventDefault()}},Cl.prototype.bind=function(e){this.unbind(),this._node=e,at.event.bind(e,"keydown",this._keydownHandler,!0),at.event.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")},Cl.prototype.getBinding=function(){return this._node},Cl.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),at.event.unbind(e,"keydown",this._keydownHandler,!0),at.event.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null},Cl.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})},Cl.prototype.addListener=function(e,t,n){(0,l.isFunction)(e)&&(n=t,t=e,e=1e3),this._eventBus.on(n||"keyboard.keydown",e,t)},Cl.prototype.removeListener=function(e,t){this._eventBus.off(t||"keyboard.keydown",e)},Cl.prototype.hasModifier=gl.hasModifier,Cl.prototype.isCmd=gl.isCmd,Cl.prototype.isShift=gl.isShift,Cl.prototype.isKey=gl.isKey;var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});var Rl=Tl(Sl),kl=Tl(_l);function Tl(e){return e&&e.__esModule?e:{default:e}}Pl.default={__init__:["keyboard","keyboardBindings"],keyboard:["type",Rl.default],keyboardBindings:["type",kl.default]};var Al={__depends__:[Pl.default],__init__:["keyboardBindings"],keyboardBindings:["type",Ml]},Ol={},jl=e.is,Nl=Q.isAny,Il=e.getBusinessObject;function Dl(e){return jl(e,"cmmn:TextAnnotation")?"text":"name"}function Bl(e){var t=Il(e);return jl(t,"cmmndi:CMMNEdge")&&t.cmmnElementRef&&(t=t.cmmnElementRef),t}var Ll=function(e){return Nl(e,["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:CaseFileItem"])};Ol.getLabel=function(e){var t=Bl(e),n=Dl(t);if(function(e){return!Nl(e,["cmmn:Association","cmmn:Criterion","cmmndi:CMMNEdge"])}(t))return!t[n]&&Ll(e)&&(t=t.definitionRef),t[n]||""};Ol.setLabel=function(e,t,n,i){var r=Bl(e),o=Dl(r);return!r[o]&&Ll(e)&&i&&(r=r.definitionRef),r[o]=t,n&&(e.hidden=!t),e};var zl=e.getDefinition;function Fl(e){function t(t,n){var i=t.label||t,r=t.labelTarget||t;return Ol.setLabel(i,n,r!==i,function(t){var n=zl(t);return!n||1===e.getReferences(n).length}(t)),[i,r]}this.execute=function(e){return e.oldLabel=Ol.getLabel(e.element),t(e.element,e.newLabel)},this.revert=function(e){return t(e.element,e.oldLabel)}}Fl.$inject=["itemRegistry"];var $l=Fl,Hl=e.isCasePlanModel,Ul=e.is,Vl=e.getDefinition,Wl=l.assign;function Gl(e,t,n,i){this._canvas=t,this._commandStack=i,n.registerProvider(this),i.registerHandler("element.updateLabel",$l),e.on("element.dblclick",function(e){n.activate(e.element)}),e.on(["element.mousedown","drag.init","canvas.viewbox.changed"],function(e){n.complete()}),e.on(["commandStack.changed"],function(){n.cancel()}),e.on("create.end",500,function(e){var t=e.shape,i=e.context.canExecute;e.isTouch||i&&n.activate(t)})}Gl.$inject=["eventBus","canvas","directEditing","commandStack"];var ql=Gl;Gl.prototype.activate=function(e){var t=Ol.getLabel(e);if(void 0!==t&&e.parent){var n=e.label||e,i=this.getEditingBBox(e),r=Vl(e),o={};return(Ul(r,"cmmn:Task")||Ul(r,"cmmn:Milestone"))&&(o.centerVertically=!0),Ul(e,"cmmn:TextAnnotation")&&(o.autoResize=!0,o.resizable=!0),n.labelTarget&&(o.autoResize=!0),Wl({text:t,options:o},i)}},Gl.prototype.getEditingBBox=function(e,t){var n=this._canvas,i=Vl(e),r=e.label||e,o=this._canvas.getAbsoluteBBox(r),a=o.x+o.width/2,s=(o.y,o.height,{x:o.x,y:o.y}),c={},u=n.zoom();return Hl(e)&&(s.height=50,s.width=200,s.y-=30,c.textAlign="left"),Ul(i,"cmmn:PlanFragment")&&!Hl(e)&&(s.width=e.width,s.maxHeight=48,s.y+=5,c.textAlign="left"),(Ul(i,"cmmn:Task")||Ul(i,"cmmn:Milestone"))&&(u>1?(s.width=o.width,s.height=o.height):(s.width=o.width/u,s.height=o.height/u),u<1&&(s.x=o.x-(s.width/2-o.width/2),s.y=o.y-(s.height/2-o.height/2))),Ul(e,"cmmn:TextAnnotation")&&(s.width=o.width,s.height=o.height,s.minWidth=30*u,s.minHeight=10*u,c.textAlign="left"),r.labelTarget&&(s.width=150,s.minHeight=20,s.x=a-s.width/2),{bounds:s,style:c}},Gl.prototype.update=function(e,t){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t})};var Kl={};Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.default=Jl;var Yl=Math.min,Xl=Math.max;function Zl(e){e.preventDefault()}function Ql(e){e.stopPropagation()}function Jl(e){this.container=e.container,this.parent=(0,at.domify)('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=(0,at.query)("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=(0,l.bind)(this.autoResize,this),this.handlePaste=(0,l.bind)(this.handlePaste,this)}Jl.prototype.create=function(e,t,n,i){var r=this.parent,o=this.content,a=this.container;i=this.options=i||{},t=this.style=t||{};var s=(0,l.pick)(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);(0,l.assign)(r.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},s);var c=(0,l.pick)(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return(0,l.assign)(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&(0,l.assign)(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,at.event.bind(o,"keydown",this.keyHandler),at.event.bind(o,"mousedown",Ql),at.event.bind(o,"paste",this.handlePaste),i.autoResize&&at.event.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),a.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r},Jl.prototype.handlePaste=function(e){var t,n=this.options,i=this.style;if(e.preventDefault(),t=e.clipboardData?e.clipboardData.getData("text/plain"):window.clipboardData.getData("Text"),this.insertText(t),n.autoResize){var r=this.autoResize(i);r&&this.resizeHandler(r)}},Jl.prototype.insertText=function(e){document.execCommand("insertText",!1,e)||this._insertTextIE(e)},Jl.prototype._insertTextIE=function(e){var t,n,i,r=this.getSelection(),o=r.startContainer,a=r.endContainer,s=r.startOffset,c=r.endOffset,u=r.commonAncestorContainer,l=(t=u.childNodes,[].slice.call(t));if(u.nodeType===Node.TEXT_NODE){var d=o.textContent;o.textContent=d.substring(0,s)+e+d.substring(c),n=o,i=s+e.length}else if(o===this.content&&a===this.content){var p=document.createTextNode(e);this.content.insertBefore(p,l[s]),n=p,i=p.textContent.length}else{var f=l.indexOf(o),h=l.indexOf(a);l.forEach(function(t,n){n===f?t.textContent=o.textContent.substring(0,s)+e+a.textContent.substring(c):n>f&&n<=h&&(0,at.remove)(t)}),n=o,i=s+e.length}n&&void 0!==i&&setTimeout(function(){self.setSelection(n,i)})},Jl.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),r=t.scrollHeight;e.style.height=r+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:r-i.height})}},Jl.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,r=parseInt(this.style.minHeight)||0,o=parseInt(this.style.maxWidth)||1/0,a=parseInt(this.style.maxHeight)||1/0;if(!n){var s,c,u,d;n=this.resizeHandle=(0,at.domify)('<div class="djs-direct-editing-resize-handle"></div>');var p=function(n){Zl(n),Ql(n);var l=Yl(Xl(u+n.clientX-s,i),o),p=Yl(Xl(d+n.clientY-c,r),a);t.style.width=l+"px",t.style.height=p+"px",e.resizeHandler({width:u,height:d,dx:n.clientX-s,dy:n.clientY-c})},f=function e(t){Zl(t),Ql(t),at.event.unbind(document,"mousemove",p,!1),at.event.unbind(document,"mouseup",e,!1)};at.event.bind(n,"mousedown",function(e){Zl(e),Ql(e),s=e.clientX,c=e.clientY;var n=t.getBoundingClientRect();u=n.width,d=n.height,at.event.bind(document,"mousemove",p),at.event.bind(document,"mouseup",f)})}(0,l.assign)(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)},Jl.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),at.event.unbind(t,"keydown",this.keyHandler),at.event.unbind(t,"mousedown",Ql),at.event.unbind(t,"input",this.autoResize),at.event.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),(0,at.remove)(n)),(0,at.remove)(e)},Jl.prototype.getValue=function(){return this.content.innerText.trim()},Jl.prototype.getSelection=function(){return window.getSelection().getRangeAt(0)},Jl.prototype.setSelection=function(e,t){var n=document.createRange();null===e?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};var ed={};Object.defineProperty(ed,"__esModule",{value:!0}),ed.default=nd;var td=function(e){return e&&e.__esModule?e:{default:e}}(Kl);function nd(e,t){this._eventBus=e,this._providers=[],this._textbox=new td.default({container:t.getContainer(),keyHandler:(0,l.bind)(this._handleKey,this),resizeHandler:(0,l.bind)(this._handleResize,this)})}nd.$inject=["eventBus","canvas"],nd.prototype.registerProvider=function(e){this._providers.push(e)},nd.prototype.isActive=function(){return!!this._active},nd.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())},nd.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})},nd.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0},nd.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),r=this.getValue();r===e.context.text&&i.height===n.height&&i.width===n.width||(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,r,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}},nd.prototype.getValue=function(){return this._textbox.getValue()},nd.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;return 27===t?(e.preventDefault(),this.cancel()):13!==t||e.shiftKey?void 0:(e.preventDefault(),this.complete())},nd.prototype._handleResize=function(e){this._fire("resize",e)},nd.prototype.activate=function(e){var t;this.isActive()&&this.cancel();var n=(0,l.find)(this._providers,function(n){return(t=n.activate(e))?n:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};var id={};Object.defineProperty(id,"__esModule",{value:!0});var rd=ad(sa),od=ad(ed);function ad(e){return e&&e.__esModule?e:{default:e}}id.default={__depends__:[rd.default],__init__:["directEditing"],directEditing:["type",od.default]};var sd={};function cd(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}Object.defineProperty(sd,"__esModule",{value:!0}),sd.default=cd,cd.$inject=["eventBus","injector"],cd.prototype.execute=function(e,t){if(!e)throw new Error("command required");var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)},cd.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),r=this._fire(e,"canExecute",n);if(void 0===r){if(!i)return!1;i.canExecute&&(r=i.canExecute(t))}return r},cd.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,!1!==e&&this._fire("changed")},cd.prototype.undo=function(){var e,t=this._getUndoAction();if(t){for(this._pushAction(t);t&&(this._internalUndo(t),(e=this._getUndoAction())&&e.id===t.id);)t=e;this._popAction()}},cd.prototype.redo=function(){var e,t=this._getRedoAction();if(t){for(this._pushAction(t);t&&(this._internalExecute(t,!0),(e=this._getRedoAction())&&e.id===t.id);)t=e;this._popAction()}},cd.prototype.register=function(e,t){this._setHandler(e,t)},cd.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)},cd.prototype.canUndo=function(){return!!this._getUndoAction()},cd.prototype.canRedo=function(){return!!this._getRedoAction()},cd.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},cd.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},cd.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,r=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),r.revert&&t._markDirty(r.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})},cd.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i,r,o,a=t?[e+"."+t,t]:[e];for(n=this._eventBus.createEvent(n),i=0;(r=a[i])&&(o=this._eventBus.fire("commandStack."+r,n),!n.cancelBubble);i++);return o},cd.prototype._createId=function(){return this._uid++},cd.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}},cd.prototype._internalExecute=function(e,t){var n=this,i=e.command,r=e.context,o=this._getHandler(i);if(!o)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),o.preExecute&&o.preExecute(r),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),o.execute&&n._markDirty(o.execute(r)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),o.postExecute&&o.postExecute(r),this._fire(i,"postExecuted",e)),this._popAction(e)},cd.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)},cd.prototype._popAction=function(){var e=this._currentExecution,t=e.actions,n=e.dirty;t.pop(),t.length||(this._eventBus.fire("elements.changed",{elements:(0,l.uniqueBy)("id",n)}),n.length=0,this._fire("changed"))},cd.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=(0,l.isArray)(e)?e:[e],t.dirty=t.dirty.concat(e))},cd.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)},cd.prototype._revertedAction=function(e){this._stackIdx--},cd.prototype._getHandler=function(e){return this._handlerMap[e]},cd.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};var ud={};Object.defineProperty(ud,"__esModule",{value:!0});var ld=function(e){return e&&e.__esModule?e:{default:e}}(sd);ud.default={commandStack:["type",ld.default]};var dd={};function pd(e,t,n,i){e.on("element.changed",function(i){var r=i.element;(r.parent||r===t.getRootElement())&&(i.gfx=n.getGraphics(r)),i.gfx&&e.fire((0,kr.getType)(r)+".changed",i)}),e.on("elements.changed",function(t){var n=t.elements;n.forEach(function(t){e.fire("element.changed",{element:t})}),i.updateContainments(n)}),e.on("shape.changed",function(e){i.update("shape",e.element,e.gfx)}),e.on("connection.changed",function(e){i.update("connection",e.element,e.gfx)})}Object.defineProperty(dd,"__esModule",{value:!0}),dd.default=pd,pd.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var fd={};Object.defineProperty(fd,"__esModule",{value:!0});var hd=function(e){return e&&e.__esModule?e:{default:e}}(dd);fd.default={__init__:["changeSupport"],changeSupport:["type",hd.default]};var md={__depends__:[ud.default,fd.default,id.default],__init__:["labelEditingProvider"],labelEditingProvider:["type",ql]},yd=l.map,vd=l.assign,gd=l.pick,_d=Q.isAny;function xd(e){this._model=e}xd.$inject=["moddle"],xd.prototype._needsId=function(e){return _d(e,["cmmn:CMMNElement","cmmndi:CMMNShape","cmmndi:CMMNEdge","cmmndi:CMMNStyle","cmmndi:CMMNDiagram"])},xd.prototype._ensureId=function(e){var t=(e.$type||"").replace(/^[^:]*:/g,"")+"_";!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},xd.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},xd.prototype.createDiLabel=function(){return this.create("cmmndi:CMMNLabel")},xd.prototype.createDiShape=function(e,t,n){return this.create("cmmndi:CMMNShape",vd({cmmnElementRef:e,bounds:this.createDiBounds(t),label:this.createDiLabel()},n))},xd.prototype.createDiEdge=function(e,t,n){return this.create("cmmndi:CMMNEdge",vd({cmmnElementRef:e,label:this.createDiLabel()},n))},xd.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},xd.prototype.createDiWaypoints=function(e){var t=this;return yd(e,function(e){return t.createDiWaypoint(e)})},xd.prototype.createDiWaypoint=function(e){return this.create("dc:Point",gd(e,["x","y"]))},xd.prototype.createItem=function(e,t){var n=this.create(t);return this.create(e,{definitionRef:n})},xd.prototype.createCriterion=function(e,t){return(t=t||{}).sentryRef||(t=vd({sentryRef:this.createSentry()},t)),this.create(e,t)},xd.prototype.createSentry=function(e){return this.create("cmmn:Sentry",e)},xd.prototype.createCasePlanModel=function(){var e=this.create("cmmn:Stage");this._model.ids.unclaim(e.id),e.id=this._model.ids.nextPrefixed("CasePlanModel_",e);var t=this.create("cmmn:Case",{casePlanModel:e});return e.$parent=t,e},xd.prototype.createCaseFileModel=function(e){var t=this.create("cmmn:CaseFile");return this._model.ids.unclaim(t.id),t.id=this._model.ids.nextPrefixed("CaseFileModel_",t),t.$parent=e,t},xd.prototype.createCaseFileItem=function(e){return(e=e||{}).definitionRef||(e=vd({definitionRef:this.create("cmmn:CaseFileItemDefinition")},e)),this.create("cmmn:CaseFileItem",e)};var bd=xd,wd={};function Ed(){}Object.defineProperty(wd,"__esModule",{value:!0}),wd.default=Ed,Ed.prototype.layoutConnection=function(e,t){return[(t=t||{}).connectionStart||(0,dc.getMid)(t.source||e.source),t.connectionEnd||(0,dc.getMid)(t.target||e.target)]};var Md={};Object.defineProperty(Md,"__esModule",{value:!0}),Md.repairConnection=function(e,t,n,i,r,o){(0,l.isArray)(n)&&(r=n,o=i,n=(0,dc.getMid)(e),i=(0,dc.getMid)(t));o=(0,l.assign)({preferredLayouts:[]},o),r=r||[];var a,s=-1!==o.preferredLayouts.indexOf("straight");if(a=s&&Dd(e,t,n,i,o))return a;if(a=o.connectionEnd&&function(e,t,n,i){var r=i.slice().reverse();return(r=Bd(e,t,n,r))?r.reverse():null}(t,e,i,r))return a;if(a=o.connectionStart&&(c=e,u=t,d=n,p=r,Bd(c,u,d,p)))return a;var c,u,d,p;if(!o.connectionStart&&!o.connectionEnd&&r&&r.length)return r;return Nd(e,t,n,i,o)};var Sd=20,Cd=5,Pd=Math.round,Rd=20,kd={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function Td(e,t,n){var i,r,o,a=(0,dc.getOrientation)(t,e,Cd),s=n.split(":")[0],c=Pd((t.x-e.x)/2+e.x),u=Pd((t.y-e.y)/2+e.y),l=(o=a,{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[s].test(o)),d=/h|r|l/.test(s),p=!1;return l?(i=d?{x:c,y:e.y}:{x:e.x,y:u},r=d?"h:h":"v:v"):(r=d?"h:v":"v:h",function(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}(a,s)?d?(p=u===e.y,i={x:e.x+Sd*(/l/.test(s)?-1:1),y:p?u+Sd:u}):i={x:(p=c===e.x)?c+Sd:c,y:e.y+Sd*(/t/.test(s)?-1:1)}:i={x:c,y:u}),{waypoints:Od(e,i,r).concat(i),directions:r,turnNextDirections:p}}function Ad(e){return e.split(":").reverse().join(":")}function Od(e,t,n){if(!function(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}(n=n||"h:h"))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(Ld(n)){var i=function(e,t,n){return Td(e,t,n)}(e,t,n),r=function(e,t,n){var i=Td(t,e,Ad(n));return{waypoints:i.waypoints.slice().reverse(),directions:Ad(i.directions),turnNextDirections:i.turnNextDirections}}(e,t,n),o=function(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n="h"==n?"v":"h"),t.turnNextDirections&&(i="h"==i?"v":"h");var r=n+":"+i;return{waypoints:Od(e.waypoints[e.waypoints.length-1],t.waypoints[0],r),directions:r}}(i,r);return[].concat(i.waypoints,o.waypoints,r.waypoints)}return function(e,t,n){var i=Pd((t.x-e.x)/2+e.x),r=Pd((t.y-e.y)/2+e.y);if("h:v"===n)return[{x:t.x,y:e.y}];if("v:h"===n)return[{x:e.x,y:t.y}];if("h:h"===n)return[{x:i,y:e.y},{x:i,y:t.y}];if("v:v"===n)return[{x:e.x,y:r},{x:t.x,y:r}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}(e,t,n)}function jd(e,t,n){var i=Od(e,t,n);return i.unshift(e),i.push(t),Fd(i)}function Nd(e,t,n,i,r){var o=r&&r.preferredLayouts||[],a=(0,l.without)(o,"straight")[0]||"h:h",s=kd[a]||0,c=(0,dc.getOrientation)(e,t,s),u=function(e,t){if(Ld(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}(c,a);n=n||(0,dc.getMid)(e),i=i||(0,dc.getMid)(t);var d=u.split(":");return jd(zd(n,e,d[0],function(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}(c)),zd(i,t,d[1],c),u)}function Id(e,t,n){return function(e,t,n){return e>=t&&e<=n}(t[e],n[e],n[e]+n[{x:"width",y:"height"}[e]])}function Dd(e,t,n,i,r){var o,a,s={};return a=(0,dc.getOrientation)(e,t),/^(top|bottom|left|right)$/.test(a)?(/top|bottom/.test(a)&&(o="x"),/left|right/.test(a)&&(o="y"),"target"===r.preserveDocking?Id(o,i,e)?(s[o]=i[o],[{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y,original:{x:void 0!==s.x?s.x:n.x,y:void 0!==s.y?s.y:n.y}},{x:i.x,y:i.y}]):null:Id(o,n,t)?(s[o]=n[o],[{x:n.x,y:n.y},{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y,original:{x:void 0!==s.x?s.x:i.x,y:void 0!==s.y?s.y:i.y}}]):null):null}function Bd(e,t,n,i){if(function(e,t,n){return n.length<3||!(n.length>4)&&!!(0,l.find)(n,function(e,t){var i=n[t-1];return i&&(0,ks.pointDistance)(e,i)<3})}(0,0,i))return null;var r,o=i[0],a=i.slice();return a[0]=n,a[1]=function(e,t,n){switch((0,ks.pointsAligned)(t,e)){case"v":return{x:n.x,y:e.y};case"h":return{x:e.x,y:n.y}}return{x:e.x,y:e.y}}(a[1],o,n),(r=function(e,t,n){var i;for(i=e.length-2;0!==i;i--)if((0,ks.pointInRect)(e[i],t,Rd)||(0,ks.pointInRect)(e[i],n,Rd))return e.slice(i);return e}(a,e,t))!==a?Bd(e,t,n,r):a}function Ld(e){return e&&/t|r|b|l/.test(e)}function zd(e,t,n,i){if("h"===n&&(n=/left/.test(i)?"l":"r"),"v"===n&&(n=/top/.test(i)?"t":"b"),"t"===n)return{original:e,x:e.x,y:t.y};if("r"===n)return{original:e,x:t.x+t.width,y:e.y};if("b"===n)return{original:e,x:e.x,y:t.y+t.height};if("l"===n)return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function Fd(e){return e.reduce(function(t,n,i){var r=t[t.length-1],o=e[i+1];return(0,ks.pointsOnLine)(r,o,n,0)||t.push(n),t},[])}var $d=wd.default,Hd=dc.getMid;function Ud(){}u(Ud,$d);var Vd=Ud;function Wd(e,t){return e?e.original||e:Hd(t)}Ud.prototype.layoutConnection=function(e,t){var n=(t=t||{}).source||e.source,i=t.target||e.target,r=e.waypoints,o=t.connectionStart,a=t.connectionEnd;return o||(o=Wd(r&&r[0],n)),a||(a=Wd(r&&r[r.length-1],i)),Md.repairConnection(n,i,o,a,r,t)||[o,a]};var Gd=l.assign,qd=ds.default,Kd=e.getBusinessObject,Yd=e.is,Xd=e.isCasePlanModel,Zd=Q.getParent,Qd=Q.isLabel,Jd=Q.isAny;function ep(e,t,n,i){qd.call(this,e),this._cmmnFactory=t,this._itemRegistry=n;var r=this;function o(e){var t=e.context.shape;r.updateBounds(t)}function a(e){r.updateConnection(e.context)}function s(e){r.updateConnectionWaypoints(e.context.connection)}function c(e){r.updateAttachment(e.context)}function u(e){var t=e.context.shape,i=Kd(t);n.add(i)}function l(e){var t=e.context.shape;if(!Qd(t)){var i=Kd(t);n.remove(i)}}this.executed(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){var t,n=e.context;n.cropped||((t=n.connection).waypoints=i.getCroppedWaypoints(t),n.cropped=!0)}),this.reverted(["connection.layout","connection.create","connection.reconnectEnd","connection.reconnectStart"],function(e){delete e.context.cropped}),this.executed(["shape.create","shape.move","shape.delete","connection.delete","connection.create"],np(function(e){var t=e.context;r.updateParent(t.shape||t.connection,t.oldParent)})),this.reverted(["shape.create","shape.move","shape.delete","connection.delete","connection.create"],np(function(e){var t=e.context,n=t.shape||t.connection,i=t.parent||t.newParent;r.updateParent(n,i)})),this.executed(["shape.create","shape.move","shape.resize"],np(function(e){"label"!==e.context.shape.type&&o(e)})),this.reverted(["shape.create","shape.move","shape.resize"],np(function(e){"label"!==e.context.shape.type&&o(e)})),e.on("shape.changed",function(e){"label"===e.element.type&&o({context:{shape:e.element}})}),this.executed(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],np(a)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnectEnd","connection.reconnectStart"],np(a)),this.executed(["connection.create","connection.layout","connection.move","connection.reconnectStart","connection.reconnectEnd","connection.updateWaypoints"],np(s)),this.reverted(["connection.create","connection.layout","connection.move","connection.reconnectStart","connection.reconnectEnd","connection.updateWaypoints"],np(s)),this.executed(["element.updateAttachment"],np(c)),this.reverted(["element.updateAttachment"],np(c)),this.executed("shape.create",np(u)),this.reverted("shape.create",np(l)),this.executed("shape.delete",np(l)),this.reverted("shape.delete",np(u))}u(ep,qd);var tp=ep;function np(e){return function(t){var n=t.context,i=n.shape||n.connection;(Yd(i,"cmmn:CMMNElement")||Yd(i,"cmmndi:CMMNDiagramElement"))&&e(t)}}function ip(e){return Zd(e,"cmmn:Definitions")}ep.$inject=["eventBus","cmmnFactory","itemRegistry","connectionDocking"],ep.prototype.updateAttachment=function(e){var t=e.shape,n=Kd(t),i=t.host,r=i&&Kd(i);this.updateSemanticParent(n,r)},ep.prototype.updateParent=function(e,t){if(!Qd(e)){var n,i=Kd(e),r=Kd(e.parent),o=i.di||i,a=r&&r.di;(n=(n=i).businessObject||n).cmmnElementRef&&Yd(n.cmmnElementRef,"cmmn:Association")&&(i=i.cmmnElementRef),function(e){return!Jd(e,["cmmn:CaseFileItem","cmmn:Criterion","cmmn:DiscretionaryItem","cmmn:OnPart","cmmndi:CMMNEdge"])}(i)&&this.updateSemanticParent(i,r),Yd(r,"cmmndi:CMMNDiagram")&&(a=r),this.updateDiParent(o,a)}},ep.prototype.updateSemanticParent=function(e,t){var n;if(e.$parent!==t){if(Yd(e,"cmmn:PlanItem")?(n="planItems",t&&!Xd(t)&&(t=t.definitionRef)):Xd(e)?(n="cases",e=e.$parent,t=t&&ip(t)):Yd(e,"cmmn:EntryCriterion")?(Xd(t)&&(t=null),n="entryCriteria"):Yd(e,"cmmn:ExitCriterion")?n="exitCriteria":Yd(e,"cmmn:Artifact")&&(t=t&&ip(t),n="artifacts"),!n)throw new Error("no parent for ",e,t);var i;e.$parent&&(i=e.$parent.get(n),Sn.remove(i,e)),t?((i=t.get(n)).push(e),e.$parent=t):e.$parent=null}},ep.prototype.updateDiParent=function(e,t){if(t&&!Yd(t,"cmmndi:CMMNDiagram")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("diagramElements");t?(n.push(e),e.$parent=t):(Sn.remove(n,e),e.$parent=null)}},ep.prototype.updateBounds=function(e){var t=e.businessObject.di||e.businessObject,n=Qd(e)?this._getLabel(t).bounds:t.bounds;Gd(n,{x:e.x,y:e.y,width:e.width,height:e.height})},ep.prototype.updateConnectionWaypoints=function(e){e.businessObject.set("waypoint",this._cmmnFactory.createDiWaypoints(e.waypoints))},ep.prototype.updateConnection=function(e){var t,n,i,r,o,a=e.connection,s=Kd(a),c=Kd(a.source),u=Kd(a.target),l=s.cmmnElementRef;Yd(l,"cmmn:Association")?(t=l,n=l,i="sourceRef",r="targetRef"):(n=s,r="targetCMMNElementRef",Yd(l,"cmmn:OnPart")?(t=l,i="sourceRef",Yd(c,"cmmn:ExitCriterion")&&(c=Zd(o=c)),l.exitCriterionRef!==o&&(l.exitCriterionRef=o)):(t=s,i="sourceCMMNElementRef"));i&&t[i]!==c&&(t[i]=c),r&&n[r]!==u&&(n[r]=u),this.updateConnectionWaypoints(a)},ep.prototype._getLabel=function(e){return e.label||(e.label=this._cmmnFactory.createDiLabel()),e.label.bounds||(e.label.bounds=this._cmmnFactory.createDiBounds()),e.label};var rp=l.assign,op=Ur.default,ap=e.is,sp=e.getDefinition,cp=e.isCasePlanModel,up=me.isCollapsed;function lp(e,t){op.call(this),this._cmmnFactory=e,this._moddle=t}u(lp,op),lp.$inject=["cmmnFactory","moddle"];var dp=lp;lp.prototype.baseCreate=op.prototype.create,lp.prototype.create=function(e,t){return"label"===e?this.baseCreate(e,rp({type:"label"},cn.DEFAULT_LABEL_SIZE,t)):"root"===e?this.baseCreate(e,t):this.createCmmnElement(e,t)},lp.prototype.createCmmnElement=function(e,t){var n,i=(t=rp({},t||{})).businessObject;if(!i){if(!t.type)throw new Error("no shape type specified");var r={};t.name&&rp(r,{name:t.name}),i=this._cmmnFactory.create(t.type,r)}if("connection"===e&&(ap(i,"cmmndi:CMMNEdge")||(i=this._cmmnFactory.createDiEdge(i,[],{id:i.id+"_di"})),i.label||(i.label=this._cmmnFactory.createDiLabel()),t.type="cmmndi:CMMNEdge"),t.definitionType){var o=this._cmmnFactory.create(t.definitionType);i.definitionRef=o}return t.sentryRef&&(i.sentryRef=t.sentryRef),"shape"!==e||i.di||(i.di=this._cmmnFactory.createDiShape(i,{},{id:i.id+"_di"})),t.isCollapsed&&(i.di.isCollapsed=t.isCollapsed),t.isPlanningTableCollapsed&&(i.di.isPlanningTableCollapsed=t.isPlanningTableCollapsed),t.isStandardEventVisible&&(i.isStandardEventVisible=t.isStandardEventVisible),void 0!==t.isBlocking&&(i.definitionRef.isBlocking=t.isBlocking),t.autoComplete&&(i.definitionRef.autoComplete=!0),n=this._getDefaultSize(i),t=rp({businessObject:i,id:i.id},n,t),this.baseCreate(e,t)},lp.prototype._getDefaultSize=function(e){var t=sp(e);return cp(e)?{width:400,height:250}:ap(t,"cmmn:PlanFragment")?up(e)?{width:100,height:80}:{width:350,height:200}:ap(t,"cmmn:Milestone")?{width:100,height:40}:ap(t,"cmmn:EventListener")?{width:36,height:36}:ap(e,"cmmn:Criterion")?{width:20,height:28}:ap(e,"cmmn:TextAnnotation")?{width:100,height:30}:ap(e,"cmmn:CaseFileItem")?{width:36,height:50}:{width:100,height:80}},lp.prototype.createPlanItemShape=function(e){return this.createShape({type:"cmmn:PlanItem",businessObject:this._cmmnFactory.createItem("cmmn:PlanItem",e)})},lp.prototype.createDiscretionaryItemShape=function(e){return this.createShape({type:"cmmn:DiscretionaryItem",businessObject:this._cmmnFactory.createItem("cmmn:DiscretionaryItem",e)})},lp.prototype.createCasePlanModelShape=function(){return this.createShape({type:"cmmn:Stage",businessObject:this._cmmnFactory.createCasePlanModel()})},lp.prototype.createCriterionShape=function(e){return this.createShape({type:e,businessObject:this._cmmnFactory.createCriterion(e)})},lp.prototype.createCaseFileItemShape=function(){return this.createShape({type:"cmmn:CaseFileItem",businessObject:this._cmmnFactory.createCaseFileItem()})};var pp={};function fp(e){this._modeling=e}Object.defineProperty(pp,"__esModule",{value:!0}),pp.default=fp,fp.$inject=["modeling"],fp.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape;i=e.shape=this._modeling.createShape(i,e.position,n,{attach:e.attach}),e.shape=i},fp.prototype.postExecute=function(e){var t,n,i=e.connectionParent||e.shape.parent;t=e.source,n=e.shape,(0,l.some)(t.outgoing,function(e){return e.target===n})||this._modeling.connect(e.source,e.shape,e.connection,i)};var hp=e.is;function mp(e,t){this._modeling=e,this._cmmnRules=t}u(mp,pp.default),mp.$inject=["modeling","cmmnRules"];var yp=mp;function vp(e){this._moddle=e}mp.prototype.preExecute=function(e){if(!e.source)throw new Error("source required");var t=this._cmmnRules,n=e.shape,i=e.source,r=e.target||e.source.parent,o=e.position,a=e.attach;hp(n,"cmmn:Criterion")&&(a="attach"===t.canAttach(n,r,i,o)),e.shape=this._modeling.createShape(n,o,r,{attach:a,nested:!0})},vp.$inject=["moddle"];var gp=vp;vp.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.claim(n,i):t.unclaim(n)},vp.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element;e.claiming?t.unclaim(n):t.claim(n,i)};var _p={};function xp(e){this._modeling=e}Object.defineProperty(_p,"__esModule",{value:!0}),_p.default=xp,xp.$inject=["modeling"],xp.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget are required");if(t&&n)throw new Error("must specify either newSource or newTarget");return(0,l.isArray)(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i},xp.prototype.postExecute=function(e){var t,n,i=e.connection,r=e.dockingOrPoints,o=e.newSource,a=o?"connectionStart":"connectionEnd",s={};!1!==e.hints.layoutConnection&&(t=(0,l.isArray)(r)?o?r[0]:r[r.length-1]:r,s[a]=(n=t).original||n,this._modeling.layoutConnection(i,s))},xp.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,r=e.connection;return t&&(r.source=t),n&&(r.target=n),i&&(r.waypoints=i),r};var bp=l.isArray,wp=_p.default;function Ep(e){e.invoke(wp,this)}u(Ep,wp),Ep.$inject=["injector"];var Mp=Ep;Ep.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,r=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget are required");return bp(r)&&(e.oldWaypoints=i.waypoints,i.waypoints=r),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};var Sp={};function Cp(e,t){this._modeling=e,this._rules=t}function Pp(e,t){this._modeling=e,this._rules=t}Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.default=Cp,Cp.$inject=["modeling","rules"],Cp.prototype.preExecute=function(e){var t,n=this,i=this._modeling,r=this._rules,o=e.oldShape,a=e.newData,s=e.hints;function c(e,t,n,i){return r.allowed(e,{source:t,target:n,connection:i})}var u,d={x:a.x,y:a.y};t=e.newShape=e.newShape||n.createShape(a,d,o.parent,s),o.host&&i.updateAttachment(t,o.host),!1!==s.moveChildren&&(u=o.children.slice(),i.moveElements(u,{x:0,y:0},t));var p=o.incoming.slice(),f=o.outgoing.slice();(0,l.forEach)(p,function(e){var i=e.waypoints,r=i[i.length-1];c("connection.reconnectEnd",e.source,t,e)&&n.reconnectEnd(e,t,r,{layoutConnection:s.layoutConnection})}),(0,l.forEach)(f,function(e){var i=e.waypoints[0],r=e.target;c("connection.reconnectStart",t,r,e)&&n.reconnectStart(e,t,i,{layoutConnection:s.layoutConnection})})},Cp.prototype.postExecute=function(e){var t=this._modeling,n=e.oldShape,i=e.newShape;!1!==e.hints.layoutConnection&&((0,l.forEach)(i.incoming,function(e){t.layoutConnection(e,{endChanged:!0})}),(0,l.forEach)(i.outgoing,function(e){t.layoutConnection(e,{startChanged:!0})})),t.removeShape(n)},Cp.prototype.execute=function(e){},Cp.prototype.revert=function(e){},Cp.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)},Cp.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)},Cp.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)},u(Pp,Sp.default),Pp.$inject=["modeling","rules"];var Rp=Pp;Pp.prototype.createShape=function(e,t,n){return this._modeling.createShape(e,t,n,{nested:!0})},Pp.prototype.reconnectStart=function(e,t,n){this._modeling.reconnectStart(e,t,n,{nested:!0,startChanged:!0})},Pp.prototype.reconnectEnd=function(e,t,n){this._modeling.reconnectEnd(e,t,n,{nested:!0,endChanged:!0})};var kp=l.filter,Tp=l.forEach,Ap=e.getBusinessObject,Op=e.getItemControl,jp=e.getDefaultControl,Np=e.getDefinition,Ip=e.hasPlanningTable,Dp=Ac.isPlanningTableCapable;function Bp(e,t,n,i){this._itemRegistry=e,this._modeling=t,this._cmmnReplace=n,this._cmmnFactory=i}Bp.$inject=["itemRegistry","modeling","cmmnReplace","cmmnFactory"];var Lp=Bp,zp=["requiredRule","repetitionRule","manualActivationRule"];function Fp(e,t){var n={};return n[e]=t,n}function $p(e){return!(Dp(e)&&Ip(e))}Bp.prototype.preExecute=function(e){var t=this,n=e.element,i=e.values;if(!n)throw new Error("element required");Tp(i,function(e,i){-1!==zp.indexOf(i)?t._updateRule(n,i,e):t._updateDecorator(n,i,e)})},Bp.prototype.execute=function(){},Bp.prototype.revert=function(){},Bp.prototype._updateDecorator=function(e,t,n){var i=this._modeling,r=Np(e),o=Fp(t,n),a=[];r[t]!==n&&((a=this._getReferencingShapes(r)).length>1&&$p(r)&&(r=this._replaceDefinition(e),a=e),i.updateProperties(r,o,a))},Bp.prototype._updateRule=function(e,t,n){var i=this,r=i._modeling,o=i._cmmnFactory,a=Op(e),s=jp(e),c=Np(e),u=Fp(t,n);function l(e,t){return e&&e[t]}function d(e){return!(!e||e.repetitionRule||e.requiredRule||e.manualActivationRule)}n?function(){a||(a=o.create("cmmn:PlanItemControl"),r.updateProperties(e,{itemControl:a}),r.updateSemanticParent(a,Ap(e)));r.updateProperties(a,u,e),r.updateSemanticParent(n,a)}():function(){var n;l(a,t)&&(n=a[t],r.updateProperties(a,u,e),r.updateSemanticParent(n),d(a)&&(r.updateProperties(e,{itemControl:void 0}),r.updateSemanticParent(a)));if(l(s,t)){n=s[t];var o=i._getReferencingShapes(c);o.length>1&&$p(c)&&(o=kp(o,function(e){var n=Op(e),i=jp(e);return!l(n,t)&&l(i,t)})).length>1&&(i._replaceDefinition(e),s=jp(e),o=e),r.updateProperties(s,u,o),r.updateSemanticParent(n),d(s)&&(r.updateProperties(c,{defaultControl:void 0},o),r.updateSemanticParent(s))}}()},Bp.prototype._replaceDefinition=function(e){var t=this._modeling,n=this._cmmnReplace,i=Np(e),r=n.replacePlanItemDefinition(i);return t.updateProperties(e,{definitionRef:r}),t.updateSemanticParent(r,i.$parent,"planItemDefinitions"),r},Bp.prototype._getReferencingShapes=function(e){return this._itemRegistry.getShapes(e)};var Hp=l.reduce,Up=l.keys,Vp=l.forEach,Wp=l.assign,Gp=e.getBusinessObject,qp="id",Kp="definitionRef",Yp="sentryRef",Xp=l.flatten;function Zp(e,t,n){this._elementRegistry=e,this._itemRegistry=t,this._moddle=n}Zp.$inject=["elementRegistry","itemRegistry","moddle"];var Qp=Zp;function Jp(e,t){return qp in e&&e[qp]!==t[qp]}function ef(e,t){return Kp in e&&e[Kp]!==t[Kp]}function tf(e,t){return Yp in e&&e[Yp]!==t[Yp]}function nf(e,t){Vp(t,function(t,n){e.set(n,t)})}Zp.prototype.preExecute=function(e){var t=e.element,n=e.shape;if(!t)throw new Error("element required");var i=t.businessObject||t;e.businessObject=i;var r=[];t.businessObject&&r.push(t),n&&r.push(n),e.changed=Xp(r)},Zp.prototype.execute=function(e){var t=this._elementRegistry,n=this._itemRegistry,i=this._moddle.ids,r=e.changed,o=e.element,a=e.businessObject,s=function(e){var t=Wp({},e);return rf.forEach(function(n){n in e&&(t[n]=Gp(t[n]))}),t}(e.properties),c=e.oldProperties||function(e,t){return Hp(t,function(t,n){return t[n]=e.get(n),t},{})}(a,Up(s));if(Jp(s,a)){i.unclaim(a[qp]),n.updateId(a,s[qp]);var u=t.get(o.id);u&&t.updateId(u,s[qp]),i.claim(s[qp],a)}return ef(s,a)&&n.updateReference(a,s[Kp]),tf(s,a)&&n.updateReference(a,s[Yp]),"name"in s&&Vp(r,function(e){e.label&&r.push(e.label)}),("standardEvent"in s||"isStandardEventVisible"in s)&&Vp(r,function(e){e.label&&r.push(e.label)}),nf(a,s),e.oldProperties=c,r},Zp.prototype.revert=function(e){var t=e.properties,n=e.oldProperties,i=e.businessObject,r=this._elementRegistry,o=this._itemRegistry,a=this._moddle.ids;if(Jp(n,i)&&o.updateId(i,n[qp]),ef(n,i)&&o.updateReference(i,n[Kp]),tf(n,i)&&o.updateReference(i,n[Yp]),nf(i,n),Jp(t,i)){a.unclaim(t[qp]);var s=r.get(t[qp]);s&&r.updateId(s,n[qp]),a.claim(n[qp],i)}return e.changed};var rf=["default"];var of=l.flatten;function af(){}var sf=af;af.prototype.preExecute=function(e){var t=e.element,n=e.shape;if(!t)throw new Error("element required");var i=t.businessObject||t;e.businessObject=i,e.oldParent=i.$parent;var r=[];t.businessObject&&r.push(t),n&&r.push(n),e.changed=of(r)},af.prototype.execute=function(e){var t=e.businessObject,n=e.newParent,i=e.containment;return this.updateSemanticParent(t,n,i),e.changed},af.prototype.revert=function(e){var t=e.businessObject,n=e.oldParent,i=e.containment;return this.updateSemanticParent(t,n,i),e.changed},af.prototype.updateSemanticParent=function(e,t,n){var i;e.$parent!==t&&(e.$parent&&n&&(i=e.$parent.get(n),Sn.remove(i,e)),e.$parent=null,t&&(n&&(i=t.get(n)).push(e),e.$parent=t))};var cf={};function uf(e,t){this._modeling=e,this._canvas=t}Object.defineProperty(cf,"__esModule",{value:!0}),cf.default=uf,uf.$inject=["modeling","canvas"],uf.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;(0,l.forEach)(n,function(e){var n={x:0,y:0};i.left?n.x=i.left-e.x:i.right?n.x=i.right-e.width-e.x:i.center?n.x=i.center-Math.round(e.width/2)-e.x:i.top?n.y=i.top-e.y:i.bottom?n.y=i.bottom-e.height-e.y:i.middle&&(n.y=i.middle-Math.round(e.height/2)-e.y),t.moveElements([e],n,e.parent)})},uf.prototype.postExecute=function(e){};var lf={};function df(e,t){this._canvas=e,this._layouter=t}Object.defineProperty(lf,"__esModule",{value:!0}),lf.default=df,df.$inject=["canvas","layouter"],df.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,r=e.parent,o=e.parentIndex,a=e.hints;if(!n||!i)throw new Error("source and target required");if(!r)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,a)),this._canvas.addConnection(t,r,o),t},df.prototype.revert=function(e){var t=e.connection;this._canvas.removeConnection(t),t.source=null,t.target=null};var pf={};Object.defineProperty(pf,"__esModule",{value:!0}),pf.default=hf;var ff=Math.round;function hf(e){this._canvas=e}hf.$inject=["canvas"],hf.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,r=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?(0,l.assign)(t,n):(0,l.assign)(t,{x:n.x-ff(t.width/2),y:n.y-ff(t.height/2)}),this._canvas.addShape(t,i,r),t},hf.prototype.revert=function(e){this._canvas.removeShape(e.shape)};var mf={};Object.defineProperty(mf,"__esModule",{value:!0}),mf.default=_f;var yf=gf(u),vf=gf(pf);function gf(e){return e&&e.__esModule?e:{default:e}}function _f(e){vf.default.call(this,e)}(0,yf.default)(_f,vf.default),_f.$inject=["canvas"];var xf=vf.default.prototype.execute;_f.prototype.execute=function(e){var t=e.shape;return function(e){["width","height"].forEach(function(t){void 0===e[t]&&(e[t]=0)})}(t),t.labelTarget=e.labelTarget,xf.call(this,e)};var bf=vf.default.prototype.revert;_f.prototype.revert=function(e){return e.shape.labelTarget=null,bf.call(this,e)};var wf={};function Ef(e,t){this._canvas=e,this._modeling=t}Object.defineProperty(wf,"__esModule",{value:!0}),wf.default=Ef,Ef.$inject=["canvas","modeling"],Ef.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=(0,Sn.indexOf)(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t},Ef.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,(0,Sn.add)(n.children,t,i),this._canvas.addConnection(t,n),t};var Mf={};function Sf(e,t){this._modeling=e,this._elementRegistry=t}Object.defineProperty(Mf,"__esModule",{value:!0}),Mf.default=Sf,Sf.$inject=["modeling","elementRegistry"],Sf.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;(0,l.forEach)(i,function(e){n.get(e.id)&&(e.waypoints?t.removeConnection(e):t.removeShape(e))})};var Cf={};Object.defineProperty(Cf,"__esModule",{value:!0}),Cf.saveClear=function(e,t){if("function"!=typeof t)throw new Error("removeFn iterator must be a function");if(!e)return;var n;for(;n=e[0];)t(n);return e};var Pf={};function Rf(e,t){this._canvas=e,this._modeling=t}Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.default=Rf,Rf.$inject=["canvas","modeling"],Rf.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;(0,Cf.saveClear)(n.incoming,function(e){t.removeConnection(e,{nested:!0})}),(0,Cf.saveClear)(n.outgoing,function(e){t.removeConnection(e,{nested:!0})}),(0,Cf.saveClear)(n.children,function(e){e.waypoints?t.removeConnection(e,{nested:!0}):t.removeShape(e,{nested:!0})})},Rf.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=(0,Sn.indexOf)(i.children,n),t.removeShape(n),n},Rf.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,r=e.oldParentIndex;return(0,Sn.add)(i.children,n,r),t.addShape(n,i),n};var kf={};function Tf(e){this._modeling=e}Object.defineProperty(kf,"__esModule",{value:!0}),kf.default=Tf,Tf.$inject=["modeling"];var Af={x:"y",y:"x"};Tf.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,r=e.dimension;function o(e,t){e.range.min=Math.min(t[i],e.range.min),e.range.max=Math.max(t[i]+t[r],e.range.max)}function a(e){return e[i]+e[r]/2}function s(e){return e.length-1}function c(e){return e.max-e.min}var u,d,p=n[0],f=s(n),h=n[f],m=0;(0,l.forEach)(n,function(e,u){var d,p,h;e.elements.length<2?u&&u!==n.length-1&&(o(e,e.elements[0]),m+=c(e.range)):(p=(d=(0,l.sortBy)(e.elements,i))[0],u===f&&(p=d[s(d)]),h=a(p),e.range=null,(0,l.forEach)(d,function(n){!function(e,n){var r={y:0};r[i]=e-a(n),r[i]&&(r[Af[i]]=0,t.moveElements([n],r,n.parent))}(h,n),null!==e.range?o(e,n):e.range={min:n[i],max:n[i]+n[r]}}),u&&u!==n.length-1&&(m+=c(e.range)))}),d=Math.abs(h.range.min-p.range.max),(u=Math.round((d-m)/(n.length-1)))<n.length-1||(0,l.forEach)(n,function(e,o){var a,s={};e!==p&&e!==h&&(a=n[o-1],e.range.max=0,(0,l.forEach)(e.elements,function(n,o){s[Af[i]]=0,s[i]=a.range.max-n[i]+u,e.range.min!==n[i]&&(s[i]+=n[i]-e.range.min),s[i]&&t.moveElements([n],s,n.parent),e.range.max=Math.max(n[i]+n[r],o?e.range.max:0)}))})},Tf.prototype.postExecute=function(e){};var Of={};function jf(e,t){this._layouter=e,this._canvas=t}Object.defineProperty(Of,"__esModule",{value:!0}),Of.default=jf,jf.$inject=["layouter","canvas"],jf.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return(0,l.assign)(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t},jf.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};var Nf={};function If(){}Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.default=If,If.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldParent=o,e.oldParentIndex=(0,Sn.remove)(o.children,t),(0,Sn.add)(i.children,t,r),t.parent=i,(0,l.forEach)(t.waypoints,function(e){e.x+=n.x,e.y+=n.y,e.original&&(e.original.x+=n.x,e.original.y+=n.y)}),t},If.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,r=e.oldParentIndex,o=e.delta;return(0,Sn.remove)(n.children,t),(0,Sn.add)(i.children,t,r),t.parent=i,(0,l.forEach)(t.waypoints,function(e){e.x-=o.x,e.y-=o.y,e.original&&(e.original.x-=o.x,e.original.y-=o.y)}),t};var Df={};Object.defineProperty(Df,"__esModule",{value:!0}),Df.getNewAttachPoint=function(e,t,n){var i=(0,Ka.center)(t),r=(0,Ka.center)(n),o=(0,Ka.delta)(e,i),a={x:o.x*(n.width/t.width),y:o.y*(n.height/t.height)};return(0,dc.roundPoint)({x:r.x+a.x,y:r.y+a.y})},Df.getNewAttachShapeDelta=function(e,t,n){var i=(0,Ka.center)(e),r=(0,Ka.center)(t),o=(0,Ka.center)(n),a=(0,Ka.delta)(e,i),s=(0,Ka.delta)(i,r),c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},u={x:o.x+c.x,y:o.y+c.y};return(0,dc.roundPoint)({x:u.x+a.x-e.x,y:u.y+a.y-e.y})};var Bf={};function Lf(e,t,n){var i=$f(e)[0];return(0,Df.getNewAttachPoint)(i.original||i,n,t)}function zf(e,t,n){var i=$f(e),r=i[i.length-1];return(0,Df.getNewAttachPoint)(r.original||r,n,t)}function Ff(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function $f(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}Object.defineProperty(Bf,"__esModule",{value:!0}),Bf.getResizedSourceAnchor=Lf,Bf.getResizedTargetAnchor=zf,Bf.getMovedSourceAnchor=function(e,t,n){return Lf(e,t,Ff(t,n))},Bf.getMovedTargetAnchor=function(e,t,n){return zf(e,t,Ff(t,n))};var Hf={};function Uf(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.default=Uf,Uf.prototype.add=function(e,t){return this.addAll([e],t)},Uf.prototype.addAll=function(e,t){var n=(0,kr.getClosure)(e,!!t,this);return(0,l.assign)(this,n),this};var Vf={};Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.default=Gf;var Wf=function(e){return e&&e.__esModule?e:{default:e}}(Hf);function Gf(e){this._modeling=e}Gf.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]},Gf.prototype.moveClosure=function(e,t,n,i,r){var o=this._modeling,a=e.allShapes,s=e.allConnections,c=e.enclosedConnections,u=e.topLevel,d=!1;r&&r.parent===n&&(d=!0),(0,l.forEach)(a,function(e){o.moveShape(e,t,u[e.id]&&!d&&n,{recurse:!1,layout:!1})}),(0,l.forEach)(s,function(e){var i=!!a[e.source.id],r=!!a[e.target.id];c[e.id]&&i&&r?o.moveConnection(e,t,u[e.id]&&!d&&n):o.layoutConnection(e,{connectionStart:i&&(0,Bf.getMovedSourceAnchor)(e,e.source,t),connectionEnd:r&&(0,Bf.getMovedTargetAnchor)(e,e.target,t)})})},Gf.prototype.getClosure=function(e){return(new Wf.default).addAll(e,!0)};var qf={};Object.defineProperty(qf,"__esModule",{value:!0}),qf.default=Yf;var Kf=function(e){return e&&e.__esModule?e:{default:e}}(Vf);function Yf(e){this._helper=new Kf.default(e)}Yf.$inject=["modeling"],Yf.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)},Yf.prototype.postExecute=function(e){var t,n=e.hints;n&&n.primaryShape&&(t=n.primaryShape,n.oldParent=t.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,t)};var Xf={};Object.defineProperty(Xf,"__esModule",{value:!0}),Xf.default=Qf;var Zf=function(e){return e&&e.__esModule?e:{default:e}}(Vf);function Qf(e){this._modeling=e,this._helper=new Zf.default(e)}Qf.$inject=["modeling"],Qf.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,r=e.newParentIndex,o=t.parent;return e.oldBounds=(0,l.pick)(t,["x","y","width","height"]),e.oldParent=o,e.oldParentIndex=(0,Sn.remove)(o.children,t),(0,Sn.add)(i.children,t,r),(0,l.assign)(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t},Qf.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,r=this._modeling;!1!==i.layout&&((0,l.forEach)(t.incoming,function(e){r.layoutConnection(e,{connectionEnd:(0,Bf.getMovedTargetAnchor)(e,t,n)})}),(0,l.forEach)(t.outgoing,function(e){r.layoutConnection(e,{connectionStart:(0,Bf.getMovedSourceAnchor)(e,t,n)})})),!1!==i.recurse&&this.moveChildren(e)},Qf.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,r=e.delta;return(0,Sn.add)(n.children,t,i),(0,l.assign)(t,{parent:n,x:t.x-r.x,y:t.y-r.y}),t},Qf.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)},Qf.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};var Jf={};function eh(e,t){(0,l.forEach)(t,function(t){e[t]&&delete e[t]})}function th(e,t,n,i,r,o){this._eventBus=e,this._canvas=t,this._selection=n,this._elementFactory=i,this._modeling=r,this._rules=o}Object.defineProperty(Jf,"__esModule",{value:!0}),Jf.default=th,th.$inject=["eventBus","canvas","selection","elementFactory","modeling","rules"],th.prototype.preExecute=function(e){var t=this._eventBus,n=this,i=e.tree,r=e.topParent,o=e.position;i.createdElements={},i.labels=[],(0,l.forEach)(i,function(e,a){var s=parseInt(a,10);isNaN(s)||(s||(e=(0,l.map)(e,function(e){return e.parent=r,e})),e=(0,l.sortBy)(e,"priority"),(0,l.forEach)(e,function(e){var a,c=e.id,u=e.parent,d={},p=(0,l.assign)({},e);if(s&&(p.parent=n._getCreatedElement(u,i)),u)if(t.fire("element.paste",{createdElements:i.createdElements,descriptor:p}),u=p.parent,p.waypoints)(p=n._createConnection(p,u,o,i))&&(i.createdElements[c]={element:p,descriptor:e});else{if(p.parent!==r&&(d.root=!1),p.host&&(d.attach=!0,u=n._getCreatedElement(p.host,i)),p.labelTarget)return i.labels.push(p);a={x:Math.round(o.x+p.delta.x+p.width/2),y:Math.round(o.y+p.delta.y+p.height/2)},eh(p,["id","parent","delta","host","priority"]),(p=n._createShape(p,u,a,d))&&(i.createdElements[c]={element:p,descriptor:e})}}))})},th.prototype.postExecute=function(e){var t=this._modeling,n=this._selection,i=this,r=e.tree,o=r.labels,a=[];(0,l.forEach)(o,function(e){var n,o,a,s=i._getCreatedElement(e.labelTarget,r);s&&(n=s.labels)&&n.length&&(o={x:s.x,y:s.y},s.waypoints&&(o=s.waypoints[0]),(0,l.forEach)(n,function(n){a={x:Math.round(o.x-n.x+e.delta.x),y:Math.round(o.y-n.y+e.delta.y)},t.moveShape(n,a,s.parent)}))}),(0,l.forEach)(r[0],function(e){var t=e.id,n=r.createdElements[t];n&&a.push(n.element)}),n.select(a)},th.prototype._createConnection=function(e,t,n,i){var r,o,a=this._modeling,s=this._rules;return e.waypoints=(0,l.map)(e.waypoints,function(t,i){return{x:Math.round(n.x+e.delta[i].x),y:Math.round(n.y+e.delta[i].y)}}),r=this._getCreatedElement(e.source,i),o=this._getCreatedElement(e.target,i),r&&o&&s.allowed("element.paste",{source:r,target:o})?(eh(e,["id","parent","delta","source","target","width","height","priority"]),a.createConnection(r,o,e,t)):null},th.prototype._createShape=function(e,t,n,i,r){var o=this._modeling,a=this._elementFactory;if(!this._rules.allowed("element.paste",{element:e,position:n,parent:t}))return null;var s=a.createShape(e);return o.createShape(s,n,t,i,r),s},th.prototype._getCreatedElement=function(e,t){return t.createdElements[e]&&t.createdElements[e].element};var nh={};function ih(e){this._modeling=e}Object.defineProperty(nh,"__esModule",{value:!0}),nh.default=ih,ih.$inject=["modeling"],ih.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},(0,l.assign)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t},ih.prototype.postExecute=function(e){var t=e.shape,n=e.oldBounds,i=this._modeling;(0,l.forEach)(t.incoming,function(e){i.layoutConnection(e,{connectionEnd:(0,Bf.getResizedTargetAnchor)(e,t,n)})}),(0,l.forEach)(t.outgoing,function(e){i.layoutConnection(e,{connectionStart:(0,Bf.getResizedSourceAnchor)(e,t,n)})})},ih.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return(0,l.assign)(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};var rh={};Object.defineProperty(rh,"__esModule",{value:!0}),rh.getDirection=function(e,t){if("x"===e){if(t>0)return"e";if(t<0)return"w"}if("y"===e){if(t>0)return"s";if(t<0)return"n"}return null},rh.resizeBounds=function(e,t,n){var i=n.x,r=n.y;switch(t){case"n":return{x:e.x,y:e.y+r,width:e.width,height:e.height-r};case"s":return{x:e.x,y:e.y,width:e.width,height:e.height+r};case"w":return{x:e.x+i,y:e.y,width:e.width-i,height:e.height};case"e":return{x:e.x,y:e.y,width:e.width+i,height:e.height};default:throw new Error("unrecognized direction: "+t)}};var oh={};function ah(e){this._modeling=e}Object.defineProperty(oh,"__esModule",{value:!0}),oh.default=ah,ah.$inject=["modeling"],ah.prototype.preExecute=function(e){var t=this._modeling,n=e.resizingShapes,i=e.delta,r=e.direction;(0,l.forEach)(n,function(e){var n=(0,rh.resizeBounds)(e,r,i);t.resizeShape(e,n)})},ah.prototype.postExecute=function(e){var t=this._modeling,n=e.movingShapes,i=e.delta;t.moveElements(n,i,void 0,{autoResize:!1,attach:!1})},ah.prototype.execute=function(e){},ah.prototype.revert=function(e){};var sh={};function ch(e){this._modeling=e}Object.defineProperty(sh,"__esModule",{value:!0}),sh.default=ch,ch.$inject=["modeling"],ch.prototype.execute=function(e){var t,n=e.shape,i=n.children;return e.oldChildrenVisibility=(t={},i.forEach(function(e){t[e.id]=e.hidden}),t),n.collapsed=!n.collapsed,function(e,t){e.forEach(function(e){e.hidden=t})}(i,n.collapsed),[n].concat(i)},ch.prototype.revert=function(e){var t,n=e.shape,i=e.oldChildrenVisibility,r=n.children;return t=i,r.forEach(function(e){e.hidden=t[e.id]}),n.collapsed=!n.collapsed,[n].concat(r)};var uh={};function lh(e){this._modeling=e}function dh(e,t){return(0,Sn.remove)(e&&e.attachers,t)}function ph(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),(0,Sn.add)(i,t,n)}}Object.defineProperty(uh,"__esModule",{value:!0}),uh.default=lh,lh.$inject=["modeling"],lh.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=dh(i,t),ph(n,t),t.host=n,t},lh.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,r=e.attacherIdx;return t.host=i,dh(n,t),ph(i,t,r),t};var fh={};function hh(){}Object.defineProperty(fh,"__esModule",{value:!0}),fh.default=hh,hh.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t},hh.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};var mh={};Object.defineProperty(mh,"__esModule",{value:!0});var yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};mh.default=zh;var vh=Lh(pp),gh=Lh(pf),_h=Lh(Pf),xh=Lh(Xf),bh=Lh(nh),wh=Lh(Sp),Eh=Lh(sh),Mh=Lh(oh),Sh=Lh(mf),Ch=Lh(lf),Ph=Lh(wf),Rh=Lh(Nf),kh=Lh(Of),Th=Lh(fh),Ah=Lh(_p),Oh=Lh(qf),jh=Lh(Mf),Nh=Lh(kf),Ih=Lh(cf),Dh=Lh(uh),Bh=Lh(Jf);function Lh(e){return e&&e.__esModule?e:{default:e}}function zh(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}zh.$inject=["eventBus","elementFactory","commandStack"],zh.prototype.getHandlers=function(){return{"shape.append":vh.default,"shape.create":gh.default,"shape.delete":_h.default,"shape.move":xh.default,"shape.resize":bh.default,"shape.replace":wh.default,"shape.toggleCollapse":Eh.default,spaceTool:Mh.default,"label.create":Sh.default,"connection.create":Ch.default,"connection.delete":Ph.default,"connection.move":Rh.default,"connection.layout":kh.default,"connection.updateWaypoints":Th.default,"connection.reconnectStart":Ah.default,"connection.reconnectEnd":Ah.default,"elements.move":Oh.default,"elements.delete":jh.default,"elements.distribute":Nh.default,"elements.align":Ih.default,"element.updateAttachment":Dh.default,"elements.paste":Bh.default}},zh.prototype.registerHandlers=function(e){(0,l.forEach)(this.getHandlers(),function(t,n){e.registerHandler(n,t)})},zh.prototype.moveShape=function(e,t,n,i,r){"object"===(void 0===i?"undefined":yh(i))&&(r=i,i=null);var o={shape:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("shape.move",o)},zh.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)},zh.prototype.moveElements=function(e,t,n,i){var r,o=(i=i||{}).attach,a=n;!0===o?(r=n,a=n.parent):!1===o&&(r=null);var s={shapes:e,delta:t,newParent:a,newHost:r,hints:i};this._commandStack.execute("elements.move",s)},zh.prototype.moveConnection=function(e,t,n,i,r){"object"===(void 0===i?"undefined":yh(i))&&(r=i,i=void 0);var o={connection:e,delta:t,newParent:n,newParentIndex:i,hints:r||{}};this._commandStack.execute("connection.move",o)},zh.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)},zh.prototype.createConnection=function(e,t,n,i,r,o){"object"===(void 0===n?"undefined":yh(n))&&(o=r,r=i,i=n,n=void 0);var a={source:e,target:t,parent:r,parentIndex:n,connection:i=this._create("connection",i),hints:o};return this._commandStack.execute("connection.create",a),a.connection},zh.prototype.createShape=function(e,t,n,i,r){"number"!=typeof i&&(r=i,i=void 0);var o,a,s=(r=r||{}).attach;e=this._create("shape",e),s?(o=n.parent,a=n):o=n;var c={position:t,shape:e,parent:o,parentIndex:i,host:a,hints:r};return this._commandStack.execute("shape.create",c),c.shape},zh.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var r={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",r),r.shape},zh.prototype.appendShape=function(e,t,n,i,r){r=r||{};var o={source:e,position:n,target:i,shape:t=this._create("shape",t),connection:r.connection,connectionParent:r.connectionParent,attach:r.attach};return this._commandStack.execute("shape.append",o),o.shape},zh.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)},zh.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)},zh.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)},zh.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)},zh.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape},zh.prototype.pasteElements=function(e,t,n){var i={tree:e,topParent:t,position:n};this._commandStack.execute("elements.paste",i)},zh.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)},zh.prototype.resizeShape=function(e,t,n,i){var r={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",r)},zh.prototype.createSpace=function(e,t,n,i){var r={movingShapes:e,resizingShapes:t,delta:n,direction:i};this._commandStack.execute("spaceTool",r)},zh.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)},zh.prototype.reconnectStart=function(e,t,n,i){var r={connection:e,newSource:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectStart",r)},zh.prototype.reconnectEnd=function(e,t,n,i){var r={connection:e,newTarget:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectEnd",r)},zh.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)},zh.prototype._create=function(e,t){return t instanceof B.Base?t:this._elementFactory.create(e,t)},zh.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};var Fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h=l.assign,Hh=mh.default;function Uh(e,t,n,i,r){Hh.call(this,e,t,n),this._cmmnRules=i,this._rules=r}u(Uh,Hh),Uh.$inject=["eventBus","elementFactory","commandStack","cmmnRules","rules"];var Vh=Uh;Uh.prototype.getHandlers=function(){var e=Hh.prototype.getHandlers.call(this);return e["shape.append"]=yp,e["shape.replace"]=Rp,e["connection.reconnectStart"]=Mp,e["connection.reconnectEnd"]=Mp,e["element.updateProperties"]=Qp,e["element.updateSemanticParent"]=sf,e["element.updateControls"]=Lp,e["id.updateClaim"]=gp,e},Uh.prototype.connect=function(e,t,n,i){var r=this._rules;return n||(n=r.allowed("connection.create",{source:e,target:t})||{type:"cmmn:Association"}),n.reverse?(i&&(i={connectionStart:i.connectionEnd,connectionEnd:i.connectionStart}),this.createConnection(t,e,n,t.parent,i)):this.createConnection(e,t,n,e.parent,i)},Uh.prototype.createConnection=function(e,t,n,i,r,o){"object"===(void 0===n?"undefined":Fh(n))&&(o=r,r=i,i=n,n=void 0);var a={source:e,target:t,parent:r,parentIndex:n,canExecute:i,hints:o};return i=this._create("connection",i),$h(a,{connection:i}),this._commandStack.execute("connection.create",a),a.connection},Uh.prototype.reconnectStart=function(e,t,n,i){var r={connection:e,newSource:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectStart",r)},Uh.prototype.reconnectEnd=function(e,t,n,i){var r={connection:e,newTarget:t,dockingOrPoints:n,hints:i||{}};this._commandStack.execute("connection.reconnectEnd",r)},Uh.prototype.updateProperties=function(e,t,n){this._commandStack.execute("element.updateProperties",{element:e,properties:t,shape:n})},Uh.prototype.updateSemanticParent=function(e,t,n,i){this._commandStack.execute("element.updateSemanticParent",{element:e,newParent:t,containment:n,shape:i})},Uh.prototype.updateControls=function(e,t){this._commandStack.execute("element.updateControls",{element:e,values:t})},Uh.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},Uh.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};var Wh=ds.default,Gh=e.is,qh=e.isCasePlanModel;function Kh(e){Wh.call(this,e),this.preExecute(["shape.create","elements.move"],function(e){var t=e.shape,n=e.shapes,i=e.parent||e.newParent,r=e.host||e.newHost;i&&r&&qh(r)&&(n&&n.length>1||(t=t||n[0],Gh(t,"cmmn:Criterion")&&(e.parent=e.parent&&r,e.newParent=e.newParent&&r)))},!0)}Kh.$inject=["eventBus"],u(Kh,Wh);var Yh=Kh,Xh=ds.default,Zh=l.forEach,Qh=l.filter,Jh=l.reduce,em=e.getDefinition,tm=e.getBusinessObject,nm=e.is,im=Q.getCase,rm=Q.getParent,om=Q.isSameCase,am=Q.isLabel;function sm(e,t,n,i){this._cmmnFactory=n,this._modeling=i,Xh.call(this,e);var r="caseFileItems";function o(e){var t=im(e),r=t.caseFileModel;return r||(r=n.createCaseFileModel(t),i.updateProperties(t,{caseFileModel:r})),r}function a(e){var t=e&&e.get(r);if(t&&!t.length){var n="caseFileModel",o=e.$parent;lm(e)||(n="children");var a={};a[n]=void 0,i.updateProperties(o,a),i.updateSemanticParent(e)}}function s(e){var t=(e=tm(e)).sourceRef;t&&(c(t,function(t){return e===t}),i.updateProperties(e,{sourceRef:void 0}))}function c(e,t){var n,r=(e=tm(e))&&e.get("targetRefs");r&&r.length&&(n=r.slice(),Zh(r,function(r){if(!t||t(r)){r.sourceRef===e&&i.updateProperties(r,{sourceRef:void 0});var o=n.indexOf(r);-1!==o&&n.splice(o,1)}}),r.length!==n.length&&i.updateProperties(e,{targetRefs:n}))}function u(e,t,n){var o=(e=tm(e)).children,s=o&&o.get(r);s&&s.length&&(Zh(s,function(e){(!n||n(e))&&i.updateSemanticParent(e,t,r)}),a(o))}this.preExecuted("shape.create",function(e){var t,n,a,s=e.shape,c=e.parent,u=tm(c);um(s)&&((n=em(s))&&(t=rm(u,"cmmn:Definitions"),i.updateSemanticParent(n,t,"caseFileItemDefinitions")),a=o(c),i.updateSemanticParent(s,a,r))},!0),this.preExecuted("elements.move",function(e){var t,n=e.newParent,l=e.hints,d=l&&l.primaryShape&&l.primaryShape.parent,p=(e.closure||{}).allShapes;n&&d!==n&&((p=Qh(p,function(e){return um(e)&&!am(e)&&!om(e.parent,n)}))&&p.length&&(t=o(n),p=Jh(p,function(e,t){return e[t.id]=t,e},{}),Zh(p,function(e){var n=tm(e),o=dm(n),l=rm(n);if(lm(l))i.updateSemanticParent(e,t,r);else{var d=rm(n,"cmmn:CaseFileItem");p[d.id]||i.updateSemanticParent(e,t,r)}var f=n.sourceRef;f&&!p[f.id]&&s(n),c(n,function(e){return!p[e.id]}),u(n,o,function(e){return!p[e.id]}),a(l)})))},!0),this.postExecuted("shape.delete",function(e){var n,o=e.shape,l=tm(o);if(um(o)&&!am(o)){var d,p=rm(l),f=dm(l);i.updateSemanticParent(o,null,r),s(o),c(o),u(l,f),a(p),(d=em(o))&&1===t.getReferences(d).length&&(n=em(o),i.updateSemanticParent(n,null,"caseFileItemDefinitions"))}},!0)}sm.$inject=["eventBus","itemRegistry","cmmnFactory","modeling"],u(sm,Xh);var cm=sm;function um(e){return nm(e,"cmmn:CaseFileItem")}function lm(e){return nm(e,"cmmn:CaseFile")}function dm(e){return rm(tm(e),"cmmn:CaseFile")}var pm=l.assign,fm=e.getBusinessObject,hm=e.getName,mm=cn.hasExternalLabel,ym=cn.getExternalLabelMid,vm=me.isStandardEventVisible,gm=Q.isAny,_m=ds.default;function xm(e,t,n){_m.call(this,e),this.postExecuted(["shape.create","connection.create"],200,function(e){var n,i=e.context,r=i.shape||i.connection,o=r.businessObject;mm(o)&&(n=ym(r),t.createLabel(r,n,{id:o.id+"_label",hidden:!hm(r)&&!vm(o),businessObject:o}))}),this.postExecute(["connection.updateWaypoints"],function(e){var n=e.context.connection,i=n.label;if(i&&i.hidden){var r=ym(n),o={x:r.x-i.x-i.width/2,y:r.y-i.y-i.height/2};t.moveShape(i,o)}}),this.postExecute(["shape.replace"],function(e){var t=e.context,n=t.newShape,i=t.oldShape,r=fm(n);r&&mm(r)&&(n.label.x=i.label.x,n.label.y=i.label.y)}),this.executed(["label.create"],function(e){var t,i,r=e.context.shape;r.labelTarget&&gm(r.labelTarget||r,["cmmn:CMMNElement","cmmndi:CMMNDiagramElement"])&&((i=(t=r.businessObject).di||t).label||(i.label=n.createDiLabel()),i.label.bounds||(i.label.bounds=n.createDiBounds()),pm(i.label.bounds,{x:r.x,y:r.y,width:r.width,height:r.height}))})}u(xm,_m),xm.$inject=["eventBus","modeling","cmmnFactory"];var bm=xm,wm=l.forEach,Em=l.unionBy,Mm=l.filter,Sm=ds.default,Cm=e.is,Pm=e.getDefinition,Rm=e.getBusinessObject,km=Q.getParents,Tm=Q.getParent,Am=Q.getCase,Om=Q.isLabel,jm=Ac.getAllDiscretionaryItems,Nm=Ac.getDirectItemCapables,Im=Ac.isItemCapable,Dm=Ac.isHumanTask,Bm=400;function Lm(e,t,n,i){this._modeling=t,this._cmmnReplace=n,this._itemRegistry=i;var r=this;Sm.call(this,e);this.postExecuted("shape.create",function(e){var n=e.shape;if(Im(n)){var i=Rm(n),r=Pm(i),o=Fm(i);Tm(r)||t.updateSemanticParent(r,o,"planItemDefinitions")}},!0),this.postExecuted("shape.replace",function(e){var t=e.newShape;Im(t)&&r.updatePlanItemDefinitions([t])},!0),this.postExecuted("shape.delete",function(e){var t,n=e.shape,i={};Im(n)&&!Om(n)&&(i[(t=Pm(n)).id]=t,r.deletePlanItemDefinitions(i))},!0),this.preExecuted("shape.delete",function(e){var t=e.shape,n=Pm(t);Dm(n)&&!n.$parent&&(e.discretionaryItems=e.discretionaryItems||jm(n))},!0),this.postExecuted("shape.delete",Bm,function(e){var t=e.discretionaryItems,n=[];wm(t,function(e){var t=i.getShape(e.id);t&&n.push(t)}),n&&n.length&&r.updatePlanItemDefinitions(n)},!0),this.preExecuted("elements.move",function(e){var r,o,a=e.closure.allShapes,s=e.newParent,c=e.hints,u=c&&c.primaryShape&&c.primaryShape.parent,l={},d={};s&&u!==s&&(o=Am(s),r=Mm(a,function(e){if(Im(e)&&!Om(e)&&Am(e)!==o){var t=Pm(e);return d[t.id]=d[t.id]||[],d[t.id].push(e),!0}return!1}),wm(r,function(e){var r,o,a,s=Pm(e);l[s.id]?a=l[s.id]:(r=i.getReferences(s.id),o=d[s.id],r.length>o.length&&(a=l[s.id]=n.replacePlanItemDefinition(s))),a&&a!==s&&t.updateProperties(e,{definitionRef:a})}),e.definitionReplacements=l)},!0),this.postExecuted("elements.move",Bm,function(e){var t=e.shapes,n=e.newParent,i=e.hints&&e.hints.oldParent;n&&i!==n&&(t=Mm(t,function(e){return Im(e)&&!Om(e)}))&&t.length&&r.updatePlanItemDefinitions(t)},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnectEnd","connection.reconnectStart"],Bm,function(e){var t=e.connection,n=(e.newSource||e.source||t.source,e.newTarget||e.target||t.target,[]);(function(e,t,n){return!e.businessObject.cmmnElementRef})(t)&&(t.target&&n.push(t.target),!t.target&&e.target&&n.push(e.target),e.oldTarget&&n.push(e.oldTarget),n&&n.length&&r.updatePlanItemDefinitions(n))},!0),this.deletePlanItemDefinitions=function(e){wm(e,function(e){i.getReferences(e).length||t.updateSemanticParent(e,null,"planItemDefinitions")})},this.updatePlanItemDefinitions=function(e){!function(e,t){var n={};!function e(r,o){wm(r,function(r){if(!function(e){return!!n[e.id]}(r)){!function(e){n[e.id]=e}(r),r=i.getShape(r.id)||r;var a=t(r);a&&a.length&&e(a)}o&&(n={})})}(e,!0)}(e,function(e){var n,r=Rm(e),o=Pm(r),a=function(e){var t,n;if(e.length)if(n=e.splice(0,1)[0],e.length){var i=$m(n);wm(e,function(e){var t,n;t=i,n=$m(e),i=Mm(t,function(e){return-1!==n.indexOf(e)})}),t=i[0]}else t=Fm(n);return t}(i.getReferences(o));a||(a=(n=Tm(r,"cmmn:Case"))&&n.casePlanModel),a&&a!==o.$parent&&t.updateSemanticParent(o,a,"planItemDefinitions");var s=Nm(o),c=[];return Cm(o,"cmmn:PlanFragment")&&e.children&&e.children.length&&wm(e.children,function(e){var t=Rm(e);Im(t)&&!Om(t)&&-1===s.indexOf(t)&&c.push(t)}),Em("id",s,c)})}}Lm.$inject=["eventBus","modeling","cmmnReplace","itemRegistry"],u(Lm,Sm);var zm=Lm;function Fm(e){return e=Rm(e),Tm(e,"cmmn:Stage")}function $m(e){return e=Rm(e),km(e,"cmmn:Stage")}var Hm=ds.default,Um=l.some,Vm=l.forEach,Wm=e.is,Gm=e.isCasePlanModel,qm=e.getDefinition,Km=e.getBusinessObject,Ym=Q.getParent,Xm=Q.isLabel,Zm=Q.getParents,Qm=Ac.isDiscretionaryToHumanTask,Jm=Ac.isDiscretionaryItem,ey=Ac.isPlanFragment,ty=Ac.getAllDiscretionaryItems,ny=Ac.isHumanTask;function iy(e,t,n,i){this._cmmnFactory=t,this._modeling=n,this._itemRegistry=i;var r=this;Hm.call(this,e);function o(e){return!e.businessObject.cmmnElementRef}this.preExecuted(["connection.delete","connection.reconnectEnd","connection.reconnectStart"],function(e){var t=e.context,i="connection.reconnectStart"===e.command,a=t.connection,s=a.target;if(o(a)){if(i){if(!t.newSource||!t.newTarget)return;s=t.newSource,t.oldPlanningTable=ay(s)}if(t.planningTable=ay(s),s!==t.newTarget&&!function(e,t){return Um(e.incoming,function(e){return e!==t&&o(e)})}(s,a)){var c=oy(s.parent),u=r.createPlanningTable(c);n.updateSemanticParent(s,u,"tableItems")}}}),this.postExecuted("connection.delete",function(e){o(e.connection)&&r.deletePlanningTable(e.planningTable)},!0),this.postExecuted("connection.reconnectEnd",function(e){var t=e.connection,i=t.target;if(o(t)){var a=ay(i);n.updateSemanticParent(i,e.planningTable,"tableItems"),r.deletePlanningTable(a)}},!0),this.postExecuted("connection.reconnectStart",function(e){o(e.connection)&&e.newSource&&e.newTarget&&r.deletePlanningTable(e.oldPlanningTable)},!0),this.preExecuted(["connection.create","connection.reconnectStart"],function(e){var t=e.connection,i=e.newSource||e.source,a=e.target||e.newTarget||t.target;if(o(t)){e.planningTable=ay(a);var s=qm(i);if(t.source)if(qm(t.source)===s)return;var c=r.createPlanningTable(s);n.updateSemanticParent(a,c,"tableItems")}},!0),this.postExecuted(["connection.create","connection.reconnectStart"],function(e){o(e.connection)&&r.deletePlanningTable(e.planningTable)},!0),this.preExecuted("elements.move",500,function(e){var o=e.closure.allShapes,a=e.newParent,s=e.hints,c=s&&s.primaryShape&&s.primaryShape.parent,u=e.definitionReplacements,l=[],d={};a&&c!==a&&Vm(o,function(e){var a,s,c,p,f,h=Km(e),m=[];if(Jm(e)&&!Xm(e)&&(a=Ym(h,"cmmn:PlanItemDefinition"),Wm(a,"cmmn:HumanTask")&&(s=u[a.id])&&-1===(ty(s)||[]).indexOf(h))){if(c=ty(a),!Um(c,function(e){return!o[e.id]})){var y=a.planningTable;return n.updateProperties(s,{planningTable:y},i.getShapes(s)),n.updateSemanticParent(y,s),void n.updateProperties(a,{planningTable:void 0},i.getShapes(a))}if((p=Zm(h,"cmmn:PlanningTable"))&&p.length){Vm(p,function(e){var i,r=l.indexOf(e);i=-1===r?function(e){var n=t.create("cmmn:PlanningTable",{applicabilityRules:e.applicabilityRules}),i=l.push(e);return d[i-1]=n,n}(e):d[r],f&&!f.$parent&&n.updateSemanticParent(f,i,"tableItems"),f=i,m.push(i)}),s.planningTable||(n.updateProperties(s,{planningTable:f},i.getShapes(s)),n.updateSemanticParent(f,s));var v=m.splice(0,1)[0],g=ay(h);n.updateSemanticParent(h,v,"tableItems"),r.deletePlanningTable(g)}}})},!0),this.preExecuted(["shape.create","shape.move"],function(e){var t=e.shape;if(Jm(t)&&!Xm(t)&&!Qm(t)){e.planningTable=ay(t);var i=e.parent||e.newParent;if(i){var o=oy(i),a=r.createPlanningTable(o);n.updateSemanticParent(t,a,"tableItems")}}},!0),this.postExecuted("shape.move",function(e){var t=e.shape;Jm(t)&&!Xm(t)&&(Qm(t)||r.deletePlanningTable(e.planningTable))},!0),this.preExecuted("shape.delete",function(e){var t=e.shape;Jm(t)&&!Xm(t)&&(e.planningTable=ay(t),n.updateSemanticParent(t,null,"tableItems"))},!0),this.postExecuted("shape.delete",function(e){var t=e.shape;Jm(t)&&!Xm(t)&&r.deletePlanningTable(e.planningTable)},!0),this.postExecuted("shape.delete",500,function(e){var t=e.shape,o=qm(t);if(ny(o)&&!o.$parent){var a=ty(o);Vm(a,function(e){var t=i.getShape(e.id);if(t){var o=oy(t.parent),a=r.createPlanningTable(o);n.updateSemanticParent(t,a,"tableItems")}}),o.planningTable&&r.deletePlanningTable(o.planningTable)}},!0),this.createPlanningTable=function(e){var t=e.planningTable;if(!t){t=r._cmmnFactory.create("cmmn:PlanningTable");var o=i.getShapes(e);n.updateProperties(e,{planningTable:t},o),n.updateSemanticParent(t,e)}return t},this.deletePlanningTable=function(e){if(!(e.get("tableItems").length>0)){for(var t=e.$parent;Wm(t,"cmmn:PlanningTable")&&!e.get("tableItems").length;)n.updateSemanticParent(e,null,"tableItems"),e=t,t=t.$parent;if(Wm(t,"cmmn:PlanItemDefinition")&&e&&!e.get("tableItems").length){var r=Ym(e,"cmmn:PlanItemDefinition"),o=i.getShapes(r);n.updateProperties(r,{planningTable:void 0},o),n.updateSemanticParent(e,null,null)}}}}iy.$inject=["eventBus","cmmnFactory","modeling","itemRegistry"],u(iy,Hm);var ry=iy;function oy(e){var t=function e(t){if(t&&!Gm(t)){var n=qm(t);ey(n)&&(t=Ym(t,["cmmn:Stage","cmmn:PlanItem","cmmn:DiscretionaryItem"]),t=e(t))}return t}(e);return qm(t)||Km(t)}function ay(e){return e=Km(e),Ym(e,"cmmn:PlanningTable")}var sy=l.forEach,cy=l.assign,uy=l.isArray,ly=ds.default,dy=e.is,py=200,fy=5e3;function hy(e,t,n,i,r){function o(e,t){return n.canConnectPlanItemOnPartConnection(e,t)}function a(e,t){return n.canConnectCaseFileItemOnPartConnection(e,t)}function s(e,t,i){return n.canConnectDiscretionaryConnection(e,t,i)}function c(e,r,c,u){var l=e.parent;if(u=u||{},r=r||e.source,c=c||e.target,l){var d,p,f=vy(e);if(f?(dy(f,"cmmn:PlanItemOnPart")&&(o(r,c)||(d=!0),a(r,c)&&(p={type:"cmmn:CaseFileItemOnPart",name:f.name,isStandardEventVisible:yy(e)}),s(r,c,e)&&(p={type:"cmmndi:CMMNEdge"})),dy(f,"cmmn:CaseFileItemOnPart")&&(a(r,c)||(d=!0),o(r,c)&&(p={type:"cmmn:PlanItemOnPart",name:f.name,isStandardEventVisible:yy(e)})),dy(f,"cmmn:Association")&&!function(e,t){return n.canConnectAssociation(e,t)}(r,c)&&(d=!0)):(s(r,c,e)||(d=!0),o(r,c)&&(p={type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0})),d&&(p||!gy(r)&&!gy(c)||(p={type:"cmmn:Association"}),t.removeConnection(e)),p){var h=cy({waypoints:e.waypoints.slice()},p),m=t.connect(r,c,h);return!1!==u.select&&i.select(m),m}}}ly.call(this,e),this.postExecuted("elements.move",py,function(e){var t=e.closure.allConnections;sy(t,function(e){c(e,null,null,{select:!1})})},!0),this.preExecute(["connection.reconnectEnd","connection.reconnectStart"],fy+py,function(e){var t=e.command,n="connection.reconnectStart"===t,i=e.context,o=i.connection,a=i.newSource||o.source,s=i.newTarget||o.target,c=i.dockingOrPoints,u=i.canExecute;if(!i.hints||!i.hints.nested){if(void 0===u){var l={connection:o};l[n?"hover":"source"]=a,l[n?"target":"hover"]=s,u=function(e,t){return r.allowed(e,t)}(t,l)}if(u&&u.reverse){if(!uy(c)){var d=o.waypoints.slice();d.splice(n?0:-1,1,c),c=d}i.newSource=s,i.newTarget=a,i.dockingOrPoints=c.reverse()}}}),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],fy,function(e){var t=e.connection,n=e.newSource||t.source,i=e.newTarget||t.target,r=e.hints||{};e.connection=c(t,n,i,{select:!r.nested})||t},!0),this.postExecuted("shape.replace",function(e){var n=e.newShape,i=n.businessObject,r=function(e){var t=e.attachers,n=[];return sy(t,function(e){sy(e.outgoing,function(e){n.push(e)})}),n}(n);sy(r,function(e){var n=e.source,r=e.target,a=vy(e);dy(a,"cmmn:PlanItemOnPart")&&(o(n,r)?t.updateProperties(a,{sourceRef:i},e):t.removeConnection(e))})},!0),this.postExecuted("element.updateProperties",function(e){var t=e.properties,n=e.changed;t&&!1===t.isBlocking&&sy(n,function(e){var t=e.outgoing;sy(t,function(e){c(e,null,null,{select:!1})})})},!0)}u(hy,ly),hy.$inject=["eventBus","modeling","cmmnRules","selection","rules"];var my=hy;function yy(e){return e.businessObject.isStandardEventVisible}function vy(e){return e.businessObject&&e.businessObject.cmmnElementRef}function gy(e){return dy(e,"cmmn:TextAnnotation")}var _y=ds.default,xy=Cf.saveClear,by=e.is,wy=e.getDefinition,Ey=e.getSentry,My=l.forEach,Sy=l.filter,Cy=l.assign,Py=6e3,Ry=500,ky=100;function Ty(e,t,n,i,r,o,a,s){_y.call(this,r),this._cmmnReplace=e,this._cmmnRules=t,this._elementFactory=n,this._elementRegistry=i,this._modeling=o,this._selection=a,this._rules=s;var c=this;this.preExecute(["shape.create","shape.append"],Py,function(e){var i=e.shape,r=e.source,o=e.parent||e.target||r&&r.parent,a=e.host,s=e.position;if(!(e.hints||{}).nested&&(a&&Oy(i)&&(o=a),!t.canCreate(i,o,r,s))){var c=t.canReplace([i],o,s,r);if(c&&c.replacements){var u=c.replacements[0],l=wy(i),d=Ey(i),p=u.newElementType,f=u.newDefinitionType||l&&l.$type,h=Cy({},{type:p});f&&Cy(h,{definitionType:f}),d&&Cy(h,{sentryRef:d}),e.shape=n.createShape(h)}}},!0),this.postExecuted("elements.move",Ry,function(e){var n=e.newParent,i=e.newHost,r=e.shapes.slice();if(1===r.length&&i?n=i:r=Sy(r,function(e){return!Oy(e)}),n&&!t.canMove(r,n)){var o=t.canReplace(r,n);o&&o.replacements&&c.replaceElements(r,o.replacements)}},!0),this.postExecuted(["shape.replace"],1500,function(e){var t=e.context,n=t.oldShape,i=t.newShape;o.unclaimId(n.businessObject.id,n.businessObject),o.updateProperties(i,{id:n.id})}),this.preExecute("connection.create",Py,function(e){var t=e.source,n=e.target,i=e.canExecute||function(e,t){return s.allowed("connection.create",{source:e,target:t})}(t,n);if(i&&i.replacements){var r=c.replaceElements([t,n],i.replacements,{select:!1});e.source=r[t.id]||e.source,e.target=r[n.id]||e.target,Cy(i,{replacedBy:i.reverse?e.source:e.target})}},!0),r.on("connect.end",Ry+ky,function(e){var t=e.context.canExecute,n=t&&t.replacedBy;n&&(e.context.target=n)}),this.preExecute(["connection.reconnectStart","connection.reconnectEnd"],Py,function(e){var t,n=e.command,i="connection.reconnectStart"===n,r=e.context,o=r.connection,a=r.newSource||o.source,u=r.newTarget||o.target,l={connection:o};if(!r.hints||!r.hints.nested){if(l[i?"hover":"source"]=a,l[i?"target":"hover"]=u,(t=function(e,t){return s.allowed(e,t)}(n,l))&&t.replacements){var d=c.replaceElements([a,u],t.replacements,{select:!1});r.newSource=d[a.id]||r.newSource,r.newTarget=d[u.id]||r.newTarget}r.canExecute=t}}),this.preExecute("shape.delete",Py,function(e){var t=e.shape,n=Oy(t)?t.host:t.parent,i=wy(n);by(i,"cmmn:Stage")||xy(t.incoming,function(e){o.removeConnection(e,{nested:!0,endChanged:!0})})},!0),this.postExecuted(["connection.delete","connection.reconnectEnd"],Ry,function(e){var n=e.target||e.oldTarget,i=[n],r=Oy(n)?n.host:n.parent;if(!(e.hints||{}).endChanged&&r&&!t.canMove(i,r)){var o=t.canReplace(i,r);o&&o.replacements&&c.replaceElements(i,o.replacements,{select:!1})}},!0),this.postExecuted("element.updateProperties",function(e){var n=e.properties,i=e.changed;n&&!1===n.isBlocking&&My(i,function(e){var n=e.attachers,i=t.canReplace(n,e);i&&c.replaceElements(n,i.replacements,{select:!1})})},!0),this.replaceElements=function(e,t,n){var i=this,r=this._elementRegistry,o=this._selection,a={};return n=n||{},My(t,function(t){var n,o=r.get(t.oldElementId),s=e.indexOf(o);o&&(n=i.replaceElement(o,t),-1!==s&&(e[s]=n),a[o.id]=n)}),t&&!1!==n.select&&o.select(e),a},this.replaceElement=function(e,t){var n=this._cmmnReplace,i=wy(e),r=t.newDefinitionType||i&&i.$type;if(e){var o={type:t.newElementType};return r&&Cy(o,{definitionType:r}),n.replaceElement(e,o,{select:!1})}}}Ty.$inject=["cmmnReplace","cmmnRules","elementFactory","elementRegistry","eventBus","modeling","selection","rules"],u(Ty,_y);var Ay=Ty;function Oy(e){return by(e,"cmmn:Criterion")}var jy={};Object.defineProperty(jy,"__esModule",{value:!0});var Ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};jy.resizeBounds=function(e,t,n){var i=n.x,r=n.y;switch(t){case"nw":return{x:e.x+i,y:e.y+r,width:e.width-i,height:e.height-r};case"sw":return{x:e.x+i,y:e.y,width:e.width-i,height:e.height+r};case"ne":return{x:e.x,y:e.y+r,width:e.width+i,height:e.height-r};case"se":return{x:e.x,y:e.y,width:e.width+i,height:e.height+r};default:throw new Error("unrecognized direction: "+t)}},jy.ensureConstraints=function(e,t){if(!t)return e;var n=(0,dc.asTRBL)(e);return(0,dc.asBounds)({top:Ly("top",n,t),right:Ly("right",n,t),bottom:Ly("bottom",n,t),left:Ly("left",n,t)})},jy.getMinResizeBounds=function(e,t,n,i){var r=(0,dc.asTRBL)(t),o={top:/n/.test(e)?r.bottom-n.height:r.top,left:/w/.test(e)?r.right-n.width:r.left,bottom:/s/.test(e)?r.top+n.height:r.bottom,right:/e/.test(e)?r.left+n.width:r.right},a=i?(0,dc.asTRBL)(i):o,s={top:Dy(o.top,a.top),left:Dy(o.left,a.left),bottom:Iy(o.bottom,a.bottom),right:Iy(o.right,a.right)};return(0,dc.asBounds)(s)},jy.addPadding=Fy,jy.computeChildrenBBox=function(e,t){var n;n=void 0===e.length?(0,l.filter)(e.children,$y):e;if(n.length)return Fy((0,kr.getBBox)(n),t)};var Iy=Math.max,Dy=Math.min,By=20;function Ly(e,t,n){var i=t[e],r=n.min&&n.min[e],o=n.max&&n.max[e];return(0,l.isNumber)(r)&&(i=(/top|left/.test(e)?Dy:Iy)(i,r)),(0,l.isNumber)(o)&&(i=(/top|left/.test(e)?Iy:Dy)(i,o)),i}function zy(e,t){return void 0!==e?e:By}function Fy(e,t){var n,i,r,o;return"object"===(void 0===t?"undefined":Ny(t))?(n=zy(t.left),i=zy(t.right),r=zy(t.top),o=zy(t.bottom)):n=i=r=o=zy(t),{x:e.x-n,y:e.y-r,width:e.width+n+i,height:e.height+r+o}}function $y(e){return!e.waypoints&&"label"!==e.type}var Hy=e.is,Uy=e.getBusinessObject,Vy=e.isCasePlanModel,Wy=l.filter,Gy=kr.getBBox,qy=1001,Ky=10;function Yy(e){var t,n,i=e.shape,r=e.direction;return t=e.minDimensions||{width:Ky,height:Ky},n=function(e,t){var n=Wy(e.children,function(t){return function(e,t){if(t.waypoints)return!1;if("label"===t.type)return!1;if(Hy(t,"cmmn:ExitCriterion")){var n=Uy(e),i=n.get("exitCriteria"),r=Uy(t);if(i.indexOf(r)>=0)return!1}return!0}(e,t)});if(n.length)return jy.addPadding(Gy(n),t)}(i,e.childrenBoxPadding),jy.getMinResizeBounds(r,i,t,n)}function Xy(e,t){e.on("resize.start",qy,function(e){var t=e.context,n=t.shape;Vy(n)&&(t.minBounds=Yy(t))})}Xy.$inject=["eventBus","modeling"];var Zy=Xy,Qy=ds.default,Jy=l.forEach,ev=l.flatten,tv=l.groupBy,nv=l.map,iv=l.some,rv=e.is,ov=e.isCasePlanModel,av=e.getSentry,sv=e.getBusinessObject,cv=e.getDefinition,uv=e.getStandardEvents,lv=Q.getParent,dv=Ac.isItemCapable,pv=Ac.getAllDiscretionaryItems,fv=Ac.getDirectItemCapables,hv=Ac.isHumanTask,mv=300;function yv(e,t,n,i,r){var o=this;Qy.call(this,e);function a(e){var t=_v(e);return s(e,function(e){var n=cv(e);if(hv(n)){var i=pv(e);return i&&i.length&&(t=t.concat(_v(i))),i}return fv(e)}),ev(t)}function s(e,t){var i={};!function e(r,o){Jy(r,function(r){if(!function(e){return!!i[e.id]}(r)){!function(e){i[e.id]=e}(r),r=n.getShape(r.id)||r;var a=t(r);a&&a.length&&e(a)}o&&(i={})})}(e,!0)}function c(e){var t=r.createSentry();return u(e,t),t}function u(e,n){t.updateProperties(e,{sentryRef:n})}function l(e,n){t.updateProperties(e,{cmmnElementRef:n})}function d(e){var t={name:e.name,sourceRef:e.sourceRef,standardEvent:e.standardEvent};return rv(e,"cmmn:PlanItemOnPart")&&(t.exitCriterionRef=e.exitCriterionRef),r.create(e.$type,t)}function p(e){var t=e.businessObject.cmmnElementRef;return rv(t,"cmmn:OnPart")}this.postExecuted("connection.create",function(e){var n=e.connection;if(p(n)){var i=bv(n),r=n.target,o=r.host,a=av(r);a||(a=c(r),t.updateSemanticParent(a,gv(o),"sentries")),t.updateSemanticParent(i,a,"onParts",n)}},!0),this.preExecuted("connection.delete",function(e){var n=e.connection;if(p(n)){var i=n.source,r=bv(n);xv(i,n)&&l(n,r=d(r)),t.updateSemanticParent(r,null,"onParts",n)}},!0),this.preExecuted("connection.reconnectStart",function(e){var n=e.connection,i=n.source;if(p(n)){var r=bv(n),o=n.target,a=av(o);xv(i,n)&&(l(n,r=d(r)),t.updateSemanticParent(r,a,"onParts",n))}},!0),this.preExecuted("connection.reconnectEnd",function(e){var n=e.connection,i=n.source;if(p(n)){var r=bv(n),o=n.target,a=av(o),s=e.newTarget,u=av(s);a!==u&&(u||(u=c(s),t.updateSemanticParent(u,gv(s.host),"sentries")),xv(i,n)&&l(n,r=d(r)),t.updateSemanticParent(r,u,"onParts",n))}},!0),this.postExecuted(["connection.create","connection.reconnectStart"],function(e){var n=e.connection;if(p(n)){var i,r=bv(n);(function(e){var t=bv(e),n=t.standardEvent,i=uv(t);return n&&-1!==i.indexOf(n)})(n)||(i=function(e){if(e=bv(e),rv(e.sourceRef,"cmmn:CaseFileItem"))return"update";if(rv(e.exitCriterionRef,"cmmn:ExitCriterion"))return"exit";if(rv(e.sourceRef,"cmmn:PlanItem")){var t=cv(e.sourceRef);return rv(t,"cmmn:EventListener")||rv(t,"cmmn:Milestone")?"occur":"complete"}}(n),t.updateProperties(r,{standardEvent:i},n))}},!0),this.postExecuted("element.updateAttachment",function(e){var t=e.shape;rv(t,"cmmn:Criterion")&&(t.host?o.updateSentriesSemanticParent([t]):o.deleteSentry(t))},!0),this.preExecuted("shape.delete",function(e){var t=cv(e.shape);hv(t)&&(e.discretionaryItems=e.discretionaryItems||pv(t))},!0),this.postExecuted("shape.delete",mv,function(e){var t;(t=a(e.discretionaryItems))&&t.length&&o.updateSentriesSemanticParent(t)},!0),this.postExecuted(["connection.create","connection.delete","connection.reconnectEnd","connection.reconnectStart"],mv,function(e){var t,n=e.connection,i=(e.newSource||e.source||n.source,e.newTarget||e.target||n.target,[]);(function(e,t,n){return!e.businessObject.cmmnElementRef})(n)&&(n.target&&i.push(n.target),!n.target&&e.target&&i.push(e.target),e.oldTarget&&i.push(e.oldTarget),(t=a(i))&&t.length&&o.updateSentriesSemanticParent(t))},!0),this.postExecuted("elements.move",mv,function(e){var t,n=e.shapes,i=e.newParent;(e.hints&&e.hints.oldParent)!==i&&(t=a(n))&&t.length&&o.updateSentriesSemanticParent(t)},!0),this.deleteSentry=function(e){var i=av(e);i&&n.getReferences(i).length<=1&&t.updateSemanticParent(i,null,"sentries")},this.updateSentriesSemanticParent=function(e){var r=function(e){return tv(e,function(e){var t=av(e);return t&&t.id})}(e),o={};function a(e,t){o[e.id]=t}function c(e){return o[e.id]||e}s(e,function(e){var s=av(e);if(s){var p=gv(e.host);if(!p){var f=lv(sv(e));p=f&&gv(f)}if(s.$parent===p)return;if(!o[s.id]&&function(e,t){var i=n.getReferences(e),o=r[e.id]||[];return n.getReferences(e).length>o.length&&(!t||iv(i,function(e){var i=n.getShape(e);return i&&t!==gv(i.host)}))}(s,p)){var h=i.replaceSentry(s);a(s,h),Jy(e.incoming,function(e){var t=e.businessObject.cmmnElementRef;t&&rv(t,"cmmn:OnPart")&&a(t,d(t))})}s=c(s),av(e)!==s&&u(e,s),Jy(e.incoming,function(e){var n=e.businessObject.cmmnElementRef;if(n&&rv(n,"cmmn:OnPart")){var i=c(n);i&&n!==i&&(l(e,i),t.updateSemanticParent(i,s,"onParts"))}}),t.updateSemanticParent(s,p,"sentries")}})}}yv.$inject=["eventBus","modeling","itemRegistry","cmmnReplace","cmmnFactory"],u(yv,Qy);var vv=yv;function gv(e){if(ov(e))return sv(e);if(dv(e)){var t=sv(e);return lv(t,"cmmn:PlanFragment")}}function _v(e){return ev(nv(e,function(e){var t=[];if(e.attachers)t=e.attachers;else{var n=sv(e),i=n.get("exitCriteria");Jy(i,function(e){t.push(e)});var r=n.get("entryCriteria");Jy(r,function(e){t.push(e)})}return t||[]}))}function xv(e,t){var n=bv(t);return iv(e.outgoing,function(e){return t!==e&&n===bv(e)})}function bv(e){return(e=sv(e)).cmmnElementRef}var wv=l.forEach,Ev=ds.default;function Mv(e,t){Ev.call(this,e),this.preExecute("elements.delete",function(e){var n=e.context.elements;wv(n,function(e){t.unclaimId(e.businessObject.id,e.businessObject)})})}u(Mv,Ev),Mv.$inject=["eventBus","modeling"];var Sv={__init__:["attachCriterionBehavior","caseFileItemUpdater","labelBehavior","planItemDefinitionUpdater","planningTableUpdater","replaceConnectionBehavior","replaceElementBehavior","resizeCasePlanModelBehavior","sentryUpdater","unclaimIdBehavior"],attachCriterionBehavior:["type",Yh],caseFileItemUpdater:["type",cm],labelBehavior:["type",bm],planItemDefinitionUpdater:["type",zm],planningTableUpdater:["type",ry],replaceConnectionBehavior:["type",my],replaceElementBehavior:["type",Ay],resizeCasePlanModelBehavior:["type",Zy],sentryUpdater:["type",vv],unclaimIdBehavior:["type",Mv]},Cv={};Object.defineProperty(Cv,"__esModule",{value:!0}),Cv.default=Tv;var Pv=kv(u),Rv=kv(ds);function kv(e){return e&&e.__esModule?e:{default:e}}function Tv(e){Rv.default.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(e){var n=e.context,i=n.shape||n.connection,r=n.parent,o=t.getOrdering(i,r);o&&(void 0!==o.parent&&(n.parent=o.parent),n.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(e){var n=e.context,i=n.shape||n.connection,r=n.newParent||i.parent,o=t.getOrdering(i,r);o&&(void 0!==o.parent&&(n.newParent=o.parent),n.newParentIndex=o.index)})}Tv.prototype.getOrdering=function(e,t){return null},(0,Pv.default)(Tv,Rv.default);var Av=Cv.default,Ov=l.findIndex,jv=l.find,Nv=e.is,Iv=Q.isAny;function Dv(e){Av.call(this,e);var t=[{type:"label",order:{level:10}},{type:"cmmn:Criterion",order:{level:6}},{type:"cmmn:OnPart",order:{level:9,containers:["cmmn:Stage"]}},{type:"cmmn:Association",order:{level:9,containers:["cmmndi:CMMNDiagram"]}},{type:"cmmndi:CMMNEdge",order:{level:9,containers:["cmmn:PlanItem","cmmn:DiscretionaryItem","cmmn:Stage"]}}];function n(e){var n=e.order;return n||(e.order=n=function(e){Bv(e)&&(e=e.businessObject.cmmnElementRef||e);var n=jv(t,function(t){return Nv(e,t.type)});return n&&n.order||{level:1}}(e)),n}this.getOrdering=function(e,t){var i=n(e);i.containers&&(t=function(e,t,n){var i=t;for(Bv(e)&&e.source&&(i=e.source.parent);i&&!Iv(i,n);)i=i.parent;if(!i)throw new Error("no parent for "+e.id+" in "+t.id);return i}(e,t,i.containers));var r=t.children.indexOf(e),o=Ov(t.children,function(t){return!(!e.labelTarget&&t.labelTarget)&&i.level<n(t).level});return-1!==o&&-1!==r&&r<o&&(o-=1),{index:o,parent:t}}}function Bv(e){return Nv(e,"cmmndi:CMMNEdge")}Dv.$inject=["eventBus"],u(Dv,Av);var Lv={__init__:["cmmnOrderingProvider"],cmmnOrderingProvider:["type",Dv]},zv=e.is,Fv=e.getDefinition,$v=e.isAutoComplete,Hv=me.isCollapsed,Uv=me.isPlanningTableCollapsed,Vv=Ac.isPlanningTableCapable,Wv=Ac.isItemCapable;function Gv(e,t,n,i){function r(t,n){var i;return t&&(n=n||t.$type,i=e.createCriterion(n,{sentryRef:t.sentryRef,name:t.name})),i}function o(t,n){n=n||t.$type;var i=e.create(n,{name:t.name});if(Qv(i)&&t.defaultControl){var r=s(t.defaultControl,i);l(r,i),i.defaultControl=r}return Zv(i)&&t.autoComplete&&(i.autoComplete=t.autoComplete),Yv(t)&&Yv(i)&&(i.isBlocking=t.isBlocking),i}function a(t,n,i){n=n||t.$type,i=i||Fv(t);var r=e.create(n,{name:t.name,definitionRef:i});if(Qv(r)&&t.itemControl){var o=s(t.itemControl,r);l(o,r),r.itemControl=o}return r}function s(t,n){var r;if(t){r=e.create("cmmn:PlanItemControl");var o=t.repetitionRule;!o||n&&!i.canSetRepetitionRule(n)||(l(o=c(o),r),r.repetitionRule=o);var a=t.requiredRule;!a||n&&!i.canSetRequiredRule(n)||(l(a=c(a),r),r.requiredRule=a);var s=t.manualActivationRule;!s||n&&!i.canSetManualActivationRule(n)||(l(s=c(s),r),r.manualActivationRule=s)}return r}function c(t){var n;if(t){var i=t.$type,r=u(t.condition);l(r,n=e.create(i,{condition:r}))}return n}function u(t){var n;return t&&(n=e.create("cmmn:Expression",{language:t.language,body:t.body})),n}function l(e,t){e&&(e.$parent=t)}this.replaceElement=function(i,s,c){c=c||{};var u,l=s.type,d=i.businessObject,p={type:l};if(function(e){return zv(e,"cmmn:Criterion")}(d)&&(u=r(d,l)),Wv(d)){var f=Fv(d),h=s.definitionType,m=f;f.$type!==h&&(m=o(f,h)),u=a(d,l,m),Xv(f)&&Xv(m)&&!1!==s.isCollapsed&&(p.isCollapsed=Hv(d)),Yv(f)&&!0===s.isCollapsed&&(p.isCollapsed=!0),Yv(m)&&!1===s.isBlocking&&(p.isBlocking=!1),Vv(f)&&Vv(m)&&(p.isPlanningTableCollapsed=Uv(d)),Zv(f)&&Zv(m)&&(p.autoComplete=$v(d)),Hv(d)||s.isCollapsed||Yv(f)||(p.width=i.width,p.height=i.height)}return p.businessObject=u||e.create(l),p=t.replaceElement(i,p,c),!1!==c.select&&n.select(p),p},this.replaceCriterion=r,this.replaceSentry=function(t){var n;if(t&&(n=e.createSentry({name:t.name}),t.ifPart)){var i=e.create("cmmn:IfPart");l(i,n),n.ifPart=i;var r=u(t.ifPart.condition);l(r,i),i.condition=r}return n},this.replacePlanItemDefinition=o,this.replaceItemCapable=a,this.replacePlanItemControl=s,this.replaceRule=c,this.replaceCondition=u}Gv.$inject=["cmmnFactory","replace","selection","cmmnRules"];var qv=Gv;function Kv(e,t){return e=Fv(e),zv(e,t)}function Yv(e){return Kv(e,"cmmn:Task")}function Xv(e){return Kv(e,"cmmn:PlanFragment")}function Zv(e){return Kv(e,"cmmn:Stage")}function Qv(e){return Yv(e)||Zv(e)||function(e){return Kv(e,"cmmn:Milestone")}(e)}var Jv={};Object.defineProperty(Jv,"__esModule",{value:!0}),Jv.default=eg;function eg(e,t,n){var i=(0,l.isDefined)(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}eg.$inject=["config.popupMenu","eventBus","canvas"],eg.prototype.registerProvider=function(e,t){this._providers[e]=t},eg.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._providers[t],i=n.getEntries(e),r=n.getHeaderEntries&&n.getHeaderEntries(e),o=i.length>0,a=r&&r.length>0;return!o&&!a},eg.prototype.open=function(e,t,n){var i=this._providers[t];if(!e)throw new Error("Element is missing");if(!i)throw new Error("Provider is not registered: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var r=this._current={provider:i,className:t,element:e,position:n};i.getHeaderEntries&&(r.headerEntries=i.getHeaderEntries(e)),r.entries=i.getEntries(e),r.container=this._createContainer();var o=r.headerEntries||[],a=r.entries||[];o.length&&r.container.appendChild(this._createEntries(r.headerEntries,"djs-popup-header")),a.length&&r.container.appendChild(this._createEntries(r.entries,"djs-popup-body"));var s=this._canvas.getContainer();this._attachContainer(r.container,s,n.cursor)},eg.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindHandlers(),(0,at.remove)(this._current.container),this._current.container=null)},eg.prototype.isOpen=function(){return!!this._current.container},eg.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=(0,at.attr)(t,"data-id"),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)},eg.prototype._getEntry=function(e){var t=(0,l.matchPattern)({id:e}),n=(0,l.find)(this._current.entries,t)||(0,l.find)(this._current.headerEntries,t);if(!n)throw new Error("entry not found");return n},eg.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)},eg.prototype._createContainer=function(){var e=(0,at.domify)('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return(0,l.assign)(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),(0,at.classes)(e).add(n),e},eg.prototype._attachContainer=function(e,t,n){var i=this;at.delegate.bind(e,".entry","click",function(e){i.trigger(e)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n),this._bindHandlers()},eg.prototype._updateScale=function(e){var t,n,i,r,o=this._canvas.zoom(),a=this._config.scale,s=o;!0!==a&&(!1===a?(t=1,n=1):(t=a.min,n=a.max),(0,l.isDefined)(t)&&o<t&&(s=t),(0,l.isDefined)(n)&&o>n&&(s=n)),r="scale("+s+")",(i=e).style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(e){i.style[e+"transform"]=r})},eg.prototype._assureIsInbounds=function(e,t){var n,i,r=this._canvas._container.getBoundingClientRect(),o=e.offsetLeft,a=e.offsetTop,s=e.scrollWidth,c=e.scrollHeight,u={},d=t.x-r.left,p=t.y-r.top;o+s>r.width&&(u.x=!0),a+c>r.height&&(u.y=!0),u.x&&u.y?(n=d-s+"px",i=p-c+"px"):u.x?(n=d-s+"px",i=p+"px"):u.y&&p<c?(n=d+"px",i="10px"):u.y&&(n=d+"px",i=p-c+"px"),(0,l.assign)(e.style,{left:n,top:i},{visibility:"visible","z-index":1e3})},eg.prototype._createEntries=function(e,t){var n=(0,at.domify)("<div>"),i=this;return(0,at.classes)(n).add(t),(0,l.forEach)(e,function(e){var t=i._createEntry(e,n);n.appendChild(t)}),n},eg.prototype._createEntry=function(e){if(!e.id)throw new Error("every entry must have the id property set");var t=(0,at.domify)("<div>"),n=(0,at.classes)(t);if(n.add("entry"),e.className&&e.className.split(" ").forEach(function(e){n.add(e)}),(0,at.attr)(t,"data-id",e.id),e.label){var i=(0,at.domify)("<span>");i.textContent=e.label,t.appendChild(i)}return e.imageUrl&&t.appendChild((0,at.domify)('<img src="'+e.imageUrl+'" />')),!0===e.active&&n.add("active"),!0===e.disabled&&n.add("disabled"),e.title&&(t.title=e.title),t},eg.prototype._bindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.once("contextPad.close",n),e.once("canvas.viewbox.changing",n),e.once("commandStack.changed",n)},eg.prototype._unbindHandlers=function(){var e=this._eventBus,t=this;function n(){t.close()}e.off("contextPad.close",n),e.off("canvas.viewbox.changed",n),e.off("commandStack.changed",n)};var tg={};Object.defineProperty(tg,"__esModule",{value:!0});var ng=function(e){return e&&e.__esModule?e:{default:e}}(Jv);tg.default={__init__:["popupMenu"],popupMenu:["type",ng.default]};var ig={};Object.defineProperty(ig,"__esModule",{value:!0}),ig.default=og;var rg=Math.round;function og(e){this._modeling=e}og.$inject=["modeling"],og.prototype.replaceElement=function(e,t,n){var i=this._modeling,r=null;return e.waypoints||(t.x=rg(e.x+(t.width||e.width)/2),t.y=rg(e.y+(t.height||e.height)/2),r=i.replaceShape(e,t,n)),r};var ag={};Object.defineProperty(ag,"__esModule",{value:!0});var sg=function(e){return e&&e.__esModule?e:{default:e}}(ig);ag.default={__init__:["replace"],replace:["type",sg.default]};var cg={__depends__:[tg.default,ag.default,wa.default],cmmnReplace:["type",qv]},ug={},lg=dc.getOrientation,dg=e.is,pg=e.getDefinition;function fg(e,t,n,i){return e.x-i<t.x&&e.y-i<t.y?"corner":e.x+i>t.x+t.width&&e.y-i<t.y?"corner":e.x-i<t.x&&e.y+i>t.y+t.height?"corner":e.x+i>t.x+t.width&&e.y+i>t.y+t.height?"corner":lg(e,t,n)}ug.getCriterionAttachment=function(e,t){var n,i=pg(t);return"intersect"!==(n=dg(t,"cmmn:PlanItem")&&dg(i,"cmmn:Stage")?fg(e,t,-15,20):dg(i,"cmmn:Milestone")?fg(e,t,-3,7):lg(e,t,-15))?n:null};var hg=l.some,mg=l.forEach,yg=l.assign,vg=l.filter,gg=e.is,_g=e.isCasePlanModel,xg=e.getDefinition,bg=e.getBusinessObject,wg=me.isCollapsed,Eg=Q.isAny,Mg=Q.isSame,Sg=Q.isSameCase,Cg=Q.getParent,Pg=Q.getParents,Rg=Ac.isDiscretionaryToHumanTask,kg=Ac.isHumanTask,Tg=Ac.isDiscretionaryItem,Ag=ug.getCriterionAttachment,Og=fs.default;function jg(e){Og.call(this,e)}u(jg,Og),jg.$inject=["eventBus"];var Ng=jg;function Ig(e,t){return-1!==Pg(t).indexOf(e)}function Dg(e){return Wg(e)||Vg(e)||gg(xg(e),"cmmn:Stage")}function Bg(e){return!e||Lg(e)}function Lg(e){return e.labelTarget}function zg(e){return e.waypoints}function Fg(e){return!e.businessObject.cmmnElementRef}function $g(e){return hg(e.incoming,function(e){return gg(e.businessObject.cmmnElementRef,"cmmn:OnPart")})}function Hg(e,t){var n=xg(e)||e;return!!gg(n,"cmmn:PlanFragment")&&!(!t&&gg(n,"cmmn:Stage"))}function Ug(e){return gg(xg(e),"cmmn:EventListener")}function Vg(e){return gg(xg(e),"cmmn:Milestone")}function Wg(e){return gg(xg(e),"cmmn:Task")}function Gg(e){return!(!(e=xg(e))||!e.isBlocking)}function qg(e){return gg(e,"cmmn:Criterion")}function Kg(e){return gg(e,"cmmn:EntryCriterion")}function Yg(e){return gg(e,"cmmn:ExitCriterion")}function Xg(e){return gg(e,"cmmn:TextAnnotation")}function Zg(e){return gg(e,"cmmn:CaseFileItem")}function Qg(e){return gg(e,"cmmn:PlanItem")}jg.prototype.init=function(){var e=this;this.addRule("connection.start",function(e){return function(e){if(Bg(e))return null;return Eg(e,["cmmn:CaseFileItem","cmmn:Criterion","cmmn:DiscretionaryItem","cmmn:PlanItem"])}(e.source)}),this.addRule("connection.create",function(t){var n=t.source,i=t.target,r=!1,o=t.hints||{},a=o.targetParent;if(o.targetAttach)return!1;a&&(i.parent=a);try{(r=e.canConnect(n,i)||e.canReplaceConnectionEnd(n,i,"target"))||(r=e.canConnect(i,n)||e.canReplaceConnectionEnd(i,n,"source"))&&yg(r,{reverse:!0})}finally{a&&(i.parent=null)}return r}),this.addRule("connection.reconnectStart",function(t){var n=t.connection,i=t.hover,r=i||t.source,o=n.target,a=!1;return!(a=e.canConnect(r,o,n))&&i&&((a=e.canReplaceConnectionEnd(i,o,"source"))||(a=e.canConnect(o,i,n)||e.canReplaceConnectionEnd(o,i,"target"))&&yg(a,{reverse:!0})),a}),this.addRule("connection.reconnectEnd",function(t){var n=t.connection,i=n.source,r=t.hover,o=r||t.target,a=!1;return!(a=e.canConnect(i,o,n))&&r&&((a=e.canReplaceConnectionEnd(i,r,"target"))||(a=e.canConnect(r,i,n)||e.canReplaceConnectionEnd(r,i,"source"))&&yg(a,{reverse:!0})),a}),this.addRule("connection.updateWaypoints",function(e){var t=e.connection;return{type:t.type,businessObject:t.businessObject}}),this.addRule("shape.attach",function(t){return e.canAttach(t.shape,t.target,null,t.position)}),this.addRule("shape.create",function(t){var n=t.target,i=t.shape,r=t.source,o=t.position,a=[i];return e.canCreate(i,n,r,o)||e.canReplace(a,n,o,r)}),this.addRule("shape.resize",function(t){var n=t.shape,i=t.newBounds;return e.canResize(n,i)}),this.addRule("elements.move",function(t){var n=t.target,i=t.shapes,r=t.position;return e.canAttach(i,n,null,r)||e.canMove(i,n,r)||e.canReplace(i,n,r)}),this.addRule("shape.replace",function(e){var t,n=e.element;if(qg(n)){if(t=n.host,_g(t))return!1;if(Wg(t)&&!Gg(t))return!1;if(Vg(t)||Ug(t))return!1}}),this.addRule(["elements.delete"],function(t){return e.canRemove(t.elements)})},jg.prototype.canRemove=function(e){return vg(e,function(e){return!Lg(e)})},jg.prototype.canMove=function(e,t){var n=this;return!t||e.every(function(i){return!(Tg(i)&&!n.canMoveDiscretionaryItem(i,e,t))&&n.canDrop(i,t)})},jg.prototype.canMoveDiscretionaryItem=function(e,t,n){return!Hg(n)||hg(e.incoming,function(e){var i=e.source;if(Fg(e))return Ig(n,i)||-1!==t.indexOf(i)})},jg.prototype.canCreate=function(e,t,n,i){return!!t&&(Lg(t)?null:!Mg(n,t)&&((!n||!Ig(n,t))&&(!(Tg(e)&&!this.canCreateDiscretionaryItem(e,t,n))&&this.canDrop(e,t,i))))},jg.prototype.canCreateDiscretionaryItem=function(e,t,n){return!Hg(t)||Ig(t,n)},jg.prototype.canDrop=function(e,t){return!(!Lg(e)||zg(t))||(function(e){zg(e)&&(e=e.businessObject.cmmnElementRef);return gg(e,"cmmn:Artifact")}(e)?gg(t,"cmmndi:CMMNDiagram")||Hg(t,!0):!qg(e)&&(_g(e)?gg(t,"cmmndi:CMMNDiagram"):!!Hg(t,!0)&&!wg(t)))},jg.prototype.canResize=function(e,t){return Hg(e,!0)?!wg(e)&&(!t||t.width>=100&&t.height>=80):!!Xg(e)},jg.prototype.canConnect=function(e,t,n){return Bg(e)||Bg(t)?null:!Mg(e,t)&&(this.canConnectPlanItemOnPartConnection(e,t)?{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0}:this.canConnectCaseFileItemOnPartConnection(e,t)?{type:"cmmn:CaseFileItemOnPart",isStandardEventVisible:!0}:this.canConnectDiscretionaryConnection(e,t,n)?{type:"cmmndi:CMMNEdge"}:n&&gg(n.businessObject.cmmnElementRef,"cmmn:Association")&&this.canConnectAssociation(e,t)?{type:"cmmn:Association"}:!(!Xg(e)&&!Xg(t))&&{type:"cmmn:Association"})},jg.prototype.canConnectDiscretionaryConnection=function(e,t,n){if(!kg(xg(e)))return!1;if(!Gg(e))return!1;if(!Tg(t))return!1;var i=xg(e),r=xg(t);if(Mg(i,r))return!1;var o=Cg(e),a=Cg(t);if(!Mg(o,a))return!1;if(Rg(t)){if(!function(e,t,n){return!hg(t.incoming,function(i){return i!==n&&Fg(i)&&i.source===e&&i.target===t})}(e,t,n))return!1;var s=Cg(bg(t),"cmmn:HumanTask");if(!Mg(xg(e),s)&&function(e,t){return hg(e.incoming,function(e){return e!==t&&Fg(e)})}(t,n))return!1}return!0},jg.prototype.canConnectPlanItemOnPartConnection=function(e,t){return!!Sg(e,t)&&(Yg(e)&&(e=e.host),!Mg(e,t.host)&&(!Ig(e,t.host)&&((!Kg(t)||!Ig(t.host,e))&&(Qg(e)&&qg(t)))))},jg.prototype.canConnectCaseFileItemOnPartConnection=function(e,t){return!!(Sg(e,t)&&Zg(e)&&qg(t))},jg.prototype.canConnectAssociation=function(e,t){return!zg(e)&&!zg(t)&&(!Ig(t,e)&&!Ig(e,t))},jg.prototype.canAttach=function(e,t,n,i){if(Mg(n,t))return!1;if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var r=e[0];return!Lg(r)&&(!!qg(r)&&(!t||!!this.canAttachCriterion(r,t,i,n)&&"attach"))},jg.prototype.canAttachEntryCriterion=function(e,t,n,i){return!!this.canAttachCriterion(e,t,n,i)&&((!i||!Ig(t,i))&&(!_g(t)&&(!Hg(t,!0)||!hg(e.incoming,function(e){if(gg(e.businessObject.cmmnElementRef,"cmmn:PlanItemOnPart"))return Ig(t,e.source)}))))},jg.prototype.canAttachExitCriterion=function(e,t,n,i){return!!this.canAttachCriterion(e,t,n,i)&&(!Vg(t)&&!(Wg(t)&&!Gg(t)))},jg.prototype.canAttachCriterion=function(e,t,n,i){return(!i||!Ig(i,t))&&(!qg(t)&&(!Ug(t)&&(!Hg(t)&&(!Xg(t)&&(!Zg(t)&&!(n&&!Ag(n,t)))))))},jg.prototype.canReplace=function(e,t,n,i){if(!t)return!1;if(Mg(i,t))return!1;var r={replacements:[]},o=this;return mg(e,function(a){if(Kg(a)&&!o.canAttachEntryCriterion(a,t,n,i)&&o.canAttachExitCriterion(a,t,n,i)&&r.replacements.push({oldElementId:a.id,newElementType:"cmmn:ExitCriterion"}),Yg(a)&&!o.canAttachExitCriterion(a,t,n,i)&&o.canAttachEntryCriterion(a,t,n,i)&&r.replacements.push({oldElementId:a.id,newElementType:"cmmn:EntryCriterion"}),Hg(t)&&Tg(a)&&o.canDrop(a,t)&&!o.canMoveDiscretionaryItem(a,e,t)){var s={oldElementId:a.id,newElementType:"cmmn:PlanItem"};Hg(a)&&yg(s,{newDefinitionType:"cmmn:Stage"}),r.replacements.push(s)}}),!!r.replacements.length&&r},jg.prototype.canReplaceConnectionEnd=function(e,t,n){return!(!e||!t)&&(!Mg(e,t)&&(!!Sg(e,t)&&("source"===n?this.canReplaceSource(e,t):this.canReplaceTarget(e,t))))},jg.prototype.canReplaceSource=function(e,t){return Tg(e)&&qg(t)?!Mg(e,t.host)&&(!Hg(e)&&(!Ig(e,t.host)&&((!Kg(t)||!Ig(t.host,e))&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:e.id,newElementType:"cmmn:PlanItem"}]}))):!(!Kg(e)||!Kg(t))&&(!Mg(e.host,t.host)&&(!Ig(t.host,e.host)&&!Ig(e.host,t.host)&&(!$g(e)&&(!!this.canAttachExitCriterion(e,e.host)&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:e.id,newElementType:"cmmn:ExitCriterion"}]}))))},jg.prototype.canReplaceTarget=function(e,t){return kg(xg(e))&&Qg(t)?!!Gg(e)&&(!Ug(t)&&!Vg(t)&&(n=t,!Mg(xg(e),xg(n))&&(!!function(e,t){return Mg(Cg(e),Cg(t))}(e,t)&&{type:"cmmndi:CMMNEdge",replacements:[{oldElementId:t.id,newElementType:"cmmn:DiscretionaryItem"}]}))):!(!Qg(e)&&!Yg(e)||!Kg(t))&&(!Mg(e.host||e,t.host)&&(!!Ig(t.host,e.host||e)&&(!$g(t)&&(!!this.canAttachExitCriterion(t,t.host)&&{type:"cmmn:PlanItemOnPart",isStandardEventVisible:!0,replacements:[{oldElementId:t.id,newElementType:"cmmn:ExitCriterion"}]}))));var n},jg.prototype.canSetRepetitionRule=function(e){return Dg(e)},jg.prototype.canSetRequiredRule=function(e){return Dg(e)},jg.prototype.canSetManualActivationRule=function(e){return!Vg(e)&&Dg(e)};var Jg={__depends__:[Ou.default],__init__:["cmmnRules"],cmmnRules:["type",Ng]},e_={};Object.defineProperty(e_,"__esModule",{value:!0}),e_.default=s_;var t_=i_(u),n_=i_(ds);function i_(e){return e&&e.__esModule?e:{default:e}}var r_=251,o_=1401,a_="attach-ok";function s_(e,t,n,i,r){n_.default.call(this,t);var o=e.get("movePreview",!1);t.on("shape.move.start",o_,function(e){var t,n,i=e.context,r=i.shapes,o=i.validatedShapes;i.shapes=(n=c_(t=r),(0,l.unionBy)("id",t,n)),i.validatedShapes=function(e){var t=(0,l.groupBy)(e,"id");return(0,l.filter)(e,function(e){for(;e;){if(e.host&&t[e.host.id])return!1;e=e.parent}return!0})}(o)}),o&&t.on("shape.move.start",r_,function(e){var t=e.context,n=c_(t.shapes);(0,l.forEach)(n,function(e){o.makeDraggable(t,e,!0),(0,l.forEach)(e.labels,function(e){o.makeDraggable(t,e,!0)})})}),o&&t.on("shape.move.start",function(e){var i=e.context.shapes;if(1===i.length){var r=i[0].host;r&&(n.addMarker(r,a_),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(r,a_)}))}}),this.preExecuted("elements.move",o_,function(e){var t=e.context,n=t.closure,i=c_(t.shapes);(0,l.forEach)(i,function(e){n.add(e,n.topLevel[e.host.id])})}),this.postExecuted("elements.move",function(e){var t,n=e.context,i=n.shapes,o=n.newHost;1===i.length&&(t=o?i:(0,l.filter)(i,function(e){return!!e.host}),(0,l.forEach)(t,function(e){r.updateAttachment(e,o)}))}),this.postExecuted("elements.move",function(e){var t=e.context.shapes;(0,l.forEach)(t,function(e){(0,l.forEach)(e.attachers,function(e){(0,l.forEach)(e.outgoing.slice(),function(e){i.allowed("connection.reconnectStart",{connection:e,source:e.source,target:e.target})||r.removeConnection(e)}),(0,l.forEach)(e.incoming.slice(),function(e){i.allowed("connection.reconnectEnd",{connection:e,source:e.source,target:e.target})||r.removeConnection(e)})})})}),this.postExecute("shape.create",function(e){var t=e.context,n=t.shape,i=t.host;i&&r.updateAttachment(n,i)}),this.postExecute("shape.replace",function(e){var t=e.context,n=t.oldShape,o=t.newShape;(0,Cf.saveClear)(n.attachers,function(e){"attach"===i.allowed("elements.move",{target:o,shapes:[e]})?r.updateAttachment(e,o):r.removeShape(e)}),o.attachers.length&&(0,l.forEach)(o.attachers,function(e){var t=(0,Df.getNewAttachShapeDelta)(e,n,o);r.moveShape(e,t,e.parent)})}),this.postExecute("shape.resize",function(e){var t=e.context,n=t.shape,i=t.oldBounds,o=t.newBounds,a=n.attachers;(0,l.forEach)(a,function(e){var t=(0,Df.getNewAttachShapeDelta)(e,i,o);r.moveShape(e,t,e.parent),(0,l.forEach)(e.labels,function(e){r.moveShape(e,t,e.parent)})})}),this.preExecute("shape.delete",function(e){var t=e.context.shape;(0,Cf.saveClear)(t.attachers,function(e){r.removeShape(e)}),t.host&&r.updateAttachment(t,null)}),t.on("spaceTool.move",function(e){var t=e.context,n=t.initialized,i=t.attachSupportInitialized;if(n&&!i){var r=t.movingShapes,o=(0,l.filter)(r,function(e){var t=e.host;return t&&-1===r.indexOf(t)});(0,l.forEach)(o,function(e){(0,Sn.remove)(r,e),(0,l.forEach)(e.labels,function(t){(0,Sn.remove)(r,e.label)})}),t.attachSupportInitialized=!0}})}function c_(e){return(0,l.flatten)((0,l.map)(e,function(e){return e.attachers||[]}))}(0,t_.default)(s_,n_.default),s_.$inject=["injector","eventBus","canvas","rules","modeling"];var u_={};Object.defineProperty(u_,"__esModule",{value:!0});var l_=p_(Ou),d_=p_(e_);function p_(e){return e&&e.__esModule?e:{default:e}}u_.default={__depends__:[l_.default],__init__:["attachSupport"],attachSupport:["type",d_.default]};var f_={};Object.defineProperty(f_,"__esModule",{value:!0}),f_.default=__;var h_=y_(u),m_=y_(ds);function y_(e){return e&&e.__esModule?e:{default:e}}var v_=250,g_=1400;function __(e,t,n){m_.default.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",g_,function(e){var t=e.context,n=t.shapes,i=t.validatedShapes;t.shapes=x_(n),t.validatedShapes=x_(i)}),i&&t.on("shape.move.start",v_,function(e){var t=e.context,n=t.shapes,r=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(n){n.hidden||-1!==t.shapes.indexOf(n)||r.push(n),e.labelTarget&&r.push(e)})}),(0,l.forEach)(r,function(e){i.makeDraggable(t,e,!0)})}),this.preExecuted("elements.move",g_,function(e){var t=e.context.closure,n=t.enclosedElements,i=[];(0,l.forEach)(n,function(e){(0,l.forEach)(e.labels,function(e){n[e.id]||i.push(e)})}),t.addAll(i)}),this.preExecute(["connection.delete","shape.delete"],function(e){var t=e.context,i=t.connection||t.shape;(0,Cf.saveClear)(i.labels,function(e){n.removeShape(e,{nested:!0})})}),this.execute("shape.delete",function(e){var t=e.context,n=t.shape,i=n.labelTarget;i&&(t.labelTargetIndex=(0,Sn.indexOf)(i.labels,n),t.labelTarget=i,n.labelTarget=null)}),this.revert("shape.delete",function(e){var t=e.context,n=t.shape,i=t.labelTarget,r=t.labelTargetIndex;i&&((0,Sn.add)(i.labels,n,r),n.labelTarget=i)})}function x_(e){return(0,l.filter)(e,function(t){return-1===e.indexOf(t.labelTarget)})}(0,h_.default)(__,m_.default),__.$inject=["injector","eventBus","modeling"];var b_={};Object.defineProperty(b_,"__esModule",{value:!0});var w_=function(e){return e&&e.__esModule?e:{default:e}}(f_);b_.default={__init__:["labelSupport"],labelSupport:["type",w_.default]};var E_={};function M_(e){return(0,l.assign)({original:e.point.original||e.point},e.actual)}function S_(e,t){this._elementRegistry=e,this._graphicsFactory=t}Object.defineProperty(E_,"__esModule",{value:!0}),E_.default=S_,S_.$inject=["elementRegistry","graphicsFactory"],S_.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),r=this.getDockingPoint(e,n),o=e.waypoints.slice(i.idx+1,r.idx);return o.unshift(M_(i)),o.push(M_(r)),o},S_.prototype.getDockingPoint=function(e,t,n){var i,r,o=e.waypoints;return{point:r=o[i=n?0:o.length-1],actual:this._getIntersection(t,e,n)||r,idx:i}},S_.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),r=this._getConnectionPath(t);return(0,dc.getElementLineIntersection)(i,r,n)},S_.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)},S_.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)},S_.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};var C_={__init__:["modeling","cmmnUpdater"],__depends__:[Sv,Lv,cg,Jg,ud.default,wa.default,b_.default,u_.default,fd.default],cmmnFactory:["type",bd],cmmnUpdater:["type",tp],elementFactory:["type",dp],modeling:["type",Vh],layouter:["type",Vd],connectionDocking:["type",E_.default]},P_=ua.default,R_=e.isCasePlanModel,k_=we.attr;function T_(e,t,n){P_.call(this,e,t,n)}u(T_,P_),T_.$inject=["eventBus","styles","elementRegistry"],T_.prototype.baseUpdateShapeOutline=P_.prototype.updateShapeOutline,T_.prototype.updateShapeOutline=function(e,t){R_(t)?k_(e,{x:-this.offset,y:-this.offset-18,width:t.width+2*this.offset,height:t.height+18+2*this.offset}):this.baseUpdateShapeOutline(e,t)};var A_={__init__:["outline"],outline:["type",T_]},O_=l.assign;function j_(e,t,n,i,r,o,a){this._create=e,this._elementFactory=t,this._globalConnect=n,this._handTool=i,this._palette=o,this._lassoTool=r,this._spaceTool=a,o.registerProvider(this)}var N_=j_;j_.$inject=["create","elementFactory","globalConnect","handTool","lassoTool","palette","spaceTool"],j_.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,r=this._spaceTool,o=this._lassoTool,a=this._globalConnect,s=this._handTool;function c(e,t,r,o){function a(t){n.start(t,i.createPlanItemShape(e))}var s=e.replace(/^cmmn:/,"");return{group:t,className:r,title:o||"Create "+s,action:{dragstart:a,click:a}}}function u(e){n.start(e,i.createCasePlanModelShape())}function l(e){n.start(e,i.createCriterionShape("cmmn:EntryCriterion"))}function d(e){n.start(e,i.createCaseFileItemShape())}return O_(t,{"hand-tool":{group:"tools",className:"cmmn-icon-hand-tool",title:"Activate the hand tool",action:{click:function(e){s.activateHand(e)}}},"lasso-tool":{group:"tools",className:"cmmn-icon-lasso-tool",title:"Activate the lasso tool",action:{click:function(e){o.activateSelection(e)}}},"space-tool":{group:"tools",className:"cmmn-icon-space-tool",title:"Activate the create/remove space tool",action:{click:function(e){r.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"cmmn-icon-connection",title:"Activate the global connect tool",action:{click:function(e){a.toggle(e)}}},"tool-separator":{group:"tools",separator:!0},"create.task":c("cmmn:Task","planItem","cmmn-icon-task"),"create.stage":c("cmmn:Stage","planItem","cmmn-icon-stage-expanded","Create expanded Stage"),"create.milestone":c("cmmn:Milestone","planItem","cmmn-icon-milestone"),"create.eventListener":c("cmmn:EventListener","planItem","cmmn-icon-event-listener"),"create.criterion":{group:"criterion",className:"cmmn-icon-entry-criterion",title:"Create Criterion",action:{dragstart:l,click:l}},"create.casePlanModel":{group:"casePlanModel",className:"cmmn-icon-case-plan-model",title:"Create CasePlanModel",action:{dragstart:u,click:u}},"create.caseFileItem":{group:"caseFileItem",className:"cmmn-icon-case-file-item",title:"Create Case File Item",action:{dragstart:d,click:d}}}),t};var I_={};Object.defineProperty(I_,"__esModule",{value:!0}),I_.default=L_;var D_="connect-ok",B_="connect-not-ok";function L_(e,t,n,i,r,o){var a=this;this._dragging=t,this._rules=o,r.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(e){var t=e.context,n=e.hover,r=t.canStartConnect=a.canStartConnect(n);null!==r&&(t.startTarget=n,i.addMarker(n,r?D_:B_))}),e.on(["global-connect.out","global-connect.cleanup"],function(e){var t=e.context.startTarget,n=e.context.canStartConnect;t&&i.removeMarker(t,n?D_:B_)}),e.on(["global-connect.ended"],function(t){var i=t.context.startTarget,r={x:t.x,y:t.y};if(a.canStartConnect(i))return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,i,r)}),!1})}L_.$inject=["eventBus","dragging","connect","canvas","toolManager","rules"],L_.prototype.start=function(e){this._dragging.init(e,"global-connect",{trapClick:!1,data:{context:{}}})},L_.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.start()},L_.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)},L_.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};var z_={};Object.defineProperty(z_,"__esModule",{value:!0}),z_.default=F_;function F_(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}F_.$inject=["eventBus","dragging"],F_.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error('A tool has to be registered with it\'s "events"');n.push(e),this.bindEvents(e,t)},F_.prototype.isActive=function(e){return e&&this._active===e},F_.prototype.length=function(e){return this._tools.length},F_.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))},F_.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,r=[];n.on(t.tool+".init",function(t){if(!t.context.reactivate&&this.isActive(e))return this.setActive(null),void i.cancel();this.setActive(e)},this),(0,l.forEach)(t,function(e){r.push(e+".ended"),r.push(e+".canceled")}),n.on(r,250,function(e){var t=e.originalEvent;this._active&&(t&&(0,at.closest)(t.target,'.group[data-group="tools"]')||this.setActive(null))},this)};var $_={};Object.defineProperty($_,"__esModule",{value:!0});var H_=V_(Su),U_=V_(z_);function V_(e){return e&&e.__esModule?e:{default:e}}$_.default={__depends__:[H_.default],__init__:["toolManager"],toolManager:["type",U_.default]};var W_={};Object.defineProperty(W_,"__esModule",{value:!0});var G_=Z_(Nu),q_=Z_(Ou),K_=Z_(Su),Y_=Z_($_),X_=Z_(I_);function Z_(e){return e&&e.__esModule?e:{default:e}}W_.default={__depends__:[G_.default,q_.default,K_.default,Y_.default],globalConnect:["type",X_.default]};var Q_={};Object.defineProperty(Q_,"__esModule",{value:!0});var J_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Q_.default=tx;var ex=1500;function tx(e,t,n,i,r){this._dragging=n;var o=this,a=i.get("keyboard",!1);r.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",ex,function(e){if((0,ta.hasPrimaryModifier)(e))return this.activateMove(e.originalEvent),!1},this),a&&a.addListener(ex,function(e){function t(e){o.activateMove(e),window.removeEventListener("mousemove",t)}nx(e.keyEvent)&&(o.isActive()||(window.addEventListener("mousemove",t),a.addListener(ex,function e(i){nx(i.keyEvent)&&(window.removeEventListener("mousemove",t),a.removeListener(e,"keyboard.keyup"),n.cancel())},"keyboard.keyup")))},"keyboard.keydown"),e.on("hand.end",function(t){var n=t.originalEvent.target;if(!(t.hover||n instanceof SVGElement))return!1;e.once("hand.ended",function(){this.activateMove(t.originalEvent,{reactivate:!0})},this)},this),e.on("hand.move.move",function(e){var n=t.viewbox().scale;t.scroll({dx:e.dx*n,dy:e.dy*n})}),e.on("hand.move.end",function(t){var n=t.context.reactivate;return!(0,ta.hasPrimaryModifier)(t)&&n&&e.once("hand.move.ended",function(e){this.activateHand(e.originalEvent,!0,!0)},this),!1},this)}function nx(e){return(0,gl.isKey)(" ",e)}tx.$inject=["eventBus","canvas","dragging","injector","toolManager"],tx.prototype.activateMove=function(e,t,n){"object"===(void 0===t?"undefined":J_(t))&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:"grab",data:{context:n||{}}})},tx.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:"grab",data:{context:{reactivate:n}}})},tx.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateHand()},tx.prototype.isActive=function(){var e=this._dragging.context();return!!e&&/^(hand|hand\.move)$/.test(e.prefix)};var ix={};Object.defineProperty(ix,"__esModule",{value:!0});var rx=ax($_),ox=ax(Q_);function ax(e){return e&&e.__esModule?e:{default:e}}ix.default={__depends__:[rx.default],__init__:["handTool"],handTool:["type",ox.default]};var sx={};Object.defineProperty(sx,"__esModule",{value:!0}),sx.default=cx;function cx(e,t,n,i,r,o){this._selection=r,this._dragging=n;var a=this,s=function(e){var n,i=t.getDefaultLayer();n=e.frame=(0,we.create)("rect"),(0,we.attr)(n,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),(0,we.append)(i,n)},c=function(e){var t=e.frame,n=e.bbox;(0,we.attr)(t,{x:n.x,y:n.y,width:n.width,height:n.height})},u=function(e){e.frame&&(0,we.remove)(e.frame)};o.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("lasso.selection.ended",function(){a.activateLasso(t.originalEvent,!0)})}),e.on("lasso.end",function(e){var t=ux(e),n=i.filter(function(e){return e});a.select(n,t)}),e.on("lasso.start",function(e){var t=e.context;t.bbox=ux(e),s(t)}),e.on("lasso.move",function(e){var t=e.context;t.bbox=ux(e),c(t)}),e.on("lasso.cleanup",function(e){var t=e.context;u(t)}),e.on("element.mousedown",1500,function(e){if((0,ta.hasSecondaryModifier)(e))return a.activateLasso(e.originalEvent),!0})}function ux(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y};return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?{x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?{x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?{x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}cx.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],cx.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:"crosshair",data:{context:{}}})},cx.prototype.activateSelection=function(e){this._dragging.init(e,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},cx.prototype.select=function(e,t){var n=(0,kr.getEnclosedElements)(e,t);this._selection.select((0,l.values)(n))},cx.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},cx.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};var lx={};Object.defineProperty(lx,"__esModule",{value:!0});var dx=fx($_),px=fx(sx);function fx(e){return e&&e.__esModule?e:{default:e}}lx.default={__depends__:[dx.default],__init__:["lassoTool"],lassoTool:["type",px.default]};var hx={};Object.defineProperty(hx,"__esModule",{value:!0}),hx.default=mx;function mx(e,t){this._eventBus=e,this._canvas=t,this._providers=[];var n=this;e.on("tool-manager.update",function(e){var t=e.tool;n.updateToolHighlight(t)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._providers.length&&(n._init(),n._update())})}mx.$inject=["eventBus","canvas"],mx.prototype.registerProvider=function(e){this._providers.push(e),this._diagramInitialized&&(this._container||this._init(),this._update())},mx.prototype.getEntries=function(){var e={};return(0,l.forEach)(this._providers,function(t){var n=t.getPaletteEntries();(0,l.forEach)(n,function(t,n){e[n]=t})}),e},mx.prototype._init=function(){var e=this._canvas,t=this._eventBus,n=e.getContainer(),i=this._container=(0,at.domify)(mx.HTML_MARKUP),r=this;n.appendChild(i),at.delegate.bind(i,".djs-palette-toggle, .entry","click",function(e){var t=e.delegateTarget;if((0,at.matches)(t,".djs-palette-toggle"))return r.toggle();r.trigger("click",e)}),at.event.bind(i,"mousedown",function(e){e.stopPropagation()}),at.delegate.bind(i,".entry","dragstart",function(e){r.trigger("dragstart",e)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})},mx.prototype._toggleState=function(e){e=e||{};var t,n=this._getParentContainer(),i=this._container,r=this._eventBus,o=(0,at.classes)(i);t="twoColumn"in e?e.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),o.toggle("two-column",t),"open"in e&&o.toggle("open",e.open),r.fire("palette.changed",{twoColumn:t,open:this.isOpen()})},mx.prototype._update=function(){var e=(0,at.query)(".djs-palette-entries",this._container),t=this._entries=this.getEntries();(0,at.clear)(e),(0,l.forEach)(t,function(t,n){var i=t.group||"default",r=(0,at.query)("[data-group="+i+"]",e);r||(r=(0,at.domify)('<div class="group" data-group="'+i+'"></div>'),e.appendChild(r));var o,a,s,c=t.html||(t.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),u=(0,at.domify)(c);r.appendChild(u),t.separator||((0,at.attr)(u,"data-action",n),t.title&&(0,at.attr)(u,"title",t.title),t.className&&(o=u,a=t.className,s=(0,at.classes)(o),((0,l.isArray)(a)?a:a.split(/\s+/g)).forEach(function(e){s.add(e)})),t.imageUrl&&u.appendChild((0,at.domify)('<img src="'+t.imageUrl+'">')))}),this.open()},mx.prototype.trigger=function(e,t,n){var i,r,o,a=this._entries,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();(i=a[(0,at.attr)(s,"data-action")])&&(r=i.action,o=t.originalEvent||t,(0,l.isFunction)(r)?"click"===e&&r(o,n):r[e]&&r[e](o,n),t.preventDefault())},mx.prototype._layoutChanged=function(){this._toggleState({})},mx.prototype._needsCollapse=function(e,t){return e<46*Object.keys(t).length+50},mx.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},mx.prototype.open=function(){this._toggleState({open:!0})},mx.prototype.toggle=function(e){this.isOpen()?this.close():this.open()},mx.prototype.isActiveTool=function(e){return e&&this._activeTool===e},mx.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=(0,at.query)(".djs-palette-entries",this._container),this._toolsContainer=(0,at.query)("[data-group=tools]",t)),n=this._toolsContainer,(0,l.forEach)(n.children,function(t){var n=t.getAttribute("data-action");if(n){var i=(0,at.classes)(t);n=n.replace("-tool",""),i.contains("entry")&&n===e?i.add("highlighted-entry"):i.remove("highlighted-entry")}})},mx.prototype.isOpen=function(){return(0,at.classes)(this._container).has("open")},mx.prototype._getParentContainer=function(){return this._canvas.getContainer()},mx.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var yx={};Object.defineProperty(yx,"__esModule",{value:!0});var vx=function(e){return e&&e.__esModule?e:{default:e}}(hx);yx.default={__init__:["palette"],palette:["type",vx.default]};var gx={};Object.defineProperty(gx,"__esModule",{value:!0}),gx.default=bx;var _x=["marker-start","marker-mid","marker-end"],xx=["circle","ellipse","line","path","polygon","polyline","rect"];function bx(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var r=this;t.on("drag.cleanup",function(){(0,l.forEach)(r._clonedMarkers,function(e){(0,we.remove)(e)}),r._clonedMarkers={}})}bx.$inject=["elementRegistry","eventBus","canvas","styles"],bx.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)},bx.prototype.addDragger=function(e,t){var n=this.getGfx(e),i=(0,we.clone)(n),r=n.getBoundingClientRect();return this._cloneMarkers((0,Jr.getVisual)(i)),(0,we.attr)(i,this._styles.cls("djs-dragger",[],{x:r.top,y:r.left})),(0,we.append)(t,i),i},bx.prototype.addFrame=function(e,t){var n=(0,we.create)("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return(0,we.append)(t,n),n},bx.prototype._cloneMarkers=function(e){var t,n=this;if(e.childNodes)for(var i=0;i<e.childNodes.length;i++)n._cloneMarkers(e.childNodes[i]);(t=e,-1!==xx.indexOf(t.nodeName))&&_x.forEach(function(t){if((0,we.attr)(e,t)){var i=function(e,t,n){var i=(r=(0,we.attr)(e,t),r.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]);var r;return(0,at.query)("marker#"+i,n||document)}(e,t,n._canvas.getContainer());n._cloneMarker(e,i,t)}})},bx.prototype._cloneMarker=function(e,t,n){var i=t.id,r=this._clonedMarkers[i];if(!r){var o=i+"-clone";(r=(0,we.clone)(t)).id=o,(0,we.classes)(r).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=r;var a=(0,at.query)("defs",this._canvas._svg);a||(a=(0,we.create)("defs"),(0,we.append)(this._canvas._svg,a)),(0,we.append)(a,r)}var s="url(#"+this._clonedMarkers[i].id+")";(0,we.attr)(e,n,s)};var wx={};Object.defineProperty(wx,"__esModule",{value:!0});var Ex=function(e){return e&&e.__esModule?e:{default:e}}(gx);wx.default={__init__:["previewSupport"],previewSupport:["type",Ex.default]};var Mx={};Object.defineProperty(Mx,"__esModule",{value:!0}),Mx.default=Tx;var Sx=Math.abs,Cx=Math.round,Px=1500,Rx={x:"width",y:"height"},kx={x:"y",y:"x"};function Tx(e,t,n,i,r,o){this._canvas=n,this._dragging=t,this._modeling=i,this._rules=r,this._toolManager=o;var a=this;o.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),e.on("spaceTool.selection.end",function(t){var n=t.originalEvent.target;(t.hover||n instanceof SVGElement)&&e.once("spaceTool.selection.ended",function(){a.activateMakeSpace(t.originalEvent)})}),e.on("spaceTool.move",Px,function(e){var t=e.context;t.initialized||(t.initialized=a.initializeMakeSpace(e,t))}),e.on("spaceTool.end",function(t){var n=t.context,i=n.axis,r=n.direction,o=n.movingShapes,s=n.resizingShapes;if(n.initialized){var c={x:Cx(t.dx),y:Cx(t.dy)};c[kx[i]]=0;var u=!0;(0,l.forEach)(s,function(e){("w"===r&&t.x>e.x+e.width||"e"===r&&t.x<e.x||"n"===r&&t.y>e.y+e.height||"s"===r&&t.y<e.y)&&(u=!1)}),u&&a.makeSpace(o,s,c,r),e.once("spaceTool.ended",function(e){a.activateSelection(e.originalEvent,!0,!0)})}})}Tx.$inject=["eventBus","dragging","canvas","modeling","rules","toolManager"],Tx.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{trapClick:!1,cursor:"crosshair",autoActivate:t,data:{context:{reactivate:n}}})},Tx.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:"crosshair",data:{context:{}}})},Tx.prototype.makeSpace=function(e,t,n,i){return this._modeling.createSpace(e,t,n,i)},Tx.prototype.initializeMakeSpace=function(e,t){var n=Sx(e.dx)>Sx(e.dy)?"x":"y",i=e["d"+n],r=e[n]-i;if(Sx(i)<5)return!1;i<0&&(i*=-1),(0,ta.hasPrimaryModifier)(e)&&(i*=-1);var o=this._canvas.getRootElement(),a=(0,kr.selfAndAllChildren)(o,!0),s=this.calculateAdjustments(a,n,i,r);return(0,l.assign)(t,s,{axis:n,direction:(0,rh.getDirection)(n,i)}),(0,Wa.set)("resize-"+("x"===n?"ew":"ns")),!0},Tx.prototype.calculateAdjustments=function(e,t,n,i){var r=[],o=[],a=this._rules;return e.forEach(function(e){var s=e[t],c=s+e[Rx[t]];if(e.parent&&!e.waypoints)return n>0&&s>i?r.push(e):n<0&&c<i?r.push(e):s<i&&c>i&&a.allowed("shape.resize",{shape:e})?o.push(e):void 0}),{movingShapes:r,resizingShapes:o}},Tx.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},Tx.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};var Ax={};Object.defineProperty(Ax,"__esModule",{value:!0}),Ax.default=Dx;var Ox="djs-dragging",jx="djs-resizing",Nx=250,Ix=Math.max;function Dx(e,t,n,i,r){function o(e,t){(0,l.forEach)(e,function(e){r.addDragger(e,t),n.addMarker(e,Ox)})}e.on("spaceTool.selection.start",function(e){var t=n.getLayer("space"),r=e.context,o="M 0,-10000 L 0,10000",a="M -10000,0 L 10000,0",s=(0,we.create)("g");(0,we.attr)(s,i.cls("djs-crosshair-group",["no-events"])),(0,we.append)(t,s);var c=(0,we.create)("path");(0,we.attr)(c,"d",o),(0,we.classes)(c).add("djs-crosshair"),(0,we.append)(s,c);var u=(0,we.create)("path");(0,we.attr)(u,"d",a),(0,we.classes)(u).add("djs-crosshair"),(0,we.append)(s,u),r.crosshairGroup=s}),e.on("spaceTool.selection.move",function(e){var t=e.context.crosshairGroup;(0,Ze.translate)(t,e.x,e.y)}),e.on("spaceTool.selection.cleanup",function(e){var t=e.context.crosshairGroup;t&&(0,we.remove)(t)}),e.on("spaceTool.move",Nx,function(e){var a=e.context,s=a.line,c=a.axis,u=a.movingShapes,d=a.resizingShapes;if(a.initialized){if(!a.dragGroup){var p=n.getLayer("space");s=(0,we.create)("path"),(0,we.attr)(s,"d","M0,0 L0,0"),(0,we.classes)(s).add("djs-crosshair"),(0,we.append)(p,s),a.line=s;var f=(0,we.create)("g");(0,we.attr)(f,i.cls("djs-drag-group",["no-events"])),(0,we.append)(n.getDefaultLayer(),f),o(u,f),o(a.movingConnections=t.filter(function(e){var t=!1;(0,l.forEach)(u,function(n){(0,l.forEach)(n.outgoing,function(n){e===n&&(t=!0)})});var n=!1;(0,l.forEach)(u,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(n=!0)})});var i=!1;(0,l.forEach)(d,function(t){(0,l.forEach)(t.outgoing,function(t){e===t&&(i=!0)})});var r=!1;return(0,l.forEach)(d,function(t){(0,l.forEach)(t.incoming,function(t){e===t&&(r=!0)})}),function(e){return e.waypoints}(e)&&(t||i)&&(n||r)}),f),a.dragGroup=f}if(!a.frameGroup){var h=(0,we.create)("g");(0,we.attr)(h,i.cls("djs-frame-group",["no-events"])),(0,we.append)(n.getDefaultLayer(),h);var m=[];(0,l.forEach)(d,function(e){var t=r.addFrame(e,h),i=t.getBBox();m.push({element:t,initialBounds:i}),n.addMarker(e,jx)}),a.frameGroup=h,a.frames=m}var y={x:"M"+e.x+", -10000 L"+e.x+", 10000",y:"M -10000, "+e.y+" L 10000, "+e.y};(0,we.attr)(s,{path:y[c],display:""});var v={x:e.dx,y:e.dy};v[{x:"y",y:"x"}[a.axis]]=0,(0,Ze.translate)(a.dragGroup,v.x,v.y),(0,l.forEach)(a.frames,function(e){var t,n,i=e.element,r=e.initialBounds;"e"===a.direction?(0,we.attr)(i,{width:Ix(r.width+v.x,5)}):(t=Ix(r.width-v.x,5),(0,we.attr)(i,{width:t,x:r.x+r.width-t})),"s"===a.direction?(0,we.attr)(i,{height:Ix(r.height+v.y,5)}):(n=Ix(r.height-v.y,5),(0,we.attr)(i,{height:n,y:r.y+r.height-n}))})}}),e.on("spaceTool.cleanup",function(e){var t=e.context,i=t.movingShapes,r=t.movingConnections,o=t.resizingShapes,a=t.line,s=t.dragGroup,c=t.frameGroup;(0,l.forEach)(i,function(e){n.removeMarker(e,Ox)}),(0,l.forEach)(r,function(e){n.removeMarker(e,Ox)}),s&&((0,we.remove)(a),(0,we.remove)(s)),(0,l.forEach)(o,function(e){n.removeMarker(e,jx)}),c&&(0,we.remove)(c)})}Dx.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];var Bx={};Object.defineProperty(Bx,"__esModule",{value:!0});var Lx=Vx(Su),zx=Vx(Ou),Fx=Vx($_),$x=Vx(wx),Hx=Vx(Mx),Ux=Vx(Ax);function Vx(e){return e&&e.__esModule?e:{default:e}}Bx.default={__init__:["spaceToolPreview"],__depends__:[Lx.default,zx.default,Fx.default,$x.default],spaceTool:["type",Hx.default],spaceToolPreview:["type",Ux.default]};var Wx={__depends__:[yx.default,nl.default,Bx.default,lx.default,ix.default,W_.default],__init__:["paletteProvider"],paletteProvider:["type",N_]},Gx={};(function(e){"use strict";var t,n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=void 0!==e?e:void 0,n=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,n=String(e),i=n.length,r=-1,o="",a=n.charCodeAt(0);++r<i;)0!=(t=n.charCodeAt(r))?o+=t>=1&&t<=31||127==t||0==r&&t>=48&&t<=57||1==r&&t>=48&&t<=57&&45==a?"\\"+t.toString(16)+" ":(0!=r||1!=i||45!=t)&&(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?n.charAt(r):"\\"+n.charAt(r):o+="";return o};return e.CSS||(e.CSS={}),e.CSS.escape=t,t},"object"==(void 0===Gx?"undefined":i(Gx))?Gx=n(t):n(t)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var qx=ds.default,Kx=l.assign,Yx=l.forEach,Xx=Jr.getVisual,Zx=Ac.isItemCapable,Qx=e.getBusinessObject,Jx=e.getDefinition,eb=at.query,tb=we.append,nb=we.classes,ib=we.create,rb=we.remove,ob=250;function ab(e,t,n,i,r,o){function a(e){return e.visualReplacements||(e.visualReplacements={}),e.visualReplacements}function s(e){var n=e.context,i=n.canExecute||n.allowed;if("attach"===i){var r=n.position||{x:e.x,y:e.y},o=n.shapes||[n.shape],a=n.target;i=t.canReplace(o,a,r,n.source)}return i}function c(e,t){var n=e&&Xx(e);n&&(rb(n),n=ib("g"),nb(n).add("djs-visual"),tb(e,n),o.drawShape(n,t))}function u(t,r,o){Yx(r,function(r){var a=r.oldElementId,s=i.get(a)||t.shape;if(!t.visualReplacements[a]){var u=function(t,i){var r={type:i.newElementType,x:t.x,y:t.y,width:t.width,height:t.height};if(Zx(t)){var o,a=Qx(t),s=Jx(t),c=i.newElementType,u=i.newDefinitionType;u&&(s=e.replacePlanItemDefinition(s,u)),o=e.replaceItemCapable(a,c,s),Kx(r,{businessObject:o})}return n.createShape(r)}(s,r);c(o(s),u),t.visualReplacements[a]=s}})}function l(e,t){var n=e.visualReplacements;Yx(n,function(e,i){c(t(e),e),delete n[i]})}qx.call(this,r),r.on(["shape.move.move","create.move"],ob,function(e){var t=e.context,n=t.dragGroup,i=t.visual,r=s(e),o=r&&r.replacements;a(t);var c=function(e){var t,r;return n?(t='[data-element-id="'+Gx(e.id)+'"]',r=n):i&&(t=".djs-dragger",r=i),r&&eb(t,r)};o&&o.length?u(t,o,c):l(t,c)}),r.on(["bendpoint.move.move","connect.move"],ob,function(e){var t=e.context,n=s(e),r=n&&n.replacements;a(t),r&&r.length&&u(t,r,function(e){return i.getGraphics(e)})}),r.on(["bendpoint.move.cancel","bendpoint.move.cleanup","bendpoint.move.end","bendpoint.move.out","connect.cleanup","connect.end","connect.out"],ob,function(e){l(e.context,function(e){return i.getGraphics(e)})})}ab.$inject=["cmmnReplace","cmmnRules","elementFactory","elementRegistry","eventBus","graphicsFactory"],u(ab,qx);var sb=ab,cb={};Object.defineProperty(cb,"__esModule",{value:!0}),cb.default=fb;var ub=500,lb=1250,db=1500,pb=Math.round;function fb(e,t,n,i,r){function o(e,t,n,i){return r.allowed("elements.move",{shapes:e,delta:t,position:n,target:i})}function a(e,n,i,r){if((0,l.isObject)(i)&&(r=i,i=!1),!n.waypoints&&n.parent){var o=function(e){return{x:e.x+pb(e.width/2),y:e.y+pb(e.height/2)}}(n);return t.init(e,o,"shape.move",{cursor:"grabbing",autoActivate:i,data:{shape:n,context:r||{}}}),!0}}e.on("shape.move.start",db,function(e){var t,n,r=e.context,o=e.shape,a=i.get().slice();-1===a.indexOf(o)&&(a=[o]),t=a,n=(0,l.groupBy)(t,"id"),a=(0,l.filter)(t,function(e){for(;e=e.parent;)if(n[e.id])return!1;return!0}),(0,l.assign)(r,{shapes:a,validatedShapes:a,shape:o})}),e.on("shape.move.start",lb,function(e){var t=e.context,n=t.validatedShapes;if(!(t.canExecute=o(n)))return!1}),e.on("shape.move.move",ub,function(e){var t,n=e.context,i=n.validatedShapes,r=e.hover,a={x:e.dx,y:e.dy};t=o(i,a,{x:e.x,y:e.y},r),n.delta=a,n.canExecute=t,n.target=null!==t?r:null}),e.on("shape.move.end",function(e){var t=e.context,i=t.delta,r=t.canExecute,o="attach"===r,a=t.shapes;if(!1===r)return!1;i.x=pb(i.x),i.y=pb(i.y),0===i.x&&0===i.y||n.moveElements(a,i,t.target,{primaryShape:t.shape,attach:o})}),e.on("element.mousedown",function(e){var t=(0,Zo.getOriginal)(e);if(!t)throw new Error("must supply DOM mousedown event");return a(t,e.element)}),this.start=a}fb.$inject=["eventBus","dragging","modeling","selection","rules"];var hb={};Object.defineProperty(hb,"__esModule",{value:!0}),hb.default=bb;var mb=499,yb="djs-dragging",vb="drop-ok",gb="drop-not-ok",_b="new-parent",xb="attach-ok";function bb(e,t,n,i){function r(e){return function(e){return(0,l.filter)(e,function(t){return!function(e){return e.waypoints}(t)||(0,l.find)(e,(0,l.matchPattern)({id:t.source.id}))&&(0,l.find)(e,(0,l.matchPattern)({id:t.target.id}))})}(o(e))}function o(e){var t=(0,kr.selfAndAllChildren)(e,!0),n=(0,l.map)(t,function(e){return(e.incoming||[]).concat(e.outgoing||[])});return(0,l.flatten)(t.concat(n))}function a(e,n){[xb,vb,gb,_b].forEach(function(i){i===n?t.addMarker(e,i):t.removeMarker(e,i)})}e.on("shape.move.start",mb,function(e){var a,s=e.context,c=s.shapes,u=s.allDraggedElements,d=r(c);if(!s.dragGroup){var p=(0,we.create)("g");(0,we.attr)(p,n.cls("djs-drag-group",["no-events"]));var f=t.getDefaultLayer();(0,we.append)(f,p),s.dragGroup=p}d.forEach(function(e){i.addDragger(e,s.dragGroup)}),u=u?(0,l.flatten)([u,o(c)]):o(c),(0,l.forEach)(u,function(e){t.addMarker(e,yb)}),s.allDraggedElements=u,s.differentParents=(a=c,1!==(0,l.size)((0,l.groupBy)(a,function(e){return e.parent&&e.parent.id})))}),e.on("shape.move.move",mb,function(e){var t=e.context,n=t.dragGroup,i=t.target,r=t.shape.parent,o=t.canExecute;i&&("attach"===o?a(i,xb):t.canExecute&&i&&i.id!==r.id?a(i,_b):a(i,t.canExecute?vb:gb)),(0,Ze.translate)(n,e.dx,e.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(e){var t=e.context.target;t&&a(t,null)}),e.on("shape.move.cleanup",function(e){var n=e.context,i=n.allDraggedElements,r=n.dragGroup;(0,l.forEach)(i,function(e){t.removeMarker(e,yb)}),r&&(0,we.remove)(r)}),this.makeDraggable=function(e,n,r){i.addDragger(n,e.dragGroup),r&&t.addMarker(n,yb),e.allDraggedElements?e.allDraggedElements.push(n):e.allDraggedElements=[n]}}bb.$inject=["eventBus","canvas","styles","previewSupport"];var wb={};Object.defineProperty(wb,"__esModule",{value:!0});var Eb=Ab(sa),Mb=Ab(wa),Sb=Ab(pa),Cb=Ab(Ou),Pb=Ab(Su),Rb=Ab(wx),kb=Ab(cb),Tb=Ab(hb);function Ab(e){return e&&e.__esModule?e:{default:e}}wb.default={__depends__:[Eb.default,Mb.default,Sb.default,Cb.default,Pb.default,Rb.default],__init__:["move","movePreview"],move:["type",kb.default],movePreview:["type",Tb.default]};var Ob={__depends__:[wb.default],__init__:["cmmnReplacePreview"],cmmnReplacePreview:["type",sb]},jb=l.map,Nb=l.filter,Ib=l.sortBy;function Db(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}var Bb=Db;function Lb(e){return Nb(e,function(e){return!!e.matched}).length>0}function zb(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var r=e.indexOf(t);return r>-1?(0!==r&&n.push({normal:i.substr(0,r)}),n.push({matched:i.substr(r,t.length)}),t.length+r<e.length&&n.push({normal:i.substr(t.length+r,e.length)})):n.push({normal:i}),n}Db.$inject=["elementRegistry","searchPad","canvas"],Db.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(e){return!e.labelTarget});return n=Nb(n,function(e){return e!==t}),n=jb(n,function(t){return{primaryTokens:zb(Ol.getLabel(t),e),secondaryTokens:zb(t.id,e),element:t}}),n=Nb(n,function(e){return Lb(e.primaryTokens)||Lb(e.secondaryTokens)}),n=Ib(n,function(e){return Ol.getLabel(e.element)+e.element.id})};var Fb={};Object.defineProperty(Fb,"__esModule",{value:!0}),Object.defineProperty(Fb,"escapeCSS",{enumerable:!0,get:function(){return(e=Gx,e&&e.__esModule?e:{default:e}).default;var e}}),Fb.escapeHTML=function(e){return(e=""+e)&&e.replace(/[&<>"']/g,function(e){return $b[e]})};var $b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var Hb={};function Ub(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=(0,at.domify)(Ub.BOX_HTML),this._searchInput=(0,at.query)(Ub.INPUT_SELECTOR,this._container),this._resultsContainer=(0,at.query)(Ub.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}function Vb(e,t,n){var i=function(e){var t="";return e.forEach(function(e){e.matched?t+='<strong class="'+Ub.RESULT_HIGHLIGHT_CLASS+'">'+(0,Fb.escapeHTML)(e.matched)+"</strong>":t+=(0,Fb.escapeHTML)(e.normal)}),""!==t?t:null}(t),r=(0,at.domify)(n);r.innerHTML=i,e.appendChild(r)}Object.defineProperty(Hb,"__esModule",{value:!0}),Hb.default=Ub,Ub.$inject=["canvas","eventBus","overlays","selection"],Ub.prototype._bindEvents=function(){var e=this;function t(t,n,i,r){e._eventMaps.push({el:t,type:i,listener:at.delegate.bind(t,n,i,r)})}t(document,"html","click",function(t){e.close()}),t(this._container,Ub.INPUT_SELECTOR,"click",function(e){e.stopPropagation(),e.delegateTarget.focus()}),t(this._container,Ub.RESULT_SELECTOR,"mouseover",function(t){t.stopPropagation(),e._scrollToNode(t.delegateTarget),e._preselect(t.delegateTarget)}),t(this._container,Ub.RESULT_SELECTOR,"click",function(t){t.stopPropagation(),e._select(t.delegateTarget)}),t(this._container,Ub.INPUT_SELECTOR,"keydown",function(e){38===e.keyCode&&e.preventDefault(),40===e.keyCode&&e.preventDefault()}),t(this._container,Ub.INPUT_SELECTOR,"keyup",function(t){if(27===t.keyCode)return e.close();if(13===t.keyCode){var n=e._getCurrentResult();return n?e._select(n):e.close()}return 38===t.keyCode?e._scrollToDirection(!0):40===t.keyCode?e._scrollToDirection():void(37!==t.keyCode&&39!==t.keyCode&&e._search(t.delegateTarget.value))})},Ub.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){at.delegate.unbind(e.el,e.type,e.listener)})},Ub.prototype._search=function(e){var t=this;if(this._clearResults(),e&&""!==e){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(e){var n=e.element.id,i=t._createResultNode(e,n);t._results[n]={element:e.element,node:i}});var i=(0,at.query)(Ub.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}},Ub.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}},Ub.prototype._scrollToNode=function(e){if(e&&e!==this._getCurrentResult()){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}},Ub.prototype._clearResults=function(){(0,at.clear)(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")},Ub.prototype._getCurrentResult=function(){return(0,at.query)(Ub.RESULT_SELECTED_SELECTOR,this._resultsContainer)},Ub.prototype._createResultNode=function(e,t){var n=(0,at.domify)(Ub.RESULT_HTML);return e.primaryTokens.length>0&&Vb(n,e.primaryTokens,Ub.RESULT_PRIMARY_HTML),Vb(n,e.secondaryTokens,Ub.RESULT_SECONDARY_HTML),(0,at.attr)(n,Ub.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n},Ub.prototype.registerProvider=function(e){this._searchProvider=e},Ub.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,(0,at.classes)(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))},Ub.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,(0,at.classes)(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))},Ub.prototype.toggle=function(){this.isOpen()?this.close():this.open()},Ub.prototype.isOpen=function(){return this._open},Ub.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&(0,at.classes)(t).remove(Ub.RESULT_SELECTED_CLASS);var n=(0,at.attr)(e,Ub.RESULT_ID_ATTRIBUTE),i=this._results[n].element;(0,at.classes)(e).add(Ub.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._centerViewbox(i),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}},Ub.prototype._select=function(e){var t=(0,at.attr)(e,Ub.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._centerViewbox(n),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)},Ub.prototype._centerViewbox=function(e){var t=this._canvas.viewbox(),n=(0,kr.getBBox)(e),i={x:n.x+n.width/2-t.outer.width/2,y:n.y+n.height/2-t.outer.height/2,width:t.outer.width,height:t.outer.height};this._canvas.viewbox(i),this._canvas.zoom(t.scale)},Ub.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=function(e){var t=e.width+12,n=e.height+12,i=["width: "+t+"px","height: "+n+"px"].join("; ");return{position:{bottom:n-6,right:t-6},show:!0,html:'<div style="'+i+'" class="'+Ub.OVERLAY_CLASS+'"></div>'}}((0,kr.getBBox)(e));this._overlayId=this._overlays.add(e,t)}},Ub.CONTAINER_SELECTOR=".djs-search-container",Ub.INPUT_SELECTOR=".djs-search-input input",Ub.RESULTS_CONTAINER_SELECTOR=".djs-search-results",Ub.RESULT_SELECTOR=".djs-search-result",Ub.RESULT_SELECTED_CLASS="djs-search-result-selected",Ub.RESULT_SELECTED_SELECTOR="."+Ub.RESULT_SELECTED_CLASS,Ub.RESULT_ID_ATTRIBUTE="data-result-id",Ub.RESULT_HIGHLIGHT_CLASS="djs-search-highlight",Ub.OVERLAY_CLASS="djs-search-overlay",Ub.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>',Ub.RESULT_HTML='<div class="djs-search-result"></div>',Ub.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>',Ub.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';var Wb={};Object.defineProperty(Wb,"__esModule",{value:!0});var Gb=Yb(Yo),qb=Yb(wa),Kb=Yb(Hb);function Yb(e){return e&&e.__esModule?e:{default:e}}Wb.default={__depends__:[Gb.default,qb.default],searchPad:["type",Kb.default]};var Xb={__depends__:[Wb.default],__init__:["cmmnSearch"],cmmnSearch:["type",Bb]},Zb={};Object.defineProperty(Zb,"__esModule",{value:!0}),Zb.snapTo=function(e,t,n){var i,r;for(n=void 0===n?10:n,i=0;i<t.length;i++)if(r=t[i],Qb(r-e)<=n)return r},Zb.topLeft=function(e){return{x:e.x,y:e.y}},Zb.topRight=function(e){return{x:e.x+e.width,y:e.y}},Zb.bottomLeft=function(e){return{x:e.x,y:e.y+e.height}},Zb.bottomRight=function(e){return{x:e.x+e.width,y:e.y+e.height}},Zb.mid=function(e,t){if(!e||isNaN(e.x)||isNaN(e.y))return t;return{x:Jb(e.x+e.width/2),y:Jb(e.y+e.height/2)}},Zb.isSnapped=function(e,t){var n=e.snapped;if(!n)return!1;if("string"==typeof t)return n[t];return n.x&&n.y},Zb.setSnapped=function(e,t,n){if("string"!=typeof t)throw new Error("axis must be in [x, y]");if("number"!=typeof n&&!1!==n)throw new Error("value must be Number or false");var i,r=e[t],o=e.snapped=e.snapped||{};!1===n?o[t]=!1:(o[t]=!0,i=n-r,e[t]+=i,e["d"+t]+=i);return r},Zb.getChildren=function(e){return e.children||[]};var Qb=Math.abs,Jb=Math.round;var ew=Zb.mid,tw=Zb.setSnapped,nw=gl.isCmd,iw=e.is,rw=e.getDefinition,ow=e.getBusinessObject,aw=1250;function sw(e,t){e.on(["connect.hover","connect.move","connect.end"],aw,function(e){var n=e.context,i=n.source,r=n.target;if(n.canExecute&&(!e.originalEvent||!nw(e.originalEvent))){n.initialSourcePosition||(n.initialSourcePosition=n.sourcePosition);var o=t.allowed("connection.create",{source:i,target:r});o&&uw(i)&&(n.sourcePosition=ew(i)),o&&uw(r)&&function(e,t){tw(e,"x",t.x),tw(e,"y",t.y)}(e,ew(r))}})}sw.$inject=["eventBus","rules"];var cw=sw;function uw(e){if(!e)return!1;if(iw(e,"cmmn:Stage"))return!1;var t=ow(e),n=rw(e)||e;if(!iw(n,"cmmn:PlanFragment"))return!0;var i=t.di;return!(!i||!0!==i.isCollapsed)}var lw={};function dw(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}function pw(e){this._snapValues={}}Object.defineProperty(lw,"__esModule",{value:!0}),lw.default=dw,lw.SnapPoints=pw,dw.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]},dw.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,-1===this._snapLocations.indexOf(e)&&this._snapLocations.push(e)},dw.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)},dw.prototype.getSnapLocations=function(){return this._snapLocations},dw.prototype.setSnapLocations=function(e){this._snapLocations=e},dw.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new pw).initDefaults(this._defaultSnaps),n},pw.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),-1===n.x.indexOf(t.x)&&n.x.push(t.x),-1===n.y.indexOf(t.y)&&n.y.push(t.y)},pw.prototype.snap=function(e,t,n,i){var r=this._snapValues[t];return r&&(0,Zb.snapTo)(e[n],r[n],i)},pw.prototype.initDefaults=function(e){var t=this;(0,l.forEach)(e||{},function(e,n){(0,l.forEach)(e,function(e){t.add(n,e)})})};var fw={};Object.defineProperty(fw,"__esModule",{value:!0}),fw.default=yw;var hw=function(e){return e&&e.__esModule?e:{default:e}}(lw);var mw=1250;function yw(e,t){var n=this;e.on(["create.start","shape.move.start"],function(e){n.initSnap(e)}),e.on(["create.move","create.end","shape.move.move","shape.move.end"],mw,function(e){var i=e.context,r=i.shape,o=i.snapContext,a=i.target;if((!e.originalEvent||!(0,gl.isCmd)(e.originalEvent))&&!(0,Zb.isSnapped)(e)&&a){var s=o.pointsForTarget(a);s.initialized||((s=n.addSnapTargetPoints(s,r,a)).initialized=!0),t.snap(e,s)}}),e.on(["create.cleanup","shape.move.cleanup"],function(){t.hide()})}function vw(e){return!!e.labelTarget}yw.$inject=["eventBus","snapping"],yw.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.snapContext;i||(i=t.snapContext=new hw.default);var r=(0,Zb.mid)(n,e),o=r.x-n.width/2,a=r.y-n.height/2,s=r.x+n.width/2,c=r.y+n.height/2;return i.setSnapOrigin("mid",{x:r.x-e.x,y:r.y-e.y}),vw(n)?i:(i.setSnapOrigin("top-left",{x:o-e.x,y:a-e.y}),i.setSnapOrigin("bottom-right",{x:s-e.x,y:c-e.y}),i)},yw.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return(0,l.forEach)(i,function(n){if(vw(n))vw(t)&&e.add("mid",(0,Zb.mid)(n));else if(n.waypoints){if(n.waypoints.length<3)return;var i=n.waypoints.slice(1,-1);(0,l.forEach)(i,function(t){e.add("mid",t)})}else{e.add("mid",(0,Zb.mid)(n))}}),(0,l.isNumber)(t.x)&&(0,l.isNumber)(t.y)?(e.add("mid",(0,Zb.mid)(t)),e):e},yw.prototype.getSnapTargets=function(e,t){return(0,Zb.getChildren)(t).filter(function(e){return!e.hidden})};var gw=fw.default,_w=Zb.isSnapped,xw=Zb.setSnapped,bw=dc.asTRBL,ww=dc.getMid,Ew=ug.getCriterionAttachment,Mw=l.forEach;function Sw(e,t,n){n.invoke(gw,this),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,function(e){var n=e.context,i=n.target,r=n.shape;i&&!_w(e)&&function(e,n,i){return"attach"===t.canAttach([e],n,null,i)}(r,i,e)&&function(e,t,n){var i=bw(n),r=Ew(e,n);/top/.test(r)?xw(e,"y",i.top):/bottom/.test(r)&&xw(e,"y",i.bottom);/left/.test(r)?xw(e,"x",i.left):/right/.test(r)&&xw(e,"x",i.right)}(e,0,i)})}u(Sw,gw),Sw.$inject=["eventBus","cmmnRules","injector"];var Cw=Sw;function Pw(e,t){return-1!==e.indexOf(t)}Sw.prototype.initSnap=function(e){var t=gw.prototype.initSnap.call(this,e),n=e.shape;return Mw(n.outgoing,function(n){var i=n.waypoints[0];i=i.original||i,t.setSnapOrigin(n.id+"-docking",{x:i.x-e.x,y:i.y-e.y})}),Mw(n.incoming,function(n){var i=n.waypoints[n.waypoints.length-1];i=i.original||i,t.setSnapOrigin(n.id+"-docking",{x:i.x-e.x,y:i.y-e.y})}),t},Sw.prototype.addSnapTargetPoints=function(e,t,n){gw.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);return Mw(t.incoming,function(t){Pw(i,t.source)||e.add("mid",ww(t.source));var n=t.waypoints[0];e.add(t.id+"-docking",n.original||n)}),Mw(t.outgoing,function(t){Pw(i,t.target)||e.add("mid",ww(t.target));var n=t.waypoints[t.waypoints.length-1];e.add(t.id+"-docking",n.original||n)}),e};var Rw=e.is,kw=e.getDefinition,Tw=me.isCollapsed,Aw=1001;function Ow(e){e.on("resize.start",Aw+500,function(e){var t=e.context,n=t.shape;Rw(kw(n),"cmmn:PlanFragment")&&!Tw(n)&&(t.minDimensions={width:140,height:120}),Rw(n,"cmmn:TextAnnotation")&&(t.minDimensions={width:50,height:30})})}Ow.$inject=["eventBus","cmmnRules","injector"];var jw=Ow;var Nw={};Object.defineProperty(Nw,"__esModule",{value:!0}),Nw.default=Bw;var Iw=function(e){return e&&e.__esModule?e:{default:e}}(lw);var Dw=1250;function Bw(e,t){var n=this;e.on(["resize.start"],function(e){n.initSnap(e)}),e.on(["resize.move","resize.end"],Dw,function(e){var i=e.context,r=i.shape,o=r.parent,a=i.direction,s=i.snapContext;if(!(e.originalEvent&&(0,gl.isCmd)(e.originalEvent)||(0,Zb.isSnapped)(e))){var c=s.pointsForTarget(o);c.initialized||((c=n.addSnapTargetPoints(c,r,o,a)).initialized=!0),t.snap(e,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}function Lw(e,t){return"nw"===t?(0,Zb.topLeft)(e):"ne"===t?(0,Zb.topRight)(e):"sw"===t?(0,Zb.bottomLeft)(e):(0,Zb.bottomRight)(e)}Bw.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,r=t.snapContext;r||(r=t.snapContext=new Iw.default);var o=Lw(n,i);return r.setSnapOrigin("corner",{x:o.x-e.x,y:o.y-e.y}),r},Bw.prototype.addSnapTargetPoints=function(e,t,n,i){var r=this.getSnapTargets(t,n);return(0,l.forEach)(r,function(t){e.add("corner",(0,Zb.bottomRight)(t)),e.add("corner",(0,Zb.topLeft)(t))}),e.add("corner",Lw(t,i)),e},Bw.$inject=["eventBus","snapping"],Bw.prototype.getSnapTargets=function(e,t){return(0,Zb.getChildren)(t).filter(function(t){return!(n=t,i=e,n.host===i||function(e){return!!e.waypoints}(t)||function(e){return!!e.hidden}(t)||function(e){return!!e.labelTarget}(t));var n,i})};var zw={};Object.defineProperty(zw,"__esModule",{value:!0}),zw.SNAP_LINE_HIDE_DELAY=void 0,zw.default=$w;var Fw=zw.SNAP_LINE_HIDE_DELAY=1e3;function $w(e){this._canvas=e,this._asyncHide=(0,l.debounce)((0,l.bind)(this.hide,this),Fw)}$w.$inject=["canvas"],$w.prototype.snap=function(e,t){var n=e.context.snapContext,i=n.getSnapLocations(),r={x:(0,Zb.isSnapped)(e,"x"),y:(0,Zb.isSnapped)(e,"y")};(0,l.forEach)(i,function(i){var o=n.getSnapOrigin(i),a={x:e.x+o.x,y:e.y+o.y};if((0,l.forEach)(["x","y"],function(e){var n;r[e]||void 0!==(n=t.snap(a,i,e,7))&&(r[e]={value:n,originValue:n-o[e]})}),r.x&&r.y)return!1}),this.showSnapLine("vertical",r.x&&r.x.value),this.showSnapLine("horizontal",r.y&&r.y.value),(0,l.forEach)(["x","y"],function(t){var n=r[t];(0,l.isObject)(n)&&(0,Zb.setSnapped)(e,t,n.originValue)})},$w.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=(0,we.create)("path");return(0,we.attr)(n,{d:"M0,0 L0,0"}),(0,we.classes)(n).add("djs-snap-line"),(0,we.append)(t,n),{update:function(t){(0,l.isNumber)(t)?"horizontal"===e?(0,we.attr)(n,{d:"M-100000,"+t+" L+100000,"+t,display:""}):(0,we.attr)(n,{d:"M "+t+",-100000 L "+t+", +100000",display:""}):(0,we.attr)(n,{display:"none"})}}},$w.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}},$w.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()},$w.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]},$w.prototype.hide=function(){(0,l.forEach)(this._snapLines,function(e){e.update()})};var Hw={};Object.defineProperty(Hw,"__esModule",{value:!0});var Uw=Gw(fw),Vw=Gw(Nw),Ww=Gw(zw);function Gw(e){return e&&e.__esModule?e:{default:e}}Hw.default={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",Uw.default],resizeSnapping:["type",Vw.default],snapping:["type",Ww.default]};var qw={__depends__:[Hw.default],__init__:["connectSnapping","createMoveSnapping","resizeSnapping"],connectSnapping:["type",cw],createMoveSnapping:["type",Cw],resizeSnapping:["type",jw]},Kw={};function Yw(e,t,n,i){this._canvas=n,this._mouseTracking=i,this._opts=(0,l.assign)({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var r=this;t.on("drag.move",function(e){var t=r._toBorderPoint(e);r.startScroll(t)}),t.on(["drag.cleanup"],function(){r.stopScroll()})}function Xw(e,t,n){return t<e&&e<n}Object.defineProperty(Kw,"__esModule",{value:!0}),Kw.default=Yw,Yw.$inject=["config.autoScroll","eventBus","canvas","mouseTracking"],Yw.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,r=t.getContainer().getBoundingClientRect(),o=[e.x,e.y,r.width-e.x,r.height-e.y];this.stopScroll();for(var a=0,s=0,c=0;c<4;c++)Xw(o[c],n.scrollThresholdOut[c],n.scrollThresholdIn[c])&&(0===c?a=n.scrollStep:1==c?s=n.scrollStep:2==c?a=-n.scrollStep:3==c&&(s=-n.scrollStep));0===a&&0===s||(t.scroll({dx:a,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))},Yw.prototype.stopScroll=function(){clearTimeout(this._scrolling)},Yw.prototype.setOptions=function(e){this._opts=(0,l.assign)({},this._opts,e)},Yw.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=(0,Zo.toPoint)(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};var Zw={};function Qw(e,t){this._eventBus=e,this._canvas=t,this._init()}Object.defineProperty(Zw,"__esModule",{value:!0}),Zw.default=Qw,Qw.$inject=["eventBus","canvas"],Qw.prototype.getHoverContext=function(){var e=this._canvas.viewbox();return{element:this._hoverElement,point:{x:e.x+Math.round(this._mouseX/e.scale),y:e.y+Math.round(this._mouseY/e.scale)}}},Qw.prototype._init=function(){var e=this._eventBus,t=this._canvas.getContainer();this._setMousePosition=(0,l.bind)(this._setMousePosition,this),t.addEventListener("mousemove",this._setMousePosition),e.on("diagram.destroy",function(){t.removeEventListener("mousemove",this._setMousePosition)},this),e.on("element.hover",this._setHoverElement,this)},Qw.prototype._setHoverElement=function(e){this._hoverElement=e.element},Qw.prototype._setMousePosition=function(e){this._mouseX=e.layerX,this._mouseY=e.layerY};var Jw={};Object.defineProperty(Jw,"__esModule",{value:!0});var eE=function(e){return e&&e.__esModule?e:{default:e}}(Zw);Jw.default={__init__:["mouseTracking"],mouseTracking:["type",eE.default]};var tE={};Object.defineProperty(tE,"__esModule",{value:!0});var nE=oE(Su),iE=oE(Jw),rE=oE(Kw);function oE(e){return e&&e.__esModule?e:{default:e}}tE.default={__depends__:[nE.default,iE.default],__init__:["autoScroll"],autoScroll:["type",rE.default]};var aE={};Object.defineProperty(aE,"__esModule",{value:!0}),aE.default=dE;var sE="connection.updateWaypoints",cE="connection.reconnectStart",uE="connection.reconnectEnd",lE=Math.round;function dE(e,t,n,i,r,o){var a=e.get("connectionDocking",!1);this.start=function(e,t,o,a){var s,c=t.waypoints,u=n.getGraphics(t);!1!==((s={connection:t,bendpointIndex:o,insert:a,type:a||0!==o?a||o!==c.length-1?sE:uE:cE}).allowed=r.allowed(s.type,s))&&i.init(e,"bendpoint.move",{data:{connection:t,connectionGfx:u,context:s}})},t.on("bendpoint.move.hover",function(e){var t=e.context;(t.hover=e.hover,e.hover)&&((t.allowed=r.allowed(t.type,t))&&(t.target=t.hover))}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(e){var t=e.context;t.target=null,t.allowed=!1}),t.on("bendpoint.move.end",function(e){var t,n,i=e.context,r=i.connection,s=r.waypoints,c=s.slice(),u=i.bendpointIndex,l=i.allowed,d=i.insert;if(t={x:lE(e.x),y:lE(e.y)},l&&i.type===cE)o.reconnectStart(i.connection,i.target,t);else if(l&&i.type===uE)o.reconnectEnd(i.connection,i.target,t);else{if(!1===l||i.type!==sE)return!1;d?c.splice(u,0,t):c[u]=t,n={bendpointMove:{insert:d,bendpointIndex:u}},a&&(r.waypoints=c,r.waypoints=a.getCroppedWaypoints(r),c=r.waypoints,r.waypoints=s),o.updateWaypoints(i.connection,(0,dc.filterRedundantWaypoints)(c),n)}})}dE.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];var pE={};Object.defineProperty(pE,"__esModule",{value:!0}),pE.getApproxIntersection=function(e,t){return function(e,t){var n,i;for(n=0;i=e[n];n++)if((0,ks.pointDistance)(i,t)<=yE)return{point:e[n],bendpoint:!0,index:n};return null}(e,t)||function(e,t){var n,i=(0,fE.default)((c=t,u=yE,l=c.x,d=c.y,[["M",l,d],["m",0,-u],["a",u,u,0,1,1,0,2*u],["a",u,u,0,1,1,0,-2*u],["z"]]),(a=e,s=[],a.forEach(function(e,t){s.push([0===t?"M":"L",e.x,e.y])}),s)),r=i[0],o=i[i.length-1];var a,s;var c,u,l,d;if(!r)return null;if(r!==o)return r.segment2!==o.segment2?(n=mE(r.segment2,o.segment2)-1,{point:e[n],bendpoint:!0,index:n}):{point:{x:hE(r.x+o.x)/2,y:hE(r.y+o.y)/2},index:r.segment2};return{point:{x:hE(r.x),y:hE(r.y)},index:r.segment2}}(e,t)};var fE=function(e){return e&&e.__esModule?e:{default:e}}(lc);var hE=Math.round,mE=Math.max;var yE=10;var vE={};Object.defineProperty(vE,"__esModule",{value:!0}),vE.SEGMENT_DRAGGER_CLS=vE.BENDPOINT_CLS=void 0,vE.getConnectionIntersection=function(e,t,n){var i=xE(e,n);return(0,pE.getApproxIntersection)(t,i)},vE.addBendpoint=function(e,t){var n=(0,we.create)("g");(0,we.classes)(n).add(gE),(0,we.append)(e,n);var i=(0,we.create)("circle");(0,we.attr)(i,{cx:0,cy:0,r:4}),(0,we.classes)(i).add("djs-visual"),(0,we.append)(n,i);var r=(0,we.create)("circle");(0,we.attr)(r,{cx:0,cy:0,r:10}),(0,we.classes)(r).add("djs-hit"),(0,we.append)(n,r),t&&(0,we.classes)(n).add(t);return n},vE.addSegmentDragger=function(e,t,n){var i=(0,we.create)("g"),r=(0,ks.getMidPoint)(t,n),o=(0,ks.pointsAligned)(t,n);return(0,we.append)(e,i),function(e,t,n,i){var r=(0,we.create)("g");(0,we.append)(e,r);var o=function(e,t,n){var i=t.x-e.x,r=t.y-e.y;return bE("h"===n?i:r)}(t,n,i),a=(0,we.create)("rect");(0,we.attr)(a,{x:-7,y:-1.5,width:14,height:3}),(0,we.classes)(a).add("djs-visual"),(0,we.append)(r,a);var s=(0,we.create)("rect");(0,we.attr)(s,{x:-o/2,y:-4.5,width:o,height:9}),(0,we.classes)(s).add("djs-hit"),(0,we.append)(r,s),(0,Ze.rotate)(r,"v"===i?90:0,0,0)}(i,t,n,o),(0,we.classes)(i).add(_E),(0,we.classes)(i).add("h"===o?"horizontal":"vertical"),(0,Ze.translate)(i,r.x,r.y),i},vE.calculateSegmentMoveRegion=bE;var gE=vE.BENDPOINT_CLS="djs-bendpoint",_E=vE.SEGMENT_DRAGGER_CLS="djs-segment-dragger";function xE(e,t){var n,i=(0,Zo.toPoint)(t),r=e._container.getBoundingClientRect();n={x:r.left,y:r.top};var o=e.viewbox();return{x:o.x+(i.x-n.x)/o.scale,y:o.y+(i.y-n.y)/o.scale}}function bE(e){return Math.abs(Math.round(2*e/3))}var wE={};Object.defineProperty(wE,"__esModule",{value:!0}),wE.default=AE;var EE="connect-ok",ME="connect-not-ok",SE="connect-hover",CE="djs-updating",PE="djs-element-hidden",RE="connection.reconnectStart",kE="connection.reconnectEnd",TE=1100;function AE(e,t,n){var i=e.get("connectionPreview",!1),r=e.get("connectionDocking",!1);t.on("bendpoint.move.start",function(e){var t=e.context,i=t.connection,r=i.waypoints,o=r.slice(),a=t.insert,s=t.bendpointIndex;t.originalWaypoints=r,a&&o.splice(s,0,{x:e.x,y:e.y}),i.waypoints=o,t.draggerGfx=(0,vE.addBendpoint)(n.getLayer("overlays")),(0,we.classes)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,CE),n.addMarker(i,PE)}),t.on("bendpoint.move.hover",function(e){var t=e.context,i=t.allowed,r=t.hover;e.hover&&(n.addMarker(r,SE),i?(n.removeMarker(r,ME),n.addMarker(r,EE)):!1===i&&(n.removeMarker(r,EE),n.addMarker(r,ME)))}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],TE,function(e){var t=e.context.hover;t&&(n.removeMarker(t,SE),n.removeMarker(t,e.context.target?EE:ME))}),t.on("bendpoint.move.move",function(e){var t,n=e.context,o=n.type,a=e.connection,s=a.waypoints,c=s.slice(),u={x:e.x,y:e.y};i&&(t={source:a.source,target:a.target},o===RE?(t.source=n.target,t.connectionStart=u):o===kE?(t.target=n.target,t.connectionEnd=u):(t.noCropping=!0,t.noLayout=!0,c[n.bendpointIndex]=u),r&&(a.waypoints=c,a.waypoints=r.getCroppedWaypoints(a),c=a.waypoints,a.waypoints=s),t.waypoints=(0,dc.filterRedundantWaypoints)(c),i.drawPreview(n,n.allowed,t)),(0,Ze.translate)(n.draggerGfx,e.x,e.y)}),t.on(["bendpoint.move.end","bendpoint.move.cancel"],TE,function(e){var t=e.context,r=t.hover,o=t.connection;o.waypoints=t.originalWaypoints,(0,we.remove)(t.draggerGfx),n.removeMarker(o,CE),n.removeMarker(o,PE),r&&(n.removeMarker(r,EE),n.removeMarker(r,t.target?EE:ME)),i&&i.cleanUp(t)})}AE.$inject=["injector","eventBus","canvas"];var OE={};Object.defineProperty(OE,"__esModule",{value:!0}),OE.default=DE;var jE=Math.abs,NE=Math.round,IE=10;function DE(e){function t(e,t){if((0,l.isArray)(e)){for(var n=e.length;n--;)if(jE(e[n]-t)<=IE)return e[n]}else{var i=t%(e=+e);if(i<IE)return t-i;if(i>e-IE)return t-i+e}return t}function n(e){if(e.width)return{x:NE(e.width/2+e.x),y:NE(e.height/2+e.y)}}e.on("connectionSegment.move.move",1500,function(e){var i,r,o=function(e){var t=e.snapPoints,i=e.connection,r=i.waypoints,o=e.segmentStart,a=e.segmentStartIndex,s=e.segmentEnd,c=e.segmentEndIndex,u=e.axis;if(t)return t;var d=[r[a-1],o,s,r[c+1]];return a<2&&d.unshift(n(i.source)),c>r.length-3&&d.unshift(n(i.target)),e.snapPoints=t={horizontal:[],vertical:[]},(0,l.forEach)(d,function(e){e&&(e=e.original||e,"y"===u&&t.horizontal.push(e.y),"x"===u&&t.vertical.push(e.x))}),t}(e.context),a=e.x,s=e.y;if(o){var c=a-(i=t(o.vertical,a)),u=s-(r=t(o.horizontal,s));(0,l.assign)(e,{dx:e.dx-c,dy:e.dy-u,x:i,y:r}),(c||-1!==o.vertical.indexOf(a))&&(0,Zb.setSnapped)(e,"x",i),(u||-1!==o.horizontal.indexOf(s))&&(0,Zb.setSnapped)(e,"y",r)}}),e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(e){var i,r,o=e.context,a=function(e){var t=e.snapPoints,n=e.connection.waypoints,i=e.bendpointIndex;if(t)return t;var r=[n[i-1],n[i+1]];return e.snapPoints=t={horizontal:[],vertical:[]},(0,l.forEach)(r,function(e){e&&(e=e.original||e,t.horizontal.push(e.y),t.vertical.push(e.x))}),t}(o),s=o.target,c=s&&n(s),u=e.x,d=e.y;if(a){var p=u-(i=t(c?a.vertical.concat([c.x]):a.vertical,u)),f=d-(r=t(c?a.horizontal.concat([c.y]):a.horizontal,d));(0,l.assign)(e,{dx:e.dx-p,dy:e.dy-f,x:e.x-p,y:e.y-f}),(p||-1!==a.vertical.indexOf(u))&&(0,Zb.setSnapped)(e,"x",i),(f||-1!==a.horizontal.indexOf(d))&&(0,Zb.setSnapped)(e,"y",r)}})}DE.$inject=["eventBus"];var BE={};function LE(e,t,n,i,r){function o(e,n){var o=n.waypoints,a=(0,vE.getConnectionIntersection)(t,o,e);if(a)return!function(e,t,n){var i,r,o,a,s,c,u=e.index,l=e.point;return!(u<=0||e.bendpoint)&&(i=t[u-1],r=t[u],o=(0,ks.getMidPoint)(i,r),a=(0,ks.pointsAligned)(i,r),s=Math.abs(l.x-o.x),c=Math.abs(l.y-o.y),a&&s<=n&&c<=n)}(a,o,function(e,t){var n,i,r,o=e.waypoints;return t.index<=0||t.bendpoint?null:(n={start:o[t.index-1],end:o[t.index]},(i=(0,ks.pointsAligned)(n.start,n.end))?(r="h"===i?n.end.x-n.start.x:n.end.y-n.start.y,(0,vE.calculateSegmentMoveRegion)(r)/2):null)}(n,a))?i.start(e,n,a.index,!a.bendpoint):r.start(e,n,a.index),!0}function a(e,t,i){at.event.bind(e,t,function(e){n.triggerMouseEvent(t,e,i),e.stopPropagation()})}function s(e,n){var i=t.getLayer("overlays"),r=(0,at.query)('.djs-bendpoints[data-element-id="'+(0,Fb.escapeCSS)(e.id)+'"]',i);return!r&&n&&(r=(0,we.create)("g"),(0,we.attr)(r,{"data-element-id":e.id}),(0,we.classes)(r).add("djs-bendpoints"),(0,we.append)(i,r),a(r,"mousedown",e),a(r,"click",e),a(r,"dblclick",e)),r}function c(e,t){return(0,at.query)('.djs-segment-dragger[data-segment-idx="'+e+'"]',t)}function u(e,t){t.waypoints.forEach(function(t,n){var i=(0,vE.addBendpoint)(e);(0,we.append)(e,i),(0,Ze.translate)(i,t.x,t.y)}),(0,vE.addBendpoint)(e,"floating")}function d(e,t){for(var n,i,r,o=t.waypoints,s=1;s<o.length;s++)n=o[s-1],i=o[s],(0,ks.pointsAligned)(n,i)&&(r=(0,vE.addSegmentDragger)(e,n,i),(0,we.attr)(r,{"data-segment-idx":s}),a(r,"mousemove",t))}function p(e){var t=s(e);return t||(u(t=s(e,!0),e),d(t,e)),t}function f(e){var t=s(e);t&&(!function(e){(0,l.forEach)((0,at.queryAll)("."+vE.SEGMENT_DRAGGER_CLS,e),function(e){(0,we.remove)(e)})}(t),function(e){(0,l.forEach)((0,at.queryAll)("."+vE.BENDPOINT_CLS,e),function(e){(0,we.remove)(e)})}(t),d(t,e),u(t,e))}e.on("connection.changed",function(e){f(e.element)}),e.on("connection.remove",function(e){var t=s(e.element);t&&(0,we.remove)(t)}),e.on("element.marker.update",function(e){var t,n=e.element;n.waypoints&&(t=p(n),e.add?(0,we.classes)(t).add(e.marker):(0,we.classes)(t).remove(e.marker))}),e.on("element.mousemove",function(e){var n,i,r=e.element,o=r.waypoints;if(o){if(n=s(r,!0),!(i=(0,vE.getConnectionIntersection)(t,o,e.originalEvent)))return;!function(e,t){var n=(0,at.query)(".floating",e),i=t.point;n&&(0,Ze.translate)(n,i.x,i.y)}(n,i),i.bendpoint||function(e,t,n){var i,r,o=c(t.index,e),a=n[t.index-1],s=n[t.index],u=t.point,l=(0,ks.getMidPoint)(a,s),d=(0,ks.pointsAligned)(a,s);o&&(i=(0,Jr.getVisual)(o),r={x:u.x-l.x,y:u.y-l.y},"v"===d&&(r={x:r.y,y:r.x}),(0,Ze.translate)(i,r.x,r.y))}(n,i,o)}}),e.on("element.mousedown",function(e){var t=e.originalEvent,n=e.element,i=n.waypoints;if(i)return o(t,n)}),e.on("selection.changed",function(e){var t=e.newSelection[0];t&&t.waypoints&&p(t)}),e.on("element.hover",function(e){var t=e.element;t.waypoints&&(p(t),n.registerEvent(e.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(e){n.unregisterEvent(e.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(e){var t=e.element,n=e.newId;if(t.waypoints){var i=s(t);i&&(0,we.attr)(i,{"data-element-id":n})}}),this.addHandles=p,this.updateHandles=f,this.getBendpointsContainer=s,this.getSegmentDragger=c}Object.defineProperty(BE,"__esModule",{value:!0}),BE.default=LE,LE.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];var zE={};Object.defineProperty(zE,"__esModule",{value:!0}),zE.default=GE;var FE="connect-hover",$E="djs-updating";function HE(e,t,n){return UE(e,t,e[t]+n)}function UE(e,t,n){return{x:"x"===t?n:e.x,y:"y"===t?n:e.y}}function VE(e){return"x"===e?"y":"x"}function WE(e,t,n){var i,r;return e.original?e.original:(i=(0,dc.getMid)(t),UE(e,r=VE(n),i[r]))}function GE(e,t,n,i,r,o){var a=e.get("connectionDocking",!1);function s(e,t){if(!a)return t;var n,i=e.waypoints;return e.waypoints=t,n=a.getCroppedWaypoints(e),e.waypoints=i,n}function c(e){r.update("connection",e.connection,e.connectionGfx)}function u(e,t,n){var i=e.newWaypoints,r=function(e,t,n,i){var r=Math.max(t[i],n[i]),o=Math.min(t[i],n[i]);return UE(t,i,Math.min(Math.max(o+20,e[i]),r-20))}(n,i[e.segmentStartIndex+t],i[e.segmentEndIndex+t],VE(e.axis));(0,Ze.translate)(e.draggerGfx,r.x,r.y)}this.start=function(e,t,r){var o,a,s,c,u=n.getGraphics(t),l=r-1,d=r,p=t.waypoints,f=p[l],h=p[d],m=(0,vE.getConnectionIntersection)(n,p,e);(a=(0,ks.pointsAligned)(f,h))&&(s="v"===a?"x":"y",0===l&&(f=WE(f,t.source,s)),d===p.length-1&&(h=WE(h,t.target,s)),o={connection:t,segmentStartIndex:l,segmentEndIndex:d,segmentStart:f,segmentEnd:h,axis:s,dragPosition:c=m?m.point:{x:(f.x+h.x)/2,y:(f.y+h.y)/2}},i.init(e,c,"connectionSegment.move",{cursor:"x"===s?"resize-ew":"resize-ns",data:{connection:t,connectionGfx:u,context:o}}))},t.on("connectionSegment.move.start",function(e){var t=e.context,i=e.connection,r=n.getLayer("overlays");t.originalWaypoints=i.waypoints.slice(),t.draggerGfx=(0,vE.addSegmentDragger)(r,t.segmentStart,t.segmentEnd),(0,we.classes)(t.draggerGfx).add("djs-dragging"),n.addMarker(i,$E)}),t.on("connectionSegment.move.move",function(e){var t,n,i=e.context,r=i.connection,o=i.segmentStartIndex,a=i.segmentEndIndex,l=i.segmentStart,d=i.segmentEnd,p=i.axis,f=i.originalWaypoints.slice(),h=HE(l,p,e["d"+p]),m=HE(d,p,e["d"+p]),y=f.length,v=0;f[o]=h,f[a]=m,o<2&&(t=(0,dc.getOrientation)(r.source,h),1===o?"intersect"===t&&(f.shift(),f[0]=h,v--):"intersect"!==t&&(f.unshift(l),v++)),a>y-3&&(n=(0,dc.getOrientation)(r.target,m),a===y-2?"intersect"===n&&(f.pop(),f[f.length-1]=m):"intersect"!==n&&f.push(d)),i.newWaypoints=r.waypoints=s(r,f),u(i,v,e),i.newSegmentStartIndex=o+v,c(e)}),t.on("connectionSegment.move.hover",function(e){e.context.hover=e.hover,n.addMarker(e.hover,FE)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(e){var t=e.context.hover;t&&n.removeMarker(t,FE)}),t.on("connectionSegment.move.cleanup",function(e){var t=e.context,i=t.connection;t.draggerGfx&&(0,we.remove)(t.draggerGfx),n.removeMarker(i,$E)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(e){var t=e.context;t.connection.waypoints=t.originalWaypoints,c(e)}),t.on("connectionSegment.move.end",function(e){var t=e.context,n=t.connection,i=t.newWaypoints,r=t.newSegmentStartIndex,a=function(e,t){var n=0;return{waypoints:e.filter(function(i,r){return!(0,ks.pointsOnLine)(e[r-1],e[r+1],i)||(n=r<=t?n-1:n,!1)}),segmentOffset:n}}(i=i.map(function(e){return{original:e.original,x:Math.round(e.x),y:Math.round(e.y)}}),r),c=s(n,a.waypoints),u=a.segmentOffset,l={segmentMove:{segmentStartIndex:t.segmentStartIndex,newSegmentStartIndex:r+u}};o.updateWaypoints(n,c,l)})}GE.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var qE={};Object.defineProperty(qE,"__esModule",{value:!0});var KE=tM(Su),YE=tM(Ou),XE=tM(BE),ZE=tM(aE),QE=tM(wE),JE=tM(zE),eM=tM(OE);function tM(e){return e&&e.__esModule?e:{default:e}}qE.default={__depends__:[KE.default,YE.default],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",XE.default],bendpointMove:["type",ZE.default],bendpointMovePreview:["type",QE.default],connectionSegmentMove:["type",JE.default],bendpointSnapping:["type",eM.default]};var nM={};Object.defineProperty(nM,"__esModule",{value:!0}),nM.default=iM;function iM(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}iM.$inject=["injector","canvas","graphicsFactory","elementFactory"],iM.prototype.drawPreview=function(e,t,n){n=n||{};var i,r,o,a=e.connectionPreviewGfx,s=e.getConnection,c=n.source,u=n.target,l=n.waypoints,d=n.connectionStart,p=n.connectionEnd,f=n.noLayout,h=n.noCropping,m=n.noNoop,y=this;a||(a=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),(0,we.clear)(a),s||(s=e.getConnection=(r=function(e,t,n){return y.getConnection(e,t,n)},o={},function(e){var t=JSON.stringify(e),n=o[t];return n||(n=o[t]=r.apply(null,arguments)),n})),t&&(i=s(t,c,u)),i?(i.waypoints=l||[],this._layouter&&!f&&(i.waypoints=this._layouter.layoutConnection(i,{source:c,target:u,connectionStart:d,connectionEnd:p})),i.waypoints&&i.waypoints.length||(i.waypoints=[c?(0,dc.getMid)(c):d,u?(0,dc.getMid)(u):p]),this._connectionDocking&&(c||u)&&!h&&(i.waypoints=this._connectionDocking.getCroppedWaypoints(i,c,u)),this._graphicsFactory.drawConnection(a,i)):!m&&this.drawNoopPreview(a,n)},iM.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,r=t.connectionStart||(0,dc.getMid)(n),o=t.connectionEnd||(0,dc.getMid)(i),a=this.cropWaypoints(r,o,n,i),s=this.createNoopConnection(a[0],a[1]);(0,we.append)(e,s)},iM.prototype.cropWaypoints=function(e,t,n,i){var r=this._graphicsFactory,o=n&&r.getShapePath(n),a=i&&r.getShapePath(i),s=r.getConnectionPath({waypoints:[e,t]});return[e=n&&(0,dc.getElementLineIntersection)(o,s,!0)||e,t=i&&(0,dc.getElementLineIntersection)(a,s,!1)||t]},iM.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&(0,we.remove)(e.connectionPreviewGfx)},iM.prototype.getConnection=function(e){var t=function(e){return(0,l.isObject)(e)?e:{}}(e);return this._elementFactory.createConnection(t)},iM.prototype.createConnectionPreviewGfx=function(){var e=(0,we.create)("g");return(0,we.attr)(e,{pointerEvents:"none"}),(0,we.classes)(e).add("djs-connection-preview"),(0,we.append)(this._canvas.getDefaultLayer(),e),e},iM.prototype.createNoopConnection=function(e,t){var n=(0,we.create)("polyline");return(0,we.attr)(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),(0,we.attr)(n,{points:[e.x,e.y,t.x,t.y]}),n};var rM={};Object.defineProperty(rM,"__esModule",{value:!0});var oM=function(e){return e&&e.__esModule?e:{default:e}}(nM);rM.default={__init__:["connectionPreview"],connectionPreview:["type",oM.default]};var aM={};Object.defineProperty(aM,"__esModule",{value:!0}),aM.default=dM;var sM={moveSpeed:1,moveSpeedAccelerated:10},cM=1500,uM={ArrowLeft:"left",Left:"left",ArrowUp:"up",Up:"up",ArrowRight:"right",Right:"right",ArrowDown:"down",Down:"down"},lM={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function dM(e,t,n,i){var r=this;this._config=(0,l.assign)({},sM,e||{}),t.addListener(cM,function(e){var n=e.keyEvent,i=uM[n.key];if(i&&!t.isCmd(n)){var o=t.isShift(n);return r.moveSelection(i,o),!0}}),this.moveSelection=function(e,t){var r=i.get();if(r.length){var o=this._config[t?"moveSpeedAccelerated":"moveSpeed"],a=lM[e](o);n.moveElements(r,a)}}}dM.$inject=["config.keyboardMoveSelection","keyboard","modeling","selection"];var pM={};Object.defineProperty(pM,"__esModule",{value:!0});var fM=yM(Pl),hM=yM(wa),mM=yM(aM);function yM(e){return e&&e.__esModule?e:{default:e}}pM.default={__depends__:[fM.default,hM.default],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",mM.default]};var vM={};Object.defineProperty(vM,"__esModule",{value:!0}),vM.default=gM;function gM(e,t,n,i){this._dragging=i,this._rules=t;var r=this;e.on("resize.start",function(e){var t,n,i;t=e.context,n=t.resizeConstraints,i=t.minBounds,void 0===n&&(void 0===i&&(i=r.computeMinResizeBox(t)),t.resizeConstraints={min:(0,dc.asTRBL)(i)})}),e.on("resize.move",function(e){var t={x:e.dx,y:e.dy};!function(e,t){var n,i=e.shape,o=e.direction,a=e.resizeConstraints;e.delta=t,n=(0,jy.resizeBounds)(i,o,t),e.newBounds=(0,jy.ensureConstraints)(n,a),e.canExecute=r.canResize(e)}(e.context,t)}),e.on("resize.end",function(e){!function(e){var t=e.shape,i=e.canExecute,r=e.newBounds;if(i){if(!function(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}(t,r=(0,dc.roundBounds)(r)))return;n.resizeShape(t,r)}}(e.context)})}gM.prototype.canResize=function(e){var t=this._rules,n=(0,l.pick)(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)},gM.prototype.activate=function(e,t,n){var i,r,o=this._dragging;if("string"==typeof n&&(n={direction:n}),!(r=(i=(0,l.assign)({shape:t},n)).direction))throw new Error("must provide a direction (nw|se|ne|sw)");var a={x:/w/.test(r)?t.x:t.x+t.width,y:/n/.test(r)?t.y:t.y+t.height};o.init(e,a,"resize",{autoActivate:!0,cursor:"resize-"+(/nw|se/.test(r)?"nwse":"nesw"),data:{shape:t,context:i}})},gM.prototype.computeMinResizeBox=function(e){var t,n,i=e.shape,r=e.direction;return t=e.minDimensions||{width:10,height:10},n=(0,jy.computeChildrenBBox)(i,e.childrenBoxPadding),(0,jy.getMinResizeBounds)(r,i,t,n)},gM.$inject=["eventBus","rules","modeling","dragging"];var _M={};Object.defineProperty(_M,"__esModule",{value:!0}),_M.default=xM;function xM(e,t,n,i){this._resize=i,this._canvas=t;var r=this;e.on("selection.changed",function(e){var t=e.newSelection;r.removeResizers(),1===t.length&&(0,l.forEach)(t,(0,l.bind)(r.addResizer,r))}),e.on("shape.changed",function(e){var t=e.element;n.isSelected(t)&&(r.removeResizers(),r.addResizer(t))})}xM.prototype.makeDraggable=function(e,t,n){var i=this._resize;function r(t){(0,ta.isPrimaryButton)(t)&&i.activate(t,e,n)}at.event.bind(t,"mousedown",r),at.event.bind(t,"touchstart",r)},xM.prototype._createResizer=function(e,t,n,i,r){var o=this._getResizersParent(),a=(0,we.create)("g");(0,we.classes)(a).add("djs-resizer"),(0,we.classes)(a).add("djs-resizer-"+e.id),(0,we.classes)(a).add("djs-resizer-"+r),(0,we.append)(o,a);var s=(0,we.create)("rect");(0,we.attr)(s,{x:-7,y:-7,width:5,height:5}),(0,we.classes)(s).add("djs-resizer-visual"),(0,we.append)(a,s);var c=(0,we.create)("rect");return(0,we.attr)(c,{x:-7,y:-7,width:20,height:20}),(0,we.classes)(c).add("djs-resizer-hit"),(0,we.append)(a,c),(0,Ze.transform)(a,t,n,i),a},xM.prototype.createResizer=function(e,t){var n,i=(0,dc.asTRBL)(e);n="nw"===t?this._createResizer(e,i.left,i.top,0,t):"ne"===t?this._createResizer(e,i.right,i.top,90,t):"se"===t?this._createResizer(e,i.right,i.bottom,180,t):this._createResizer(e,i.left,i.bottom,270,t),this.makeDraggable(e,n,t)},xM.prototype.addResizer=function(e){this._resize.canResize({shape:e})&&(this.createResizer(e,"nw"),this.createResizer(e,"ne"),this.createResizer(e,"se"),this.createResizer(e,"sw"))},xM.prototype.removeResizers=function(){var e=this._getResizersParent();(0,we.clear)(e)},xM.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},xM.$inject=["eventBus","canvas","selection","resize"];var bM={};Object.defineProperty(bM,"__esModule",{value:!0}),bM.default=SM;var wM="djs-resizing",EM="resize-not-ok",MM=500;function SM(e,t,n){e.on("resize.move",MM,function(e){var i,r,o,a;i=e.context,r=i.shape,o=i.newBounds,(a=i.frame)||(a=i.frame=n.addFrame(r,t.getDefaultLayer()),t.addMarker(r,wM)),o.width>5&&(0,we.attr)(a,{x:o.x,width:o.width}),o.height>5&&(0,we.attr)(a,{y:o.y,height:o.height}),i.canExecute?(0,we.classes)(a).remove(EM):(0,we.classes)(a).add(EM)}),e.on("resize.cleanup",function(e){var n,i;n=e.context,i=n.shape,n.frame&&(0,we.remove)(n.frame),t.removeMarker(i,wM)})}SM.$inject=["eventBus","canvas","previewSupport"];var CM={};Object.defineProperty(CM,"__esModule",{value:!0});var PM=jM(Ou),RM=jM(Su),kM=jM(wx),TM=jM(vM),AM=jM(bM),OM=jM(_M);function jM(e){return e&&e.__esModule?e:{default:e}}CM.default={__depends__:[PM.default,RM.default,kM.default],__init__:["resize","resizePreview","resizeHandles"],resize:["type",TM.default],resizePreview:["type",AM.default],resizeHandles:["type",OM.default]};var NM={};Object.defineProperty(NM,"__esModule",{value:!0}),NM.default=DM;var IM={moveSpeed:50,moveSpeedAccelerated:200};function DM(e,t,n){var i=this;this._config=(0,l.assign)({},IM,e||{}),t.addListener(function(e){var n=e.keyEvent,r=i._config;if(!t.isCmd(n))return;if(t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],n)){var o,a=t.isShift(n)?r.moveSpeedAccelerated:r.moveSpeed;switch(n.key){case"ArrowLeft":case"Left":o="left";break;case"ArrowUp":case"Up":o="up";break;case"ArrowRight":case"Right":o="right";break;case"ArrowDown":case"Down":o="down"}return i.moveCanvas({speed:a,direction:o}),!0}}),this.moveCanvas=function(e){var t=0,i=0,r=e.speed/Math.min(Math.sqrt(n.viewbox().scale),1);switch(e.direction){case"left":t=r;break;case"up":i=r;break;case"right":t=-r;break;case"down":i=-r}n.scroll({dx:t,dy:i})}}DM.$inject=["config.keyboardMove","keyboard","canvas"];var BM={};Object.defineProperty(BM,"__esModule",{value:!0});var LM=FM(Pl),zM=FM(NM);function FM(e){return e&&e.__esModule?e:{default:e}}BM.default={__depends__:[LM.default],__init__:["keyboardMove"],keyboardMove:["type",zM.default]};var $M={},HM=$M=function(e,t){if(t||(t=16),void 0===e&&(e=128),e<=0)return"0";for(var n=Math.log(Math.pow(2,e))/Math.log(t),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,e/i))/Math.log(t)*i;var r=n-Math.floor(n),o="";for(i=0;i<Math.floor(n);i++){o=Math.floor(Math.random()*t).toString(t)+o}if(r){var a=Math.pow(t,r);o=Math.floor(Math.random()*a).toString(t)+o}var s=parseInt(o,t);return s!==1/0&&s>=Math.pow(2,e)?HM(e,t):o};function UM(e){if(!(this instanceof UM))return new UM(e);e=e||[128,36,1],this._seed=e.length?$M.rack(e[0],e[1],e[2]):e}HM.rack=function(e,t,n){var i=function(i){var o=0;do{if(o++>10){if(!n)throw new Error("too many ID collisions, use more bits");e+=n}var a=HM(e,t)}while(Object.hasOwnProperty.call(r,a));return r[a]=i,a},r=i.hats={};return i.get=function(e){return i.hats[e]},i.set=function(e,t){return i.hats[e]=t,i},i.bits=e||128,i.base=t||16,i};var VM=UM;UM.prototype.next=function(e){return this._seed(e||!0)},UM.prototype.nextPrefixed=function(e,t){var n;do{n=e+this.next(!0)}while(this.assigned(n));return this.claim(n,t),n},UM.prototype.claim=function(e,t){this._seed.set(e,t||!0)},UM.prototype.assigned=function(e){return this._seed.get(e)||!1},UM.prototype.unclaim=function(e){delete this._seed.hats[e]},UM.prototype.clear=function(){var e,t=this._seed.hats;for(e in t)this.unclaim(e)};var WM={};function GM(e){$a.call(this,e),this.on("import.parse.complete",function(e){e.error||this._collectIds(e.definitions,e.context)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}return u(GM,$a),(WM=GM).Viewer=$a,WM.NavigatedViewer=ls,GM.prototype.createDiagram=function(e){return this.importXML('<?xml version="1.0" encoding="UTF-8"?><cmmn:definitions xmlns:dc="http://www.omg.org/spec/CMMN/20151109/DC" xmlns:di="http://www.omg.org/spec/CMMN/20151109/DI" xmlns:cmmndi="http://www.omg.org/spec/CMMN/20151109/CMMNDI" xmlns:cmmn="http://www.omg.org/spec/CMMN/20151109/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Test" targetNamespace="http://bpmn.io/schema/cmmn"><cmmn:case id="Case_1"><cmmn:casePlanModel id="CasePlanModel_1" name="A CasePlanModel"><cmmn:planItem id="PlanItem_1" definitionRef="Task_1" /><cmmn:task id="Task_1" /></cmmn:casePlanModel></cmmn:case><cmmndi:CMMNDI><cmmndi:CMMNDiagram id="CMMNDiagram_1"><cmmndi:Size width="500" height="500" /><cmmndi:CMMNShape id="DI_CasePlanModel_1" cmmnElementRef="CasePlanModel_1"><dc:Bounds x="114" y="63" width="534" height="389" /><cmmndi:CMMNLabel /></cmmndi:CMMNShape><cmmndi:CMMNShape id="PlanItem_1_di" cmmnElementRef="PlanItem_1"><dc:Bounds x="150" y="96" width="100" height="80" /><cmmndi:CMMNLabel /></cmmndi:CMMNShape></cmmndi:CMMNDiagram></cmmndi:CMMNDI></cmmn:definitions>',e)},GM.prototype._createModdle=function(e){var t=$a.prototype._createModdle.call(this,e);return t.ids=new VM([32,36,1]),t},GM.prototype._collectIds=function(e,t){var n,i=e.$model.ids;for(n in i.clear(),t.elementsById)i.claim(n,t.elementsById[n])},GM.prototype._interactionModules=[tE.default,BM.default,Qa.default,ss.default,A_],GM.prototype._modelingModules=[qE.default,pM.default,wb.default,CM.default,rM.default,Ec,cl,vl,Al,md,C_,Wx,qw,Xb,Ob],GM.prototype._modules=[].concat(GM.prototype._modules,GM.prototype._interactionModules,GM.prototype._modelingModules),WM});